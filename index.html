<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Integral DRTE MEP - Gestión de Evidencias y Agenda</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACjSURBVHgB7dKxDYAwDETRG4CCEVggJqBgBBagYAMkpOllc05kI+7hVvT9l5QADeABHMAN2FipFZC4AB1QsgA2uAEfD2YzAZgqQDGAqgC+J0BX3IEyYQXIM5gLqAbQ/x5CMJMyg/0OpoOYNQFZ9xVgkAHkNWkZAXhHgOgTQQeQ3hAzAVQAVAVQHoBvB5QBiJnAPgNRBEhPwJ+APQFyE4gz+BeAj7uY2wAAAABJRU5ErkJggg==">
    <style>
        /* ===== RESET Y BASE ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0066CC;
            --primary-dark: #004C99;
            --secondary: #FF9900;
            --success: #4CAF50;
            --danger: #F44336;
            --warning: #FF9800;
            --info: #2196F3;
            --light: #F8F9FA;
            --dark: #212529;
            --gray: #6C757D;
            --border: #DEE2E6;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }

        [data-theme="dark"] {
            --primary: #4DABF7;
            --primary-dark: #339AF0;
            --light: #1A1D21;
            --dark: #E9ECEF;
            --gray: #ADB5BD;
            --border: #495057;
            --shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: var(--light);
            color: var(--dark);
            transition: var(--transition);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ===== LAYOUT ===== */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 15px;
        }

        .hidden {
            display: none !important;
        }

        /* ===== HEADER ===== */
        header {
            background: white;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        [data-theme="dark"] header {
            background: #2D333B;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo img {
            height: 50px;
        }

        .logo-text h1 {
            font-size: 1.2rem;
            color: var(--primary);
            margin-bottom: 0.2rem;
        }

        .logo-text p {
            font-size: 0.9rem;
            color: var(--gray);
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* ===== NAVEGACIÓN ===== */
        .main-nav {
            background: var(--primary);
            padding: 0 1rem;
        }

        .main-nav ul {
            display: flex;
            list-style: none;
            overflow-x: auto;
            padding: 0.5rem 0;
        }

        .main-nav li {
            flex-shrink: 0;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            padding: 0.8rem 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition);
            border-radius: 4px;
            white-space: nowrap;
        }

        .nav-link:hover,
        .nav-link.active {
            background: rgba(255,255,255,0.2);
        }

        .nav-search {
            display: flex;
            padding: 0.5rem 0;
        }

        .nav-search input {
            flex: 1;
            padding: 0.5rem;
            border: none;
            border-radius: 4px 0 0 4px;
        }

        /* ===== BOTONES ===== */
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            transition: var(--transition);
            font-weight: 500;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-secondary {
            background: var(--gray);
            color: white;
        }

        .btn-icon {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 4px;
            color: var(--dark);
            font-size: 1.2rem;
        }

        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
        }

        /* ===== CONTENIDO PRINCIPAL ===== */
        main {
            padding: 2rem 1rem;
        }

        .content-section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .section-header h2 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary);
        }

        .section-controls {
            display: flex;
            gap: 0.5rem;
        }

        /* ===== DASHBOARD ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: var(--transition);
        }

        [data-theme="dark"] .stat-card {
            background: #2D333B;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .stat-content h3 {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 0.5rem;
        }

        .stat-content p {
            font-size: 2rem;
            font-weight: bold;
            color: var(--dark);
        }

        /* ===== BITÁCORA ===== */
        .bitacora-form {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        [data-theme="dark"] .bitacora-form {
            background: #2D333B;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 1rem;
            transition: var(--transition);
            background: var(--light);
            color: var(--dark);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0,102,204,0.1);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        .file-drop-area {
            border: 2px dashed var(--border);
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .file-drop-area:hover,
        .file-drop-area.dragover {
            border-color: var(--primary);
            background: rgba(0,102,204,0.05);
        }

        .file-drop-area i {
            font-size: 3rem;
            color: var(--gray);
            margin-bottom: 1rem;
        }

        /* ===== LISTA DE ARCHIVOS ===== */
        .archivos-list {
            background: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        [data-theme="dark"] .archivos-list {
            background: #2D333B;
        }

        .archivo-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            transition: var(--transition);
        }

        .archivo-item:hover {
            background: rgba(0,102,204,0.05);
        }

        .archivo-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }

        .archivo-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0,102,204,0.1);
            border-radius: 6px;
            color: var(--primary);
        }

        .archivo-details {
            flex: 1;
        }

        .archivo-details h4 {
            margin-bottom: 0.2rem;
            color: var(--dark);
        }

        .archivo-meta {
            font-size: 0.8rem;
            color: var(--gray);
        }

        .archivo-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* ===== GESTIÓN DE TAREAS ===== */
        .tareas-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
        }

        @media (max-width: 992px) {
            .tareas-container {
                grid-template-columns: 1fr;
            }
        }

        .tarea-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            margin-bottom: 1rem;
            border-left: 4px solid var(--primary);
            transition: var(--transition);
        }

        [data-theme="dark"] .tarea-card {
            background: #2D333B;
        }

        .tarea-card.alta {
            border-left-color: var(--danger);
        }

        .tarea-card.media {
            border-left-color: var(--warning);
        }

        .tarea-card.baja {
            border-left-color: var(--success);
        }

        .tarea-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .tarea-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }

        .tarea-prioridad {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .prioridad-alta {
            background: rgba(244,67,54,0.1);
            color: var(--danger);
        }

        .prioridad-media {
            background: rgba(255,152,0,0.1);
            color: var(--warning);
        }

        .prioridad-baja {
            background: rgba(76,175,80,0.1);
            color: var(--success);
        }

        .tarea-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

               /* ===== CALENDARIO MEJORADO ===== */
        .calendario-container {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: var(--shadow);
            margin-bottom: 24px;
        }
        
        [data-theme="dark"] .calendario-container {
            background: #2D333B;
        }
        
        .calendario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--border);
        }
        
        .calendario-vista {
            display: flex;
            gap: 8px;
            background: var(--light);
            padding: 4px;
            border-radius: 8px;
        }
        
        .calendario-vista .btn {
            border-radius: 6px;
            padding: 8px 16px;
            min-height: auto;
        }
        
        .calendario-vista .btn.active {
            background: var(--primary);
            color: white;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .calendario-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: var(--border);
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .calendario-dia {
            background: white;
            padding: 12px;
            min-height: 120px;
            position: relative;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        [data-theme="dark"] .calendario-dia {
            background: #2D333B;
        }
        
        .calendario-dia:hover {
            background: rgba(0, 102, 204, 0.05);
            transform: translateY(-2px);
            z-index: 1;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .calendario-dia.nombre-dia {
            background: var(--primary);
            color: white;
            text-align: center;
            font-weight: 600;
            padding: 12px;
            min-height: auto;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .calendario-dia.otro-mes {
            background: var(--light);
            color: var(--gray);
            opacity: 0.6;
        }
        
        .calendario-dia.hoy {
            background: rgba(0, 102, 204, 0.15);
            border: 2px solid var(--primary);
        }
        
        .calendario-dia-numero {
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--dark);
            font-size: 1.1rem;
        }
        
        .calendario-eventos {
            margin-top: 8px;
        }
        
        .calendario-evento {
            font-size: 0.75rem;
            padding: 4px 6px;
            margin-bottom: 4px;
            border-radius: 4px;
            background: rgba(0, 102, 204, 0.1);
            color: var(--primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .calendario-evento i {
            font-size: 6px;
        }
        
        .calendario-evento.evento-alta {
            background: rgba(244, 67, 54, 0.1);
            color: var(--danger);
        }
        
        .calendario-evento.evento-media {
            background: rgba(255, 152, 0, 0.1);
            color: var(--warning);
        }
        
        .calendario-evento.evento-baja {
            background: rgba(76, 175, 80, 0.1);
            color: var(--success);
        }
        
        .calendario-mas-eventos {
            font-size: 0.7rem;
            color: var(--gray);
            text-align: center;
            padding: 2px;
            background: rgba(0,0,0,0.05);
            border-radius: 3px;
            margin-top: 4px;
        }

        /* ===== SISTEMA DE ARCHIVOS ===== */
        .archivos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .archivo-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        [data-theme="dark"] .archivo-card {
            background: #2D333B;
        }

        .archivo-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }

        .archivo-card-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        /* ===== INFORMES ===== */
        .informes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .informe-card {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        [data-theme="dark"] .informe-card {
            background: #2D333B;
        }

        .informe-card:hover {
            transform: translateY(-5px);
        }

        .informe-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .informe-actions {
            display: flex;
            gap: 0.5rem;
        }

        .detalle-informe {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            margin-top: 1rem;
        }

        .detalle-informe.expandido {
            max-height: 1000px;
        }

        /* ===== ENLACES MEP ===== */
        .enlaces-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .enlace-card {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
            text-decoration: none;
            color: inherit;
        }

        [data-theme="dark"] .enlace-card {
            background: #2D333B;
        }

        .enlace-card:hover {
            transform: translateY(-5px);
            background: var(--primary);
            color: white;
        }

        .enlace-card:hover .enlace-icon {
            color: white;
        }

        .enlace-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        /* ===== SISTEMA/CONFIGURACIÓN ===== */
        .config-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        @media (max-width: 768px) {
            .config-grid {
                grid-template-columns: 1fr;
            }
        }

        .config-card {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        [data-theme="dark"] .config-card {
            background: #2D333B;
        }

        .config-item {
            margin-bottom: 1.5rem;
        }

        .config-item label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        /* ===== MODALES ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
        }

        [data-theme="dark"] .modal-content {
            background: #2D333B;
        }

        .modal h3 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 2rem;
        }

        /* ===== NOTIFICACIONES ===== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 1rem;
            z-index: 3000;
            animation: slideIn 0.3s ease;
            max-width: 400px;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .notification.success {
            background: var(--success);
            color: white;
        }

        .notification.error {
            background: var(--danger);
            color: white;
        }

        .notification.warning {
            background: var(--warning);
            color: white;
        }

        .notification.info {
            background: var(--info);
            color: white;
        }

        /* ===== PROGRESS BAR ===== */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(0,0,0,0.1);
            z-index: 4000;
            display: none;
        }

        .progress-container.active {
            display: block;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            position: fixed;
            top: 10px;
            right: 10px;
            background: var(--primary);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            z-index: 4001;
        }

        /* ===== LOADING ===== */
        #loadingOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.3s;
        }

        [data-theme="dark"] #loadingOverlay {
            background: #1A1D21;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                gap: 1rem;
            }
            
            .main-nav ul {
                justify-content: flex-start;
            }
            
            .nav-link {
                padding: 0.5rem 0.8rem;
                font-size: 0.9rem;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ===== UTILIDADES ===== */
        .drag-over {
            border-color: var(--primary) !important;
            background: rgba(0,102,204,0.1) !important;
        }

        .editando {
            background: rgba(255,193,7,0.1) !important;
            outline: 2px solid var(--warning) !important;
        }

        .shake {
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        /* ===== EXCEL PREVIEW ===== */
        .excel-preview {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            border-collapse: collapse;
            width: 100%;
            font-size: 12px;
        }

        .excel-preview th {
            background-color: #f2f2f2;
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            color: #333;
        }

        [data-theme="dark"] .excel-preview th {
            background-color: #2D333B;
            color: #E9ECEF;
            border-color: #495057;
        }

        .excel-preview td {
            border: 1px solid #ddd;
            padding: 8px;
            min-height: 30px;
        }

        [data-theme="dark"] .excel-preview td {
            border-color: #495057;
        }

        .excel-preview tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        [data-theme="dark"] .excel-preview tr:nth-child(even) {
            background-color: #2D333B;
        }

        .excel-preview tr:hover {
            background-color: #f5f5f5;
        }

        [data-theme="dark"] .excel-preview tr:hover {
            background-color: #343A40;
        }

        .excel-toolbar {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        /* ===== EXPANDIBLE ===== */
        .expandible {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .expandible.expandido {
            max-height: 1000px;
        }

        /* ===== TOOLTIPS ===== */
        [data-tooltip] {
            position: relative;
        }

        [data-tooltip]:before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--dark);
            color: white;
            padding: 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        [data-tooltip]:hover:before {
            opacity: 1;
            visibility: visible;
        }

        /* ===== BADGES ===== */
        .badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            line-height: 1;
            text-align: center;
            white-space: nowrap;
            vertical-align: baseline;
            border-radius: 0.25rem;
        }

        .badge-primary {
            color: #fff;
            background-color: var(--primary);
        }

        .badge-success {
            color: #fff;
            background-color: var(--success);
        }

        .badge-danger {
            color: #fff;
            background-color: var(--danger);
        }

        .badge-warning {
            color: #fff;
            background-color: var(--warning);
        }

        /* ===== SCROLLBAR PERSONALIZADA ===== */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--light);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gray);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--dark);
        }

        /* ===== ESTADOS ===== */
        .estado-pendiente {
            color: var(--warning);
            background: rgba(255,152,0,0.1);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .estado-completado {
            color: var(--success);
            background: rgba(76,175,80,0.1);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .estado-en-progreso {
            color: var(--info);
            background: rgba(33,150,243,0.1);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        /* ===== TABLAS RESPONSIVAS ===== */
        .table-responsive {
            overflow-x: auto;
        }

        .table-responsive table {
            min-width: 600px;
        }

        /* ===== ANIMACIONES ===== */
        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        .slide-up {
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(0,102,204,0.4); }
            70% { box-shadow: 0 0 0 10px rgba(0,102,204,0); }
            100% { box-shadow: 0 0 0 0 rgba(0,102,204,0); }
        }

        /* ===== PANEL DE CONTROL ===== */
        .panel-control {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        [data-theme="dark"] .panel-control {
            background: #2D333B;
        }

        .control-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border);
        }

        .control-item:last-child {
            border-bottom: none;
        }

        .control-item label {
            font-weight: 500;
            color: var(--dark);
        }

        /* ===== DROP-DOWN MENU ===== */
        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            min-width: 200px;
            display: none;
            z-index: 1000;
            overflow: hidden;
        }

        [data-theme="dark"] .dropdown-menu {
            background: #2D333B;
        }

        .dropdown-menu.active {
            display: block;
            animation: slideUp 0.2s ease;
        }

        .dropdown-menu a {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
        }

        [data-theme="dark"] .dropdown-menu a {
            color: var(--dark);
        }

        .dropdown-menu a:hover {
            background: rgba(0,102,204,0.1);
            color: var(--primary);
        }

        .dropdown-menu hr {
            border: none;
            border-top: 1px solid var(--border);
            margin: 0.5rem 0;
        }

        /* ===== GRID RESPONSIVE ===== */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
        }

        @media (max-width: 992px) {
            .grid-4 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .grid-2,
            .grid-3,
            .grid-4 {
                grid-template-columns: 1fr;
            }
        }

        /* ===== CARD HOVER EFFECTS ===== */
        .hover-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .hover-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        /* ===== INPUT GROUPS ===== */
        .input-group {
            display: flex;
            border-radius: 4px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .input-group input {
            flex: 1;
            border: none;
            padding: 0.75rem;
            outline: none;
        }

        .input-group button {
            border: none;
            background: var(--primary);
            color: white;
            padding: 0 1rem;
            cursor: pointer;
        }

        /* ===== ALERTS ===== */
        .alert {
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1rem;
            border-left: 4px solid;
        }

        .alert-success {
            background: rgba(76,175,80,0.1);
            border-left-color: var(--success);
            color: var(--success);
        }

        .alert-danger {
            background: rgba(244,67,54,0.1);
            border-left-color: var(--danger);
            color: var(--danger);
        }

        .alert-warning {
            background: rgba(255,152,0,0.1);
            border-left-color: var(--warning);
            color: var(--warning);
        }

        .alert-info {
            background: rgba(33,150,243,0.1);
            border-left-color: var(--info);
            color: var(--info);
        }

        /* ===== BREADCRUMBS ===== */
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            color: var(--gray);
        }

        .breadcrumb a {
            color: var(--primary);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .breadcrumb .separator {
            color: var(--border);
        }

        /* ===== TAGS ===== */
        .tag {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            background: rgba(0,102,204,0.1);
            color: var(--primary);
            border-radius: 4px;
            font-size: 0.8rem;
            margin: 0.125rem;
        }

        .tag i {
            font-size: 0.7rem;
            cursor: pointer;
        }

        .tag:hover {
            background: rgba(0,102,204,0.2);
        }

        /* ===== AVATARS ===== */
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .avatar.sm {
            width: 30px;
            height: 30px;
            font-size: 0.8rem;
        }

        .avatar.lg {
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
        }

        /* ===== TIMELINE ===== */
        .timeline {
            position: relative;
            padding-left: 2rem;
        }

        .timeline:before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .timeline-item:before {
            content: '';
            position: absolute;
            left: -1.5rem;
            top: 5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--primary);
            border: 2px solid white;
        }

        /* ===== ACCORDION ===== */
        .accordion-item {
            border: 1px solid var(--border);
            border-radius: 4px;
            margin-bottom: 0.5rem;
            overflow: hidden;
        }

        .accordion-header {
            padding: 1rem;
            background: var(--light);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 500;
        }

        .accordion-content {
            padding: 1rem;
            border-top: 1px solid var(--border);
            display: none;
        }

        .accordion-item.active .accordion-content {
            display: block;
        }

        /* ===== TABS ===== */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 1rem;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: var(--transition);
        }

        .tab:hover {
            background: rgba(0,102,204,0.05);
        }

        .tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
            font-weight: 500;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        /* ===== STEPPER ===== */
        .stepper {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
            position: relative;
        }

        .stepper:before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--border);
            z-index: 1;
        }

        .step {
            position: relative;
            z-index: 2;
            text-align: center;
            flex: 1;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--border);
            color: var(--gray);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 0.5rem;
            font-weight: bold;
        }

        .step.active .step-number {
            background: var(--primary);
            color: white;
        }

        .step.completed .step-number {
            background: var(--success);
            color: white;
        }

        /* ===== CAROUSEL ===== */
        .carousel {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
        }

        .carousel-track {
            display: flex;
            transition: transform 0.5s ease;
        }

        .carousel-slide {
            min-width: 100%;
            padding: 2rem;
            text-align: center;
        }

        .carousel-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 10;
        }

        .carousel-btn.prev {
            left: 1rem;
        }

        .carousel-btn.next {
            right: 1rem;
        }

        .carousel-dots {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .carousel-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--border);
            cursor: pointer;
        }

        .carousel-dot.active {
            background: var(--primary);
        }

        /* ===== COUNTER ===== */
        .counter {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            text-align: center;
            margin: 1rem 0;
        }

        /* ===== RATING ===== */
        .rating {
            color: #FFD700;
            font-size: 1.5rem;
        }

        .rating i {
            margin: 0 0.1rem;
        }

        /* ===== PROGRESS CIRCLE ===== */
        .progress-circle {
            width: 100px;
            height: 100px;
            position: relative;
        }

        .progress-circle svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .progress-circle circle {
            fill: none;
            stroke-width: 8;
            stroke-linecap: round;
        }

        .progress-circle-bg {
            stroke: var(--border);
        }

        .progress-circle-fill {
            stroke: var(--primary);
            stroke-dasharray: 283;
            stroke-dashoffset: 283;
            transition: stroke-dashoffset 1s ease;
        }

        .progress-circle-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--dark);
        }

        /* ===== LOADING SKELETON ===== */
        .skeleton {
            background: linear-gradient(90deg, var(--border) 25%, #e0e0e0 50%, var(--border) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 4px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .skeleton-text {
            height: 1rem;
            margin-bottom: 0.5rem;
        }

        .skeleton-title {
            height: 2rem;
            margin-bottom: 1rem;
        }

        .skeleton-button {
            height: 2.5rem;
            width: 100px;
        }

        /* ===== LAST UPDATED ===== */
        .last-updated {
            font-size: 0.8rem;
            color: var(--gray);
            text-align: right;
            margin-top: 1rem;
        }

        /* ===== PRINT STYLES ===== */
        @media print {
            .no-print {
                display: none !important;
            }
            
            .content-section {
                display: block !important;
            }
            
            body {
                background: white !important;
                color: black !important;
            }
            
            a {
                color: black !important;
                text-decoration: none !important;
            }
        }

        /* ===== HIGH CONTRAST MODE ===== */
        .high-contrast {
            --primary: #000000;
            --primary-dark: #000000;
            --light: #FFFFFF;
            --dark: #000000;
            --border: #000000;
            --shadow: 0 0 0 1px #000000;
        }

        .high-contrast * {
            background: white !important;
            color: black !important;
            border-color: black !important;
        }

        /* ===== ZOOM CONTROLS ===== */
        .zoom-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            z-index: 1000;
        }

        .zoom-controls button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: var(--shadow);
        }

        /* ===== CUSTOM SCROLL PROGRESS ===== */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: var(--primary);
            z-index: 9999;
            transition: width 0.1s;
        }

        /* ===== BACK TO TOP ===== */
        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .back-to-top.visible {
            opacity: 1;
        }

        /* ===== GRADIENT BACKGROUND ===== */
        .gradient-bg {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }

        /* ===== GLASS MORPHISM ===== */
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        [data-theme="dark"] .glass {
            background: rgba(0, 0, 0, 0.1);
        }

        /* ===== CUSTOM CHECKBOX ===== */
        .checkbox-container {
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .checkbox-container input {
            display: none;
        }

        .checkmark {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-radius: 4px;
            margin-right: 10px;
            position: relative;
            transition: var(--transition);
        }

        .checkbox-container input:checked + .checkmark {
            background: var(--primary);
            border-color: var(--primary);
        }

        .checkbox-container input:checked + .checkmark:after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 14px;
        }

        /* ===== CUSTOM RADIO ===== */
        .radio-container {
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .radio-container input {
            display: none;
        }

        .radiomark {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-radius: 50%;
            margin-right: 10px;
            position: relative;
            transition: var(--transition);
        }

        .radio-container input:checked + .radiomark {
            border-color: var(--primary);
        }

        .radio-container input:checked + .radiomark:after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--primary);
        }

        /* ===== CUSTOM SELECT ===== */
        .select-container {
            position: relative;
        }

        .select-container select {
            appearance: none;
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 4px;
            background: var(--light);
            color: var(--dark);
            cursor: pointer;
        }

        .select-container:after {
            content: '▼';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
            pointer-events: none;
        }

        /* ===== TOGGLE SWITCH ===== */
        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            display: none;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border);
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }

        /* ===== FILE UPLOAD CUSTOM ===== */
        .file-upload-custom {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }

        .file-upload-custom input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-upload-custom-label {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: var(--primary);
            color: white;
            border-radius: 4px;
            cursor: pointer;
            transition: var(--transition);
        }

        .file-upload-custom-label:hover {
            background: var(--primary-dark);
        }

        /* ===== RANGE SLIDER ===== */
        .range-slider {
            width: 100%;
            height: 5px;
            background: var(--border);
            border-radius: 5px;
            outline: none;
            -webkit-appearance: none;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }

        /* ===== COLOR PICKER ===== */
        .color-picker {
            width: 100%;
            height: 40px;
            padding: 0;
            border: 1px solid var(--border);
            border-radius: 4px;
            cursor: pointer;
        }

        /* ===== DATE PICKER ===== */
        .date-picker {
            position: relative;
        }

        .date-picker input {
            width: 100%;
        }

        .date-picker-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
            pointer-events: none;
        }

        /* ===== TIME PICKER ===== */
        .time-picker {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .time-input {
            width: 60px;
            text-align: center;
        }

        .time-separator {
            font-weight: bold;
        }

        /* ===== DROPZONE ANIMATION ===== */
        @keyframes pulse-border {
            0% { box-shadow: 0 0 0 0 rgba(0,102,204,0.4); }
            70% { box-shadow: 0 0 0 10px rgba(0,102,204,0); }
            100% { box-shadow: 0 0 0 0 rgba(0,102,204,0); }
        }

        .pulse-border {
            animation: pulse-border 2s infinite;
        }

        /* ===== FILE ICON COLORS ===== */
        .file-icon.pdf { color: #FF0000; }
        .file-icon.word { color: #2B579A; }
        .file-icon.excel { color: #217346; }
        .file-icon.pptx { color: #D24726; }
        .file-icon.image { color: #4CAF50; }
        .file-icon.video { color: #FF9800; }
        .file-icon.audio { color: #9C27B0; }
        .file-icon.zip { color: #795548; }
        .file-icon.txt { color: #607D8B; }

        /* ===== STATUS INDICATORS ===== */
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .status-online { background: var(--success); }
        .status-offline { background: var(--danger); }
        .status-away { background: var(--warning); }
        .status-busy { background: var(--danger); }

        /* ===== LOADING DOTS ===== */
        .loading-dots {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .loading-dots span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--primary);
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
        .loading-dots span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        /* ===== WAVE ANIMATION ===== */
        .wave {
            display: inline-block;
            animation: wave 2s infinite;
        }

        @keyframes wave {
            0%, 60%, 100% { transform: rotate(0); }
            10%, 30% { transform: rotate(-10deg); }
            20% { transform: rotate(12deg); }
        }

        /* ===== FLOATING ACTION BUTTON ===== */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            box-shadow: 0 4px 20px rgba(0,102,204,0.3);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            z-index: 1000;
            transition: var(--transition);
        }

        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(0,102,204,0.4);
        }

        /* ===== CONTEXT MENU ===== */
        .context-menu {
            position: fixed;
            background: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            min-width: 200px;
            z-index: 10000;
            display: none;
        }

        [data-theme="dark"] .context-menu {
            background: #2D333B;
        }

        .context-menu.active {
            display: block;
            animation: fadeIn 0.2s ease;
        }

        .context-menu-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .context-menu-item:hover {
            background: rgba(0,102,204,0.1);
        }

        /* ===== TOAST NOTIFICATIONS ===== */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 400px;
        }

        .toast {
            background: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            animation: slideInRight 0.3s ease;
        }

        [data-theme="dark"] .toast {
            background: #2D333B;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .toast-icon {
            font-size: 1.5rem;
        }

        .toast-success .toast-icon { color: var(--success); }
        .toast-error .toast-icon { color: var(--danger); }
        .toast-warning .toast-icon { color: var(--warning); }
        .toast-info .toast-icon { color: var(--info); }

        .toast-close {
            margin-left: auto;
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            font-size: 1.2rem;
        }

        /* ===== TOOLBAR ===== */
        .toolbar {
            display: flex;
            gap: 0.5rem;
            padding: 1rem;
            background: var(--light);
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
        }

        .toolbar-group {
            display: flex;
            gap: 0.25rem;
            align-items: center;
            padding-right: 1rem;
            border-right: 1px solid var(--border);
        }

        .toolbar-group:last-child {
            border-right: none;
        }

        /* ===== SIDEBAR ===== */
        .sidebar {
            width: 250px;
            background: var(--light);
            border-right: 1px solid var(--border);
            height: calc(100vh - 70px);
            position: fixed;
            left: 0;
            top: 70px;
            transition: var(--transition);
            overflow-y: auto;
        }

        .sidebar.collapsed {
            transform: translateX(-100%);
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            border-bottom: 1px solid var(--border);
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
        }

        .sidebar-menu a:hover {
            background: rgba(0,102,204,0.1);
        }

        .sidebar-menu a.active {
            background: var(--primary);
            color: white;
        }

        .sidebar-toggle {
            position: fixed;
            left: 10px;
            top: 80px;
            z-index: 1000;
        }

        /* ===== MAIN CONTENT WITH SIDEBAR ===== */
        .main-with-sidebar {
            margin-left: 250px;
            transition: var(--transition);
        }

        .main-with-sidebar.expanded {
            margin-left: 0;
        }

        /* ===== OVERFLOW MENU ===== */
        .overflow-menu {
            position: relative;
        }

        .overflow-menu-content {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            min-width: 150px;
            display: none;
            z-index: 1000;
        }

        [data-theme="dark"] .overflow-menu-content {
            background: #2D333B;
        }

        .overflow-menu:hover .overflow-menu-content {
            display: block;
        }

        /* ===== DRAG HANDLE ===== */
        .drag-handle {
            cursor: move;
            color: var(--gray);
            padding: 0.5rem;
        }

        .drag-handle:hover {
            color: var(--primary);
        }

        /* ===== SORTABLE LIST ===== */
        .sortable-list {
            list-style: none;
        }

        .sortable-item {
            padding: 1rem;
            background: white;
            border: 1px solid var(--border);
            margin-bottom: 0.5rem;
            border-radius: 4px;
            cursor: move;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: var(--transition);
        }

        [data-theme="dark"] .sortable-item {
            background: #2D333B;
        }

        .sortable-item:hover {
            box-shadow: var(--shadow);
        }

        .sortable-item.dragging {
            opacity: 0.5;
            background: rgba(0,102,204,0.1);
        }

        /* ===== EMPTY STATE ===== */
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* ===== WELCOME MESSAGE ===== */
        .welcome-message {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .welcome-message h2 {
            color: white;
            margin-bottom: 0.5rem;
        }

        /* ===== QUICK ACTIONS ===== */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .quick-action {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: var(--transition);
        }

        [data-theme="dark"] .quick-action {
            background: #2D333B;
        }

        .quick-action:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .quick-action i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        /* ===== RECENT ACTIVITY ===== */
        .recent-activity {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }

        [data-theme="dark"] .recent-activity {
            background: #2D333B;
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(0,102,204,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
        }

        /* ===== HELP TEXT ===== */
        .help-text {
            font-size: 0.8rem;
            color: var(--gray);
            margin-top: 0.25rem;
        }

        /* ===== REQUIRED FIELD ===== */
        .required:after {
            content: " *";
            color: var(--danger);
        }

        /* ===== CHARACTER COUNTER ===== */
        .char-counter {
            text-align: right;
            font-size: 0.8rem;
            color: var(--gray);
            margin-top: 0.25rem;
        }

        .char-counter.warning {
            color: var(--warning);
        }

        .char-counter.danger {
            color: var(--danger);
        }

        /* ===== PASSWORD STRENGTH ===== */
        .password-strength {
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            margin-top: 0.5rem;
            overflow: hidden;
        }

        .password-strength-bar {
            height: 100%;
            width: 0%;
            transition: width 0.3s;
        }

        .strength-weak { background: var(--danger); }
        .strength-medium { background: var(--warning); }
        .strength-strong { background: var(--success); }

        /* ===== SEARCH HIGHLIGHT ===== */
        .search-highlight {
            background: rgba(255,193,7,0.3);
            padding: 0 2px;
            border-radius: 2px;
        }

        /* ===== WATERMARK ===== */
        .watermark {
            position: fixed;
            bottom: 20px;
            right: 20px;
            color: rgba(0,0,0,0.1);
            font-size: 12rem;
            font-weight: bold;
            pointer-events: none;
            z-index: -1;
            transform: rotate(-45deg);
            user-select: none;
        }

        [data-theme="dark"] .watermark {
            color: rgba(255,255,255,0.05);
        }

        /* ===== CONFETTI ===== */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--primary);
            top: -10px;
            z-index: 9999;
        }

        /* ===== PULSE ANIMATION ===== */
        .pulse-animation {
            animation: pulse 2s infinite;
        }

        /* ===== ROTATE ANIMATION ===== */
        .rotate-animation {
            animation: rotate 2s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ===== BOUNCE ANIMATION ===== */
        .bounce-animation {
            animation: bounce 2s infinite;
        }

        /* ===== FLIP ANIMATION ===== */
        .flip-animation {
            animation: flip 2s ease-in-out infinite;
        }

        @keyframes flip {
            0% { transform: perspective(400px) rotateY(0); }
            50% { transform: perspective(400px) rotateY(180deg); }
            100% { transform: perspective(400px) rotateY(360deg); }
        }

        /* ===== GLOW ANIMATION ===== */
        .glow-animation {
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 10px var(--primary); }
            to { box-shadow: 0 0 20px var(--primary); }
        }

        /* ===== FLOAT ANIMATION ===== */
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* ===== SHIMMER ANIMATION ===== */
        .shimmer {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        /* ===== GRID LINES ===== */
        .grid-lines {
            background-size: 20px 20px;
            background-image: linear-gradient(to right, var(--border) 1px, transparent 1px),
                              linear-gradient(to bottom, var(--border) 1px, transparent 1px);
        }

        /* ===== PATTERN BACKGROUND ===== */
        .pattern-bg {
            background-image: radial-gradient(var(--border) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* ===== NOISE TEXTURE ===== */
        .noise-texture {
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.1'/%3E%3C/svg%3E");
        }

        /* ===== GRADIENT TEXT ===== */
        .gradient-text {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* ===== TEXT STROKE ===== */
        .text-stroke {
            -webkit-text-stroke: 1px var(--primary);
            color: transparent;
        }

        /* ===== BLUR EFFECT ===== */
        .blur-effect {
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        /* ===== FROSTED GLASS ===== */
        .frosted-glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        [data-theme="dark"] .frosted-glass {
            background: rgba(0, 0, 0, 0.1);
        }

        /* ===== NEUMORPHISM ===== */
        .neumorphism {
            border-radius: 20px;
            background: var(--light);
            box-shadow: 8px 8px 16px rgba(0,0,0,0.1),
                        -8px -8px 16px rgba(255,255,255,0.5);
        }

        [data-theme="dark"] .neumorphism {
            background: #2D333B;
            box-shadow: 8px 8px 16px rgba(0,0,0,0.3),
                        -8px -8px 16px rgba(255,255,255,0.05);
        }

        /* ===== GLASS CARD ===== */
        .glass-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        [data-theme="dark"] .glass-card {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* ===== FLOATING ELEMENTS ===== */
        .floating {
            animation: float 6s ease-in-out infinite;
        }

        /* ===== PARALLAX ===== */
        .parallax {
            background-attachment: fixed;
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
        }

        /* ===== STICKY HEADER ===== */
        .sticky-header {
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
            background: rgba(255,255,255,0.9);
        }

        [data-theme="dark"] .sticky-header {
            background: rgba(0,0,0,0.9);
        }

        /* ===== HOVER ZOOM ===== */
        .hover-zoom {
            transition: transform 0.3s ease;
        }

        .hover-zoom:hover {
            transform: scale(1.05);
        }

        /* ===== HOVER LIFT ===== */
        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        /* ===== HOVER SHADOW ===== */
        .hover-shadow {
            transition: box-shadow 0.3s ease;
        }

        .hover-shadow:hover {
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        /* ===== HOVER ROTATE ===== */
        .hover-rotate {
            transition: transform 0.3s ease;
        }

        .hover-rotate:hover {
            transform: rotate(5deg);
        }

        /* ===== HOVER SKEW ===== */
        .hover-skew {
            transition: transform 0.3s ease;
        }

        .hover-skew:hover {
            transform: skewY(-5deg);
        }

        /* ===== HOVER GLOW ===== */
        .hover-glow {
            transition: box-shadow 0.3s ease;
        }

        .hover-glow:hover {
            box-shadow: 0 0 20px rgba(0,102,204,0.5);
        }

        /* ===== HOVER BORDER ===== */
        .hover-border {
            transition: border-color 0.3s ease;
            border: 2px solid transparent;
        }

        .hover-border:hover {
            border-color: var(--primary);
        }

        /* ===== HOVER UNDERLINE ===== */
        .hover-underline {
            position: relative;
        }

        .hover-underline:after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 0;
            background: var(--primary);
            transition: width 0.3s ease;
        }

        .hover-underline:hover:after {
            width: 100%;
        }

        /* ===== HOVER FILL ===== */
        .hover-fill {
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .hover-fill:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background: var(--primary);
            transition: width 0.3s ease;
            z-index: -1;
        }

        .hover-fill:hover:before {
            width: 100%;
        }

        .hover-fill:hover {
            color: white;
        }

        /* ===== ACTIVE STATES ===== */
        .active-scale:active {
            transform: scale(0.95);
        }

        .active-rotate:active {
            transform: rotate(180deg);
        }

        /* ===== FOCUS STATES ===== */
        .focus-ring:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(0,102,204,0.3);
        }

        /* ===== DISABLED STATES ===== */
        .disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        /* ===== PRINT OPTIMIZATIONS ===== */
        @media print {
            .print-hidden {
                display: none !important;
            }
            
            .print-visible {
                display: block !important;
            }
            
            .print-break {
                page-break-before: always;
            }
            
            .print-no-break {
                page-break-inside: avoid;
            }
            
            .print-border {
                border: 1px solid #000 !important;
            }
        }

        /* ===== ACCESSIBILITY ===== */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0,0,0,0);
            white-space: nowrap;
            border: 0;
        }

        .focus-visible:focus-visible {
            outline: 3px solid var(--primary);
            outline-offset: 2px;
        }

        /* ===== REDUCED MOTION ===== */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* ===== HIGH CONTRAST SUPPORT ===== */
        @media (prefers-contrast: high) {
            :root {
                --primary: #0000FF;
                --primary-dark: #00008B;
                --success: #006400;
                --danger: #8B0000;
                --warning: #FF8C00;
            }
        }

        /* ===== DARK MODE SUPPORT ===== */
        @media (prefers-color-scheme: dark) {
            :root:not([data-theme]) {
                --primary: #4DABF7;
                --primary-dark: #339AF0;
                --light: #1A1D21;
                --dark: #E9ECEF;
                --gray: #ADB5BD;
                --border: #495057;
                --shadow: 0 2px 10px rgba(0,0,0,0.3);
            }
        }

        /* ===== LIGHT MODE SUPPORT ===== */
        @media (prefers-color-scheme: light) {
            :root:not([data-theme]) {
                --primary: #0066CC;
                --primary-dark: #004C99;
                --light: #F8F9FA;
                --dark: #212529;
                --gray: #6C757D;
                --border: #DEE2E6;
                --shadow: 0 2px 10px rgba(0,0,0,0.1);
            }
        }

        /* ===== TOUCH DEVICE OPTIMIZATIONS ===== */
        @media (hover: none) and (pointer: coarse) {
            .btn, button {
                min-height: 44px;
                min-width: 44px;
            }
            
            .nav-link {
                padding: 1rem;
            }
            
            .form-control {
                font-size: 16px; /* Prevents zoom on iOS */
            }
        }

        /* ===== DESKTOP OPTIMIZATIONS ===== */
        @media (hover: hover) and (pointer: fine) {
            .scroll-hint {
                cursor: pointer;
            }
            
            .tooltip-hover {
                position: relative;
            }
            
            .tooltip-hover:hover:after {
                content: attr(data-tooltip);
                position: absolute;
                bottom: 100%;
                left: 50%;
                transform: translateX(-50%);
                background: var(--dark);
                color: white;
                padding: 0.5rem;
                border-radius: 4px;
                font-size: 0.8rem;
                white-space: nowrap;
                z-index: 1000;
            }
        }

        /* ===== 4K AND LARGE SCREENS ===== */
        @media (min-width: 1920px) {
            .container {
                max-width: 1800px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            }
            
            .archivos-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }

        /* ===== RETINA DISPLAY ===== */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .logo img {
                image-rendering: -webkit-optimize-contrast;
                image-rendering: crisp-edges;
            }
        }

        /* ===== MOBILE LANDSCAPE ===== */
        @media (max-height: 600px) and (orientation: landscape) {
            .main-nav ul {
                padding: 0.25rem 0;
            }
            
            .nav-link {
                padding: 0.5rem 0.8rem;
            }
            
            .section-header {
                margin-bottom: 1rem;
            }
            
            .stat-card {
                padding: 1rem;
            }
        }

        /* ===== FOLDABLE DEVICES ===== */
        @media (max-width: 280px) {
            .logo-text h1 {
                font-size: 1rem;
            }
            
            .logo-text p {
                font-size: 0.7rem;
            }
            
            .btn {
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
            }
            
            .stat-card {
                padding: 1rem;
            }
        }

        /* ===== SYSTEM FONTS OPTIMIZATION ===== */
        .system-fonts {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }

        /* ===== ANTI-ALIASING ===== */
        .smooth-text {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* ===== SELECTION COLOR ===== */
        ::selection {
            background: rgba(0,102,204,0.3);
            color: inherit;
        }

        ::-moz-selection {
            background: rgba(0,102,204,0.3);
            color: inherit;
        }

        /* ===== PLACEHOLDER STYLING ===== */
        ::placeholder {
            color: var(--gray);
            opacity: 1;
        }

        :-ms-input-placeholder {
            color: var(--gray);
        }

        ::-ms-input-placeholder {
            color: var(--gray);
        }

        /* ===== AUTOFILL STYLING ===== */
        input:-webkit-autofill,
        input:-webkit-autofill:hover,
        input:-webkit-autofill:focus,
        textarea:-webkit-autofill,
        textarea:-webkit-autofill:hover,
        textarea:-webkit-autofill:focus,
        select:-webkit-autofill,
        select:-webkit-autofill:hover,
        select:-webkit-autofill:focus {
            -webkit-text-fill-color: var(--dark);
            -webkit-box-shadow: 0 0 0px 1000px var(--light) inset;
            transition: background-color 5000s ease-in-out 0s;
        }

        [data-theme="dark"] input:-webkit-autofill,
        [data-theme="dark"] input:-webkit-autofill:hover,
        [data-theme="dark"] input:-webkit-autofill:focus {
            -webkit-text-fill-color: var(--dark);
            -webkit-box-shadow: 0 0 0px 1000px #2D333B inset;
        }

        /* ===== NUMBER INPUT SPINNER REMOVAL ===== */
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

        /* ===== DETAILS/SUMMARY STYLING ===== */
        details {
            background: var(--light);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        details[open] {
            background: rgba(0,102,204,0.05);
        }

        summary {
            cursor: pointer;
            font-weight: 500;
            color: var(--primary);
            padding: 0.5rem;
            outline: none;
        }

        summary:hover {
            color: var(--primary-dark);
        }

        /* ===== METER STYLING ===== */
        meter {
            width: 100%;
            height: 20px;
        }

        meter::-webkit-meter-bar {
            background: var(--border);
            border-radius: 4px;
        }

        meter::-webkit-meter-optimum-value {
            background: var(--success);
            border-radius: 4px;
        }

        meter::-webkit-meter-suboptimum-value {
            background: var(--warning);
            border-radius: 4px;
        }

        meter::-webkit-meter-even-less-good-value {
            background: var(--danger);
            border-radius: 4px;
        }

        /* ===== PROGRESS ELEMENT STYLING ===== */
        progress {
            width: 100%;
            height: 20px;
            border-radius: 4px;
            border: 1px solid var(--border);
        }

        progress::-webkit-progress-bar {
            background: var(--light);
            border-radius: 4px;
        }

        progress::-webkit-progress-value {
            background: var(--primary);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        progress::-moz-progress-bar {
            background: var(--primary);
            border-radius: 4px;
        }

        /* ===== DATALIST STYLING ===== */
        datalist {
            display: none;
        }

        input[list] {
            background: var(--light);
        }

        /* ===== OUTPUT ELEMENT STYLING ===== */
        output {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            background: var(--light);
            border-radius: 4px;
            font-weight: 500;
            color: var(--primary);
        }

        /* ===== TIME ELEMENT STYLING ===== */
        time {
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* ===== MARK ELEMENT STYLING ===== */
        mark {
            background: rgba(255,193,7,0.3);
            padding: 0 2px;
            border-radius: 2px;
        }

        /* ===== SMALL ELEMENT STYLING ===== */
        small {
            font-size: 0.8rem;
            color: var(--gray);
        }

        /* ===== CODE ELEMENT STYLING ===== */
        code {
            font-family: 'Courier New', monospace;
            background: var(--light);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            color: var(--danger);
            font-size: 0.9rem;
        }

        pre code {
            display: block;
            padding: 1rem;
            overflow-x: auto;
            background: var(--dark);
            color: var(--light);
            border-radius: 8px;
        }

        /* ===== KBD ELEMENT STYLING ===== */
        kbd {
            font-family: 'Courier New', monospace;
            background: var(--dark);
            color: var(--light);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-size: 0.9rem;
            box-shadow: 0 2px 0 rgba(0,0,0,0.2);
        }

        /* ===== SAMP ELEMENT STYLING ===== */
        samp {
            font-family: 'Courier New', monospace;
            background: var(--light);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            color: var(--success);
            font-size: 0.9rem;
        }

        /* ===== VAR ELEMENT STYLING ===== */
        var {
            font-style: italic;
            color: var(--primary);
        }

        /* ===== CITE ELEMENT STYLING ===== */
        cite {
            font-style: italic;
            color: var(--gray);
        }

        /* ===== Q ELEMENT STYLING ===== */
        q {
            quotes: "«" "»" "‹" "›";
            color: var(--primary);
        }

        q:before {
            content: open-quote;
        }

        q:after {
            content: close-quote;
        }

        /* ===== BLOCKQUOTE STYLING ===== */
        blockquote {
            border-left: 4px solid var(--primary);
            margin: 1rem 0;
            padding: 0.5rem 1rem;
            background: rgba(0,102,204,0.05);
            border-radius: 0 8px 8px 0;
        }

        blockquote footer {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: var(--gray);
            text-align: right;
        }

        /* ===== HR STYLING ===== */
        hr {
            border: none;
            height: 1px;
            background: var(--border);
            margin: 2rem 0;
        }

        /* ===== FIGURE AND FIGCAPTION STYLING ===== */
        figure {
            margin: 2rem 0;
            text-align: center;
        }

        figcaption {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: var(--gray);
            font-style: italic;
        }

        /* ===== ABBR STYLING ===== */
        abbr[title] {
            border-bottom: 1px dotted var(--gray);
            cursor: help;
            text-decoration: none;
        }

        /* ===== SUB AND SUP STYLING ===== */
        sub, sup {
            font-size: 0.7rem;
            line-height: 0;
            position: relative;
            vertical-align: baseline;
        }

        sup {
            top: -0.5em;
        }

        sub {
            bottom: -0.25em;
        }

        /* ===== INS AND DEL STYLING ===== */
        ins {
            background: rgba(76,175,80,0.2);
            text-decoration: none;
            padding: 0 2px;
        }

        del {
            background: rgba(244,67,54,0.2);
            text-decoration: line-through;
            padding: 0 2px;
        }

        /* ===== DFN STYLING ===== */
        dfn {
            font-style: italic;
            font-weight: bold;
        }

        /* ===== ADDRESS STYLING ===== */
        address {
            font-style: normal;
            color: var(--gray);
            line-height: 1.6;
        }

        /* ===== BDI AND BDO STYLING ===== */
        bdi {
            unicode-bidi: isolate;
        }

        bdo[dir="rtl"] {
            direction: rtl;
            unicode-bidi: bidi-override;
        }

        /* ===== RUBY STYLING ===== */
        ruby {
            ruby-align: center;
        }

        rt {
            font-size: 0.7rem;
            color: var(--gray);
        }

        /* ===== WBR STYLING ===== */
        wbr {
            display: inline-block;
        }

        /* ===== DATA STYLING ===== */
        data {
            font-feature-settings: "tnum";
            font-variant-numeric: tabular-nums;
        }

        /* ===== METER CUSTOM STYLING ===== */
        .custom-meter {
            width: 100%;
            height: 20px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .custom-meter-fill {
            height: 100%;
            background: var(--primary);
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .custom-meter-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            font-size: 0.8rem;
            color: var(--gray);
        }

        /* ===== CUSTOM SCROLLBAR FOR SPECIFIC ELEMENTS ===== */
        .custom-scrollbar {
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--border);
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: var(--border);
            border-radius: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        /* ===== PRINT MEDIA QUERY ENHANCEMENTS ===== */
        @media print {
            @page {
                size: A4;
                margin: 2cm;
            }
            
            body {
                font-size: 12pt;
                line-height: 1.5;
            }
            
            h1, h2, h3 {
                page-break-after: avoid;
            }
            
            img, table, figure {
                page-break-inside: avoid;
            }
            
            a {
                color: black;
                text-decoration: underline;
            }
            
            a[href]:after {
                content: " (" attr(href) ")";
                font-size: 0.8em;
                font-weight: normal;
            }
            
            .no-print, .no-print * {
                display: none !important;
            }
        }

        /* ===== SAFARI SPECIFIC FIXES ===== */
        _::-webkit-full-page-media, _:future, :root .safari-only {
            /* Safari specific styles */
        }

        /* ===== FIREFOX SPECIFIC FIXES ===== */
        @-moz-document url-prefix() {
            .firefox-only {
                /* Firefox specific styles */
            }
        }

        /* ===== EDGE SPECIFIC FIXES ===== */
        @supports (-ms-ime-align: auto) {
            .edge-only {
                /* Edge specific styles */
            }
        }

        /* ===== INTERNET EXPLORER FALLBACKS ===== */
        @media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
            .ie-fallback {
                display: block;
            }
            
            .grid-2, .grid-3, .grid-4 {
                display: block;
            }
            
            .grid-2 > *, .grid-3 > *, .grid-4 > * {
                display: inline-block;
                width: 48%;
                margin: 1%;
                vertical-align: top;
            }
        }

        /* ===== WEBKIT SPECIFIC STYLES ===== */
        @media (-webkit-min-device-pixel-ratio: 0) {
            .webkit-only {
                /* WebKit specific styles */
            }
        }

        /* ===== BLINK SPECIFIC STYLES ===== */
        @media (min-resolution: 0.001dpcm) {
            .blink-only {
                /* Blink specific styles */
            }
        }

        /* ===== OPERA SPECIFIC STYLES ===== */
        x:-o-prefocus, .opera-only {
            /* Opera specific styles */
        }

        /* ===== FINAL CLEANUP AND OPTIMIZATION ===== */
        .optimize-legibility {
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .performance {
            will-change: transform;
            backface-visibility: hidden;
            transform: translateZ(0);
        }

        .hardware-accelerated {
            transform: translate3d(0, 0, 0);
        }

        /* ===== FINAL SYSTEM SPECIFIC OVERRIDES ===== */
        .system-windows {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        .system-mac {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', system-ui, sans-serif;
        }

        .system-linux {
            font-family: 'Ubuntu', 'Cantarell', system-ui, sans-serif;
        }

        /* ===== CALENDARIO MEJORADO ===== */
.calendario-container {
    background: white;
    border-radius: 12px;
    padding: 24px;
    box-shadow: var(--shadow);
    margin-bottom: 24px;
}

[data-theme="dark"] .calendario-container {
    background: #2D333B;
}

.calendario-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
    padding-bottom: 16px;
    border-bottom: 2px solid var(--border);
}

.calendario-vista {
    display: flex;
    gap: 8px;
    background: var(--light);
    padding: 4px;
    border-radius: 8px;
}

.calendario-vista .btn {
    border-radius: 6px;
    padding: 8px 16px;
    min-height: auto;
}

.calendario-vista .btn.active {
    background: var(--primary);
    color: white;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
}

.calendario-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 20px;
}

.calendario-dia {
    background: white;
    padding: 12px;
    min-height: 120px;
    position: relative;
    transition: all 0.2s;
    cursor: pointer;
}

[data-theme="dark"] .calendario-dia {
    background: #2D333B;
}

.calendario-dia:hover {
    background: rgba(0, 102, 204, 0.05);
    transform: translateY(-2px);
    z-index: 1;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.calendario-dia.nombre-dia {
    background: var(--primary);
    color: white;
    text-align: center;
    font-weight: 600;
    padding: 12px;
    min-height: auto;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.calendario-dia.otro-mes {
    background: var(--light);
    color: var(--gray);
    opacity: 0.6;
}

.calendario-dia.hoy {
    background: rgba(0, 102, 204, 0.15);
    border: 2px solid var(--primary);
}

.calendario-dia-numero {
    font-weight: bold;
    margin-bottom: 8px;
    color: var(--dark);
    font-size: 1.1rem;
}

.calendario-eventos {
    margin-top: 8px;
}

.calendario-evento {
    font-size: 0.75rem;
    padding: 4px 6px;
    margin-bottom: 4px;
    border-radius: 4px;
    background: rgba(0, 102, 204, 0.1);
    color: var(--primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    display: flex;
    align-items: center;
    gap: 4px;
}

.calendario-evento i {
    font-size: 6px;
}

.calendario-evento.evento-alta {
    background: rgba(244, 67, 54, 0.1);
    color: var(--danger);
}

.calendario-evento.evento-media {
    background: rgba(255, 152, 0, 0.1);
    color: var(--warning);
}

.calendario-evento.evento-baja {
    background: rgba(76, 175, 80, 0.1);
    color: var(--success);
}

.calendario-mas-eventos {
    font-size: 0.7rem;
    color: var(--gray);
    text-align: center;
    padding: 2px;
    background: rgba(0,0,0,0.05);
    border-radius: 3px;
    margin-top: 4px;
}

/* ===== TEMA DE ALTO CONTRASTE PARA ACCESIBILIDAD ===== */
[data-theme="high-contrast"] {
    --primary: #0000FF;
    --primary-dark: #0000CC;
    --secondary: #FF6600;
    --success: #008000;
    --danger: #FF0000;
    --warning: #FFAA00;
    --info: #008080;
    --light: #FFFFFF;
    --dark: #000000;
    --gray: #404040;
    --border: #000000;
    --shadow: 0 0 0 2px #000000;
}

[data-theme="high-contrast"] * {
    border-color: #000000 !important;
}

[data-theme="high-contrast"] .btn,
[data-theme="high-contrast"] button,
[data-theme="high-contrast"] input,
[data-theme="high-contrast"] select,
[data-theme="high-contrast"] textarea {
    border: 2px solid #000000 !important;
}

/* ===== BOTONES MEJORADOS (GORDITOS Y BRILLANTES) ===== */
.btn {
    position: relative;
    overflow: hidden;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    transform-origin: center;
    border: none;
    font-weight: 600;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    min-height: 48px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

/* Efecto brillante al pasar el mouse */
.btn:before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.3), 
        transparent);
    transition: left 0.6s;
}

.btn:hover:before {
    left: 100%;
}

/* Botón primario mejorado */
.btn-primary {
    background: linear-gradient(135deg, 
        var(--primary) 0%, 
        var(--primary-dark) 50%, 
        var(--primary) 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(var(--primary-rgb, 0, 102, 204), 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    padding: 12px 24px;
}

.btn-primary:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 8px 25px rgba(var(--primary-rgb, 0, 102, 204), 0.4),
                0 0 20px rgba(var(--primary-rgb, 0, 102, 204), 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

.btn-primary:active {
    transform: translateY(1px) scale(0.98);
}

/* Botón secundario mejorado */
.btn-secondary {
    background: linear-gradient(135deg, 
        var(--gray) 0%, 
        #495057 50%, 
        var(--gray) 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    padding: 12px 24px;
}

/* Botón éxito mejorado */
.btn-success {
    background: linear-gradient(135deg, 
        var(--success) 0%, 
        #1E7E34 50%, 
        var(--success) 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    padding: 12px 24px;
}

/* Botón peligro mejorado */
.btn-danger {
    background: linear-gradient(135deg, 
        var(--danger) 0%, 
        #BD2130 50%, 
        var(--danger) 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(244, 67, 54, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    padding: 12px 24px;
}

/* Botón con efecto neón (para acciones importantes) */
.btn-neon {
    background: linear-gradient(135deg, 
        var(--primary) 0%, 
        #4DABF7 50%, 
        var(--primary) 100%);
    color: white;
    border: 2px solid var(--primary);
    box-shadow: 0 0 15px var(--primary),
                0 0 30px rgba(var(--primary-rgb, 0, 102, 204), 0.5),
                0 0 45px rgba(var(--primary-rgb, 0, 102, 204), 0.3);
    animation: neon-pulse 2s infinite;
    border-radius: 12px;
    padding: 12px 24px;
}

@keyframes neon-pulse {
    0%, 100% {
        box-shadow: 0 0 15px var(--primary),
                    0 0 30px rgba(var(--primary-rgb, 0, 102, 204), 0.5),
                    0 0 45px rgba(var(--primary-rgb, 0, 102, 204), 0.3);
    }
    50% {
        box-shadow: 0 0 20px var(--primary),
                    0 0 40px rgba(var(--primary-rgb, 0, 102, 204), 0.7),
                    0 0 60px rgba(var(--primary-rgb, 0, 102, 204), 0.5);
    }
}

/* Botón con efecto 3D */
.btn-3d {
    background: linear-gradient(to bottom, 
        var(--primary) 0%, 
        var(--primary-dark) 100%);
    color: white;
    border: none;
    border-bottom: 6px solid var(--primary-dark);
    border-radius: 12px;
    text-shadow: 0 -1px 0 var(--primary-dark);
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.2),
                0 6px 0 var(--primary-dark),
                0 8px 10px rgba(0,0,0,0.4);
    padding: 12px 24px;
}

.btn-3d:hover {
    transform: translateY(4px);
    border-bottom-width: 2px;
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.2),
                0 2px 0 var(--primary-dark),
                0 4px 8px rgba(0,0,0,0.3);
}

/* Selector de temas en el header */
.theme-selector {
    position: relative;
    display: inline-block;
}

.theme-menu {
    position: absolute;
    top: 100%;
    right: 0;
    background: var(--light);
    border-radius: 8px;
    box-shadow: var(--shadow);
    padding: 8px;
    display: none;
    min-width: 160px;
    z-index: 1000;
    border: 1px solid var(--border);
}

.theme-selector:hover .theme-menu {
    display: block;
}

.theme-option {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px;
    width: 100%;
    text-align: left;
    background: none;
    border: none;
    border-radius: 4px;
    color: var(--dark);
    cursor: pointer;
    transition: background-color 0.2s;
}

.theme-option:hover {
    background: rgba(0, 102, 204, 0.1);
}

.theme-option i {
    width: 20px;
    text-align: center;
}

/* Botón de tema en header */
#themeToggle {
    position: relative;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--primary);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
}

#themeToggle:hover {
    transform: rotate(30deg);
    background: var(--primary-dark);
}

        /* ===== END OF STYLES ===== */
    </style>
</head>
<body data-theme="light">
    <!-- Modal de Confirmación -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-exclamation-triangle"></i> Confirmar acción</h3>
            <p id="confirmMessage">¿Está seguro de realizar esta acción?</p>
            <div class="modal-buttons">
                <button id="confirmCancel" class="btn-secondary">Cancelar</button>
                <button id="confirmOk" class="btn-danger">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Información -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-info-circle"></i> Información</h3>
            <p id="infoMessage"></p>
            <div class="modal-buttons">
                <button id="infoClose" class="btn-primary">Aceptar</button>
            </div>
        </div>
    </div>

    <!-- Notificaciones -->
    <div id="notificationArea"></div>

    <!-- Carga -->
    <div id="loadingOverlay">
        <div class="spinner"></div>
        <p>Cargando sistema...</p>
    </div>

    <!-- Barra de Progreso Global -->
    <div id="globalProgress" class="progress-container">
        <div class="progress-bar">
            <div class="progress-fill"></div>
        </div>
        <div class="progress-text">0%</div>
    </div>

    <!-- Watermark -->
    <div class="watermark">DRTE MEP</div>

    <!-- Back to Top -->
    <button class="back-to-top">
        <i class="fas fa-chevron-up"></i>
    </button>

    <!-- Floating Action Button -->
    <button class="fab" id="quickAddBtn">
        <i class="fas fa-plus"></i>
    </button>

    <!-- Encabezado -->
    <header class="sticky-header">
        <div class="header-container">
            <div class="logo">
                <div class="avatar lg" style="background: #0066CC;">MEP</div>
                <div class="logo-text">
                    <h1>Sistema Integral DRTE MEP</h1>
                    <p>Gestión de Evidencias y Agenda - PNFT</p>
                </div>
            </div>
            
            <div class="header-controls">
                <div class="input-group">
                    <input type="text" id="globalSearch" placeholder="Buscar en el sistema...">
                    <button class="btn-icon"><i class="fas fa-search"></i></button>
                </div>
                
                <div class="theme-selector">
                    <button id="themeToggle" class="btn-icon" title="Cambiar tema">
                        <i class="fas fa-moon"></i>
                    </button>
                    <div class="theme-menu">
                        <button class="theme-option" data-theme="light">
                            <i class="fas fa-sun"></i> Tema Claro
                        </button>
                        <button class="theme-option" data-theme="dark">
                            <i class="fas fa-moon"></i> Tema Oscuro
                        </button>
                        <button class="theme-option" data-theme="high-contrast">
                            <i class="fas fa-eye"></i> Alto Contraste
                        </button>
                    </div>
                </div>
                
                <div class="notification-bell">
                    <button class="btn-icon" id="notificationsBtn">
                        <i class="fas fa-bell"></i>
                        <span class="badge badge-danger" id="notificationCount">0</span>
                    </button>
                </div>
                
                <div class="user-info">
                    <span id="currentUser">Asesor DRTE</span>
                    <div class="user-menu">
                        <button class="btn-icon" id="userMenuBtn">
                            <i class="fas fa-user-circle"></i>
                        </button>
                        <div class="dropdown-menu">
                            <a href="#" id="profileBtn"><i class="fas fa-user"></i> Mi Perfil</a>
                            <a href="#" id="settingsBtn"><i class="fas fa-cog"></i> Configuración</a>
                            <a href="#" id="backupBtn"><i class="fas fa-database"></i> Respaldo</a>
                            <a href="#" id="restoreBtn"><i class="fas fa-undo"></i> Restaurar</a>
                            <hr>
                            <a href="#" id="helpBtn"><i class="fas fa-question-circle"></i> Ayuda</a>
                            <a href="#" id="aboutBtn"><i class="fas fa-info-circle"></i> Acerca de</a>
                            <hr>
                            <a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Navegación Principal -->
        <nav class="main-nav">
            <ul>
                <li><a href="#dashboard" class="nav-link active"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                <li><a href="#bitacora" class="nav-link"><i class="fas fa-book"></i> Bitácora</a></li>
                <li><a href="#tareas" class="nav-link"><i class="fas fa-tasks"></i> Tareas</a></li>
                <li><a href="#calendario" class="nav-link"><i class="fas fa-calendar-alt"></i> Calendario</a></li>
                <li><a href="#archivos" class="nav-link"><i class="fas fa-folder-open"></i> Archivos</a></li>
                <li><a href="#informes" class="nav-link"><i class="fas fa-chart-bar"></i> Informes</a></li>
                <li><a href="#enlaces" class="nav-link"><i class="fas fa-link"></i> Enlaces MEP</a></li>
                <li><a href="#config" class="nav-link"><i class="fas fa-cogs"></i> Sistema</a></li>
            </ul>
        </nav>
    </header>

    <!-- Contenido Principal -->
    <main>
        <!-- Sección: Dashboard -->
        <section id="dashboard" class="content-section active">
            <div class="section-header">
                <h2><i class="fas fa-tachometer-alt"></i> Dashboard de Actividades</h2>
                <div class="section-controls">
                    <button id="refreshDashboard" class="btn-primary">
                        <i class="fas fa-sync-alt"></i> Actualizar
                    </button>
                    <button id="exportDashboard" class="btn-success">
                        <i class="fas fa-download"></i> Exportar
                    </button>
                </div>
            </div>
            
            <div class="welcome-message">
                <h2>¡Bienvenido al Sistema DRTE MEP!</h2>
                <p>Sistema integral para la gestión de evidencias, agenda y actividades del PNFT</p>
            </div>
            
            <div class="quick-actions">
                <div class="quick-action" onclick="showSection('bitacora')">
                    <i class="fas fa-plus-circle"></i>
                    <h4>Nueva Bitácora</h4>
                    <p>Registrar actividad diaria</p>
                </div>
                <div class="quick-action" onclick="showSection('tareas')">
                    <i class="fas fa-tasks"></i>
                    <h4>Nueva Tarea</h4>
                    <p>Crear actividad pendiente</p>
                </div>
                <div class="quick-action" onclick="showSection('archivos')">
                    <i class="fas fa-upload"></i>
                    <h4>Subir Archivos</h4>
                    <p>Cargar evidencias</p>
                </div>
                <div class="quick-action" onclick="showSection('informes')">
                    <i class="fas fa-chart-pie"></i>
                    <h4>Generar Informe</h4>
                    <p>Crear reporte institucional</p>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: #4CAF50;">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Tareas Pendientes</h3>
                        <p id="tareasPendientes">0</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: #2196F3;">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Actividades Hoy</h3>
                        <p id="actividadesHoy">0</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: #FF9800;">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Documentos Subidos</h3>
                        <p id="documentosSubidos">0</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: #9C27B0;">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Productividad</h3>
                        <p id="productividad">0%</p>
                    </div>
                </div>
            </div>
            
            <div class="grid-2">
                <div class="recent-activity">
                    <h3><i class="fas fa-history"></i> Actividad Reciente</h3>
                    <div id="actividadReciente">
                        <!-- Actividades recientes se cargarán aquí -->
                    </div>
                </div>
                
                <div class="recent-activity">
                    <h3><i class="fas fa-clock"></i> Próximas Actividades</h3>
                    <div id="proximasActividades">
                        <!-- Próximas actividades se cargarán aquí -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Sección: Bitácora Diaria -->
        <section id="bitacora" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-book"></i> Bitácora Diaria</h2>
                <div class="section-controls">
                    <button id="nuevaBitacora" class="btn-primary">
                        <i class="fas fa-plus"></i> Nueva Entrada
                    </button>
                    <button id="exportarBitacora" class="btn-success">
                        <i class="fas fa-download"></i> Exportar
                    </button>
                </div>
            </div>
            
            <div class="bitacora-form">
                <div class="form-group">
                    <label for="fechaBitacora"><i class="fas fa-calendar"></i> Fecha</label>
                    <input type="date" id="fechaBitacora" class="form-control" value="<?php echo date('Y-m-d'); ?>">
                </div>
                
                <div class="form-group">
                    <label for="actividad"><i class="fas fa-tasks"></i> Actividad Realizada</label>
                    <textarea id="actividad" class="form-control" rows="4" 
                              placeholder="Describa la actividad realizada..."></textarea>
                    <div class="char-counter">
                        <span id="contadorActividad">0</span>/1000 caracteres
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="observaciones"><i class="fas fa-sticky-note"></i> Observaciones</label>
                    <textarea id="observaciones" class="form-control" rows="3" 
                              placeholder="Observaciones importantes..."></textarea>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-paperclip"></i> Adjuntar Archivos</label>
                    <div class="file-drop-area" id="fileDropArea">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h4>Arrastra y suelta archivos aquí</h4>
                        <p>o haz clic para seleccionar</p>
                        <input type="file" id="archivosBitacora" multiple 
                               accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.jpg,.jpeg,.png,.txt">
                        <p class="help-text">Máximo 10 archivos, 50MB cada uno</p>
                    </div>
                    <div id="listaArchivosBitacora" class="archivos-list">
                        <!-- Archivos seleccionados aparecerán aquí -->
                    </div>
                </div>
                
                <div class="form-group">
                    <button id="guardarBitacora" class="btn-primary">
                        <i class="fas fa-save"></i> Guardar Bitácora
                    </button>
                    <button id="limpiarBitacora" class="btn-secondary">
                        <i class="fas fa-trash"></i> Limpiar
                    </button>
                </div>
            </div>
            
            <div class="recent-activity">
                <h3><i class="fas fa-history"></i> Entradas Recientes</h3>
                <div id="listaBitacora">
                    <!-- Entradas de bitácora se cargarán aquí -->
                </div>
            </div>
        </section>

        <!-- Sección: Gestión de Tareas -->
        <section id="tareas" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-tasks"></i> Gestión de Tareas</h2>
                <div class="section-controls">
                    <button id="nuevaTarea" class="btn-primary">
                        <i class="fas fa-plus"></i> Nueva Tarea
                    </button>
                    <button id="filtrarTareas" class="btn-secondary">
                        <i class="fas fa-filter"></i> Filtrar
                    </button>
                </div>
            </div>
            
            <div class="tareas-container">
                <div class="bitacora-form">
                    <h3><i class="fas fa-plus-circle"></i> Crear Nueva Tarea</h3>
                    
                    <div class="form-group">
                        <label for="tituloTarea"><i class="fas fa-heading"></i> Título</label>
                        <input type="text" id="tituloTarea" class="form-control" 
                               placeholder="Título de la tarea...">
                    </div>
                    
                    <div class="form-group">
                        <label for="descripcionTarea"><i class="fas fa-align-left"></i> Descripción</label>
                        <textarea id="descripcionTarea" class="form-control" rows="3" 
                                  placeholder="Descripción detallada..."></textarea>
                    </div>
                    
                    <div class="grid-2">
                        <div class="form-group">
                            <label for="prioridadTarea"><i class="fas fa-exclamation-circle"></i> Prioridad</label>
                            <select id="prioridadTarea" class="form-control">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Media</option>
                                <option value="baja">Baja</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="fechaVencimiento"><i class="fas fa-calendar-times"></i> Fecha Vencimiento</label>
                            <input type="date" id="fechaVencimiento" class="form-control">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="estadoTarea"><i class="fas fa-check-circle"></i> Estado</label>
                        <select id="estadoTarea" class="form-control">
                            <option value="pendiente">Pendiente</option>
                            <option value="en-progreso">En Progreso</option>
                            <option value="completado">Completado</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <button id="guardarTarea" class="btn-primary">
                            <i class="fas fa-save"></i> Guardar Tarea
                        </button>
                        <button id="cancelarTarea" class="btn-secondary">
                            <i class="fas fa-times"></i> Cancelar
                        </button>
                    </div>
                </div>
                
                <div>
                    <h3><i class="fas fa-list"></i> Lista de Tareas</h3>
                    <div id="filtrosTareas" class="toolbar">
                        <div class="toolbar-group">
                            <span>Filtrar por:</span>
                            <select id="filtroPrioridad" class="form-control">
                                <option value="">Todas las prioridades</option>
                                <option value="alta">Alta</option>
                                <option value="media">Media</option>
                                <option value="baja">Baja</option>
                            </select>
                        </div>
                        <div class="toolbar-group">
                            <select id="filtroEstado" class="form-control">
                                <option value="">Todos los estados</option>
                                <option value="pendiente">Pendiente</option>
                                <option value="en-progreso">En Progreso</option>
                                <option value="completado">Completado</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="listaTareas">
                        <!-- Tareas se cargarán aquí -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Sección: Calendario -->
        <section id="calendario" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-calendar-alt"></i> Calendario de Actividades</h2>
                <div class="section-controls">
                    <div class="calendario-vista">
                        <button id="vistaDia" class="btn-secondary active">Día</button>
                        <button id="vistaSemana" class="btn-secondary">Semana</button>
                        <button id="vistaMes" class="btn-secondary">Mes</button>
                    </div>
                    <button id="nuevoEvento" class="btn-primary">
                        <i class="fas fa-plus"></i> Nuevo Evento
                    </button>
                </div>
            </div>
            
            <div class="calendario-container">
                <div class="calendario-header">
                    <div>
                        <button id="mesAnterior" class="btn-icon"><i class="fas fa-chevron-left"></i></button>
                        <h3 id="mesActual">Enero 2024</h3>
                        <button id="mesSiguiente" class="btn-icon"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    <button id="hoy" class="btn-primary">Hoy</button>
                </div>
                
                <div class="calendario-grid" id="calendarioGrid">
                    <!-- Calendario se generará aquí -->
                </div>
            </div>
            
            <div class="recent-activity">
                <h3><i class="fas fa-list-alt"></i> Eventos del Mes</h3>
                <div id="listaEventos">
                    <!-- Eventos del mes se cargarán aquí -->
                </div>
            </div>
        </section>

        <!-- Sección: Sistema de Archivos -->
        <section id="archivos" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-folder-open"></i> Sistema de Archivos</h2>
                <div class="section-controls">
                    <div class="file-upload-custom">
                        <input type="file" id="subirArchivoMultiple" multiple>
                        <label for="subirArchivoMultiple" class="file-upload-custom-label">
                            <i class="fas fa-upload"></i> Subir Archivos
                        </label>
                    </div>
                    <button id="crearCarpeta" class="btn-primary">
                        <i class="fas fa-folder-plus"></i> Nueva Carpeta
                    </button>
                </div>
            </div>
            
            <div class="toolbar">
                <div class="toolbar-group">
                    <button id="vistaLista" class="btn-icon active"><i class="fas fa-list"></i></button>
                    <button id="vistaGrid" class="btn-icon"><i class="fas fa-th-large"></i></button>
                </div>
                <div class="toolbar-group">
                    <select id="ordenarArchivos" class="form-control">
                        <option value="nombre">Nombre</option>
                        <option value="fecha">Fecha</option>
                        <option value="tipo">Tipo</option>
                        <option value="tamaño">Tamaño</option>
                    </select>
                </div>
                <div class="toolbar-group">
                    <input type="text" id="buscarArchivos" class="form-control" placeholder="Buscar archivos...">
                </div>
            </div>
            
            <div class="archivos-grid" id="contenedorArchivos">
                <!-- Archivos se cargarán aquí -->
            </div>
            
            <div class="recent-activity">
                <h3><i class="fas fa-chart-pie"></i> Estadísticas de Almacenamiento</h3>
                <div class="grid-4">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #2196F3;">
                            <i class="fas fa-file"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Total Archivos</h3>
                            <p id="totalArchivos">0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #4CAF50;">
                            <i class="fas fa-hdd"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Espacio Usado</h3>
                            <p id="espacioUsado">0 MB</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #FF9800;">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Documentos PDF</h3>
                            <p id="totalPDF">0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #9C27B0;">
                            <i class="fas fa-file-word"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Documentos Word</h3>
                            <p id="totalWord">0</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Sección: Informes Institucionales -->
        <section id="informes" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-chart-bar"></i> Sistema de Informes</h2>
                <div class="section-controls">
                    <button id="nuevoInforme" class="btn-primary">
                        <i class="fas fa-plus"></i> Nuevo Informe
                    </button>
                    <div class="dropdown-menu">
                        <button class="btn-success" id="exportarMenu">
                            <i class="fas fa-download"></i> Exportar
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="dropdown-content">
                            <a href="#" id="exportarPDF"><i class="fas fa-file-pdf"></i> PDF</a>
                            <a href="#" id="exportarExcel"><i class="fas fa-file-excel"></i> Excel</a>
                            <a href="#" id="exportarWord"><i class="fas fa-file-word"></i> Word</a>
                            <a href="#" id="exportarCSV"><i class="fas fa-file-csv"></i> CSV</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="informes-grid">
                <div class="informe-card">
                    <div class="informe-header">
                        <h3>Informe Mensual</h3>
                        <div class="informe-actions">
                            <button class="btn-icon" onclick="expandirInforme('mensual')">
                                <i class="fas fa-expand"></i>
                            </button>
                            <button class="btn-icon" onclick="exportarInforme('mensual')">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                    <p>Resumen de actividades realizadas durante el mes</p>
                    <div id="detalle-mensual" class="detalle-informe">
                        <p>Detalles completos del informe mensual...</p>
                    </div>
                    <button class="btn-link" onclick="toggleDetalle('mensual')">Ver más detalles</button>
                </div>
                
                <div class="informe-card">
                    <div class="informe-header">
                        <h3>Informe de Tareas</h3>
                        <div class="informe-actions">
                            <button class="btn-icon" onclick="expandirInforme('tareas')">
                                <i class="fas fa-expand"></i>
                            </button>
                            <button class="btn-icon" onclick="exportarInforme('tareas')">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                    <p>Estado de tareas pendientes y completadas</p>
                    <div id="detalle-tareas" class="detalle-informe">
                        <p>Detalles completos del informe de tareas...</p>
                    </div>
                    <button class="btn-link" onclick="toggleDetalle('tareas')">Ver más detalles</button>
                </div>
                
                <div class="informe-card">
                    <div class="informe-header">
                        <h3>Informe de Archivos</h3>
                        <div class="informe-actions">
                            <button class="btn-icon" onclick="expandirInforme('archivos')">
                                <i class="fas fa-expand"></i>
                            </button>
                            <button class="btn-icon" onclick="exportarInforme('archivos')">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                    <p>Estadísticas de documentos y archivos gestionados</p>
                    <div id="detalle-archivos" class="detalle-informe">
                        <p>Detalles completos del informe de archivos...</p>
                    </div>
                    <button class="btn-link" onclick="toggleDetalle('archivos')">Ver más detalles</button>
                </div>
            </div>
            
            <div class="panel-control">
                <h3><i class="fas fa-cogs"></i> Configuración de Informes</h3>
                <div class="control-item">
                    <label>Formato de exportación predeterminado:</label>
                    <select id="formatoExportacion" class="form-control">
                        <option value="pdf">PDF</option>
                        <option value="excel">Excel</option>
                        <option value="word">Word</option>
                    </select>
                </div>
                <div class="control-item">
                    <label>Incluir logo MEP:</label>
                    <input type="checkbox" id="incluirLogo" checked>
                </div>
                <div class="control-item">
                    <label>Generar automáticamente:</label>
                    <select id="frecuenciaInformes" class="form-control">
                        <option value="">Manual</option>
                        <option value="diario">Diario</option>
                        <option value="semanal">Semanal</option>
                        <option value="mensual">Mensual</option>
                    </select>
                </div>
            </div>
        </section>

        <!-- Sección: Enlaces MEP -->
        <section id="enlaces" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-link"></i> Enlaces Institucionales MEP</h2>
                <div class="section-controls">
                    <button id="actualizarEnlaces" class="btn-primary">
                        <i class="fas fa-sync-alt"></i> Actualizar
                    </button>
                </div>
            </div>
            
            <div class="enlaces-grid">
                <a href="https://pnft.mep.go.cr/asesoriapnft/app/home" target="_blank" class="enlace-card">
                    <div class="enlace-icon">
                        <i class="fas fa-chalkboard-teacher"></i>
                    </div>
                    <h3>PNFT</h3>
                    <p>Plataforma Nacional de Formación Técnica</p>
                </a>
                
                <a href="https://adminmepcr.sharepoint.com/sites/repositorio-pnft" target="_blank" class="enlace-card">
                    <div class="enlace-icon">
                        <i class="fas fa-database"></i>
                    </div>
                    <h3>Repositorios</h3>
                    <p>Repositorio de documentos PNFT</p>
                </a>
                
                <a href="https://adminmepcr.sharepoint.com/sites/DiseoMallaCurricular-Enmallados" target="_blank" class="enlace-card">
                    <div class="enlace-icon">
                        <i class="fas fa-project-diagram"></i>
                    </div>
                    <h3>Diseño Malla Curricular</h3>
                    <p>Diseño y ajuste de mallas curriculares</p>
                </a>
                
                <a href="https://adminmepcr.sharepoint.com/sites/DRTE-Intranet" target="_blank" class="enlace-card">
                    <div class="enlace-icon">
                        <i class="fas fa-network-wired"></i>
                    </div>
                    <h3>SharePoint DRTE</h3>
                    <p>Intranet y documentos DRTE</p>
                </a>

                <!-- NUEVOS ENLACES ADICIONALES -->
    
                <!-- YouTube -->
                <a href="https://www.youtube.com" target="_blank" class="enlace-card hover-lift">
                    <div class="enlace-icon" style="color: #FF0000;">
                        <i class="fab fa-youtube"></i>
                    </div>
                    <h3>YouTube</h3>
                    <p>Investigación y recursos educativos</p>
                </a>
                
                <!-- Correo MEP -->
                <a href="https://outlook.office365.com/mail/" target="_blank" class="enlace-card hover-lift">
                    <div class="enlace-icon" style="color: #0078D4;">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <h3>Correo MEP</h3>
                    <p>Correo institucional Office 365</p>
                </a>
                
                <!-- Microsoft Teams -->
                <a href="https://teams.microsoft.com" target="_blank" class="enlace-card hover-lift">
                    <div class="enlace-icon" style="color: #6264A7;">
                        <i class="fab fa-microsoft"></i>
                    </div>
                    <h3>Microsoft Teams</h3>
                    <p>Colaboración y reuniones virtuales</p>
                </a>
                
                <!-- OneNote -->
                <a href="https://m365.cloud.microsoft/launch/onenote?auth=2" target="_blank" class="enlace-card hover-lift">
                    <div class="enlace-icon" style="color: #7719AA;">
                        <i class="fas fa-sticky-note"></i>
                    </div>
                    <h3>OneNote</h3>
                    <p>Notas digitales y organización</p>
                </a>
                
                <!-- Symbaloo -->
                <a href="https://www.symbaloo.com/home/mix/13eP7Bh97Y" target="_blank" class="enlace-card hover-lift">
                    <div class="enlace-icon" style="color: #00B0F0;">
                        <i class="fas fa-th-large"></i>
                    </div>
                    <h3>Symbaloo</h3>
                    <p>Organizador de recursos web</p>
                </a>
                
                <!-- Copilot -->
                <a href="https://m365.cloud.microsoft/chat/?auth=2&home=1" target="_blank" class="enlace-card hover-lift">
                    <div class="enlace-icon" style="color: #10B981;">
                        <i class="fas fa-robot"></i>
                    </div>
                    <h3>Microsoft Copilot</h3>
                    <p>Asistente de IA para productividad</p>
                </a>
            </div>
            
            <div class="recent-activity">
                <h3><i class="fas fa-star"></i> Enlaces Frecuentes</h3>
                <div class="grid-2">
                    <div class="informe-card">
                        <h4><i class="fas fa-envelope"></i> Correo Institucional</h4>
                        <p>correo@mep.go.cr</p>
                    </div>
                    <div class="informe-card">
                        <h4><i class="fas fa-phone"></i> Contacto DRTE</h4>
                        <p>Tel: 2222-2222</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Sección: Sistema -->
        <section id="config" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-cogs"></i> Sistema y Configuración</h2>
                <div class="section-controls">
                    <button id="guardarConfig" class="btn-primary">
                        <i class="fas fa-save"></i> Guardar Configuración
                    </button>
                </div>
            </div>
            
            <div class="config-grid">
                <div class="config-card">
                    <h3><i class="fas fa-user-cog"></i> Configuración de Usuario</h3>
                    
                    <div class="form-group">
                        <label for="nombreUsuario">Nombre de Usuario</label>
                        <input type="text" id="nombreUsuario" class="form-control" value="Asesor DRTE">
                    </div>
                    
                    <div class="form-group">
                        <label for="correoUsuario">Correo Electrónico</label>
                        <input type="email" id="correoUsuario" class="form-control" 
                               placeholder="usuario@mep.go.cr">
                    </div>
                    
                    <div class="form-group">
                        <label for="rolUsuario">Rol en el Sistema</label>
                        <select id="rolUsuario" class="form-control">
                            <option value="asesor">Asesor</option>
                            <option value="coordinador">Coordinador</option>
                            <option value="administrador">Administrador</option>
                        </select>
                    </div>
                </div>
                
                <div class="config-card">
                    <h3><i class="fas fa-shield-alt"></i> Seguridad y Respaldo</h3>
                    
                    <div class="control-item">
                        <label>Respaldo automático:</label>
                        <select id="intervaloRespaldo" class="form-control">
                            <option value="300000">Cada 5 minutos</option>
                            <option value="900000">Cada 15 minutos</option>
                            <option value="3600000">Cada hora</option>
                            <option value="86400000">Diario</option>
                            <option value="">Desactivado</option>
                        </select>
                    </div>
                    
                    <div class="control-item">
                        <label>Notificaciones:</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="notificaciones" checked>
                            <span class="toggle-slider"></span>
                        </div>
                    </div>
                    
                    <div class="control-item">
                        <label>Modo offline:</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="modoOffline" checked>
                            <span class="toggle-slider"></span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <button id="crearRespaldo" class="btn-primary">
                            <i class="fas fa-database"></i> Crear Respaldo Ahora
                        </button>
                        <button id="restaurarSistema" class="btn-warning">
                            <i class="fas fa-undo"></i> Restaurar Sistema
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="panel-control">
                <h3><i class="fas fa-tachometer-alt"></i> Estado del Sistema</h3>
                
                <div class="grid-4">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #4CAF50;">
                            <i class="fas fa-database"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Base de Datos</h3>
                            <p id="estadoDB">Activa</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #2196F3;">
                            <i class="fas fa-hdd"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Almacenamiento</h3>
                            <p id="usoAlmacenamiento">0%</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #FF9800;">
                            <i class="fas fa-memory"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Memoria</h3>
                            <p id="usoMemoria">0 MB</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #9C27B0;">
                            <i class="fas fa-sync-alt"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Último Respaldo</h3>
                            <p id="ultimoRespaldo">Nunca</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Toast Container -->
    <div class="toast-container"></div>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu">
        <div class="context-menu-item" id="ctxEditar">
            <i class="fas fa-edit"></i> Editar
        </div>
        <div class="context-menu-item" id="ctxEliminar">
            <i class="fas fa-trash"></i> Eliminar
        </div>
        <div class="context-menu-item" id="ctxDescargar">
            <i class="fas fa-download"></i> Descargar
        </div>
        <div class="context-menu-item" id="ctxCompartir">
            <i class="fas fa-share"></i> Compartir
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    
    <script>
        // ===== VARIABLES GLOBALES =====
        let db = null;
        let currentUser = {
            nombre: 'Asesor DRTE',
            rol: 'asesor',
            correo: ''
        };
        let configuracion = {
            tema: 'light',
            respaldoAutomatico: true,
            intervaloRespaldo: 300000,
            notificaciones: true,
            modoOffline: true,
            formatoExportacion: 'pdf'
        };
        let archivosSubidos = [];
        let tareas = [];
        let eventos = [];
        let bitacoras = [];

        // ===== INICIALIZACIÓN =====
        document.addEventListener('DOMContentLoaded', function() {
            inicializarSistema();
            cargarDatosIniciales();
            configurarEventos();
            actualizarDashboard();
            mostrarLoading(false);
        });

        // ===== FUNCIONES DEL SISTEMA =====
        async function inicializarSistema() {
            try {
                await inicializarBaseDatos();
                cargarConfiguracion();
                aplicarTema();
                configurarAtajosTeclado();
                iniciarRespaldoAutomatico();
                verificarRecordatorios();
                
                // Inicializar calendario
                calendario = new CalendarioDRTE();
                await calendario.inicializar();
                
                // Configurar eventos de tema
                document.querySelectorAll('.theme-option').forEach(boton => {
                    boton.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const tema = boton.dataset.theme;
                        cambiarTema(tema);
                    });
                });
                
                // Cerrar menú de temas al hacer clic fuera
                document.addEventListener('click', () => {
                    const themeMenu = document.querySelector('.theme-menu');
                    if (themeMenu) {
                        themeMenu.style.display = 'none';
                    }
                });
                
                mostrarNotificacion('Sistema inicializado correctamente', 'success');
            } catch (error) {
                console.error('Error inicializando sistema:', error);
                mostrarNotificacion('Error al inicializar el sistema', 'error');
            }
        }

        // ===== BASE DE DATOS =====
        function inicializarBaseDatos() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open('SistemaDRTE', 3);
                
                request.onerror = (event) => {
                    console.error('Error abriendo IndexedDB:', event.target.error);
                    mostrarNotificacion('Error con la base de datos local', 'error');
                    reject(event.target.error);
                };
                
                request.onsuccess = (event) => {
                    db = event.target.result;
                    console.log('Base de datos IndexedDB inicializada');
                    
                    // Verificar conexión
                    const transaction = db.transaction(['bitacoras'], 'readonly');
                    transaction.onerror = () => {
                        mostrarNotificacion('Base de datos corrupta, reiniciando...', 'warning');
                        reiniciarBaseDatos();
                    };
                    
                    resolve();
                };
                
                request.onupgradeneeded = (event) => {
                    const db = event.target.result;
                    
                    // Crear object stores si no existen
                    if (!db.objectStoreNames.contains('bitacoras')) {
                        const bitacorasStore = db.createObjectStore('bitacoras', { keyPath: 'id', autoIncrement: true });
                        bitacorasStore.createIndex('fecha', 'fecha', { unique: false });
                    }
                    
                    if (!db.objectStoreNames.contains('tareas')) {
                        const tareasStore = db.createObjectStore('tareas', { keyPath: 'id', autoIncrement: true });
                        tareasStore.createIndex('estado', 'estado', { unique: false });
                        tareasStore.createIndex('fechaVencimiento', 'fechaVencimiento', { unique: false });
                    }
                    
                    if (!db.objectStoreNames.contains('archivos')) {
                        const archivosStore = db.createObjectStore('archivos', { keyPath: 'id', autoIncrement: true });
                        archivosStore.createIndex('tipo', 'tipo', { unique: false });
                        archivosStore.createIndex('fecha', 'fecha', { unique: false });
                    }
                    
                    if (!db.objectStoreNames.contains('eventos')) {
                        const eventosStore = db.createObjectStore('eventos', { keyPath: 'id', autoIncrement: true });
                        eventosStore.createIndex('fecha', 'fecha', { unique: false });
                    }
                    
                    if (!db.objectStoreNames.contains('configuracion')) {
                        db.createObjectStore('configuracion', { keyPath: 'clave' });
                    }
                    
                    if (!db.objectStoreNames.contains('respaldos')) {
                        db.createObjectStore('respaldos', { keyPath: 'id', autoIncrement: true });
                    }
                    
                    console.log('Estructura de base de datos creada/actualizada');
                };
            });
        }

        // ===== GESTIÓN DE ARCHIVOS =====
        async function subirArchivos(files) {
            if (!files || files.length === 0) return [];
            
            const archivosProcesados = [];
            mostrarProgreso(true);
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                try {
                    const archivoData = await procesarArchivo(file);
                    archivosProcesados.push(archivoData);
                    
                    // Actualizar progreso
                    const progreso = Math.round(((i + 1) / files.length) * 100);
                    actualizarProgreso(progreso, `Procesando ${file.name}...`);
                } catch (error) {
                    console.error('Error procesando archivo:', error);
                    mostrarNotificacion(`Error procesando ${file.name}`, 'error');
                }
            }
            
            // Guardar en IndexedDB
            if (archivosProcesados.length > 0) {
                await guardarArchivosEnDB(archivosProcesados);
                mostrarNotificacion(`${archivosProcesados.length} archivo(s) subido(s) correctamente`, 'success');
            }
            
            mostrarProgreso(false);
            return archivosProcesados;
        }

        async function procesarArchivo(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const archivoData = {
                        id: Date.now() + Math.random(),
                        nombre: file.name,
                        tipo: file.type,
                        tamaño: file.size,
                        fecha: new Date().toISOString(),
                        data: e.target.result,
                        preview: generarPreview(file),
                        extension: file.name.split('.').pop().toLowerCase()
                    };
                    resolve(archivoData);
                };
                
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        function generarPreview(file) {
            if (file.type.startsWith('image/')) {
                return URL.createObjectURL(file);
            }
            
            const iconos = {
                'pdf': 'fas fa-file-pdf',
                'doc': 'fas fa-file-word',
                'docx': 'fas fa-file-word',
                'xls': 'fas fa-file-excel',
                'xlsx': 'fas fa-file-excel',
                'ppt': 'fas fa-file-powerpoint',
                'pptx': 'fas fa-file-powerpoint',
                'txt': 'fas fa-file-alt',
                'zip': 'fas fa-file-archive',
                'jpg': 'fas fa-file-image',
                'jpeg': 'fas fa-file-image',
                'png': 'fas fa-file-image'
            };
            
            const extension = file.name.split('.').pop().toLowerCase();
            return iconos[extension] || 'fas fa-file';
        }

        async function guardarArchivosEnDB(archivos) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction(['archivos'], 'readwrite');
                const store = transaction.objectStore('archivos');
                
                archivos.forEach(archivo => {
                    store.add(archivo);
                });
                
                transaction.oncomplete = () => {
                    actualizarEstadisticasArchivos();
                    resolve();
                };
                
                transaction.onerror = (event) => {
                    reject(event.target.error);
                };
            });
        }

        // ===== ELIMINACIÓN RÁPIDA DE ARCHIVOS =====
        async function eliminarArchivo(id, elemento) {
            if (!await mostrarConfirmacion('¿Está seguro de eliminar este archivo?')) {
                return;
            }
            
            // Animación inmediata
            elemento.closest('.archivo-item').style.opacity = '0.5';
            elemento.closest('.archivo-item').style.textDecoration = 'line-through';
            elemento.disabled = true;
            elemento.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            
            try {
                await eliminarArchivoDeDB(id);
                
                // Eliminar visualmente después de 300ms
                setTimeout(() => {
                    elemento.closest('.archivo-item').remove();
                    mostrarNotificacion('Archivo eliminado correctamente', 'success');
                    actualizarEstadisticasArchivos();
                }, 300);
            } catch (error) {
                console.error('Error eliminando archivo:', error);
                elemento.closest('.archivo-item').style.opacity = '1';
                elemento.closest('.archivo-item').style.textDecoration = 'none';
                elemento.disabled = false;
                elemento.innerHTML = '<i class="fas fa-trash"></i>';
                mostrarNotificacion('Error al eliminar archivo', 'error');
            }
        }

        async function eliminarArchivoDeDB(id) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction(['archivos'], 'readwrite');
                const store = transaction.objectStore('archivos');
                const request = store.delete(id);
                
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        // ===== GESTIÓN DE TAREAS (EDITAR/ELIMINAR) =====
        function habilitarEdicionTarea(id) {
            const tarea = document.querySelector(`[data-id="${id}"]`);
            const campos = tarea.querySelectorAll('.tarea-campo');
            
            campos.forEach(campo => {
                campo.contentEditable = true;
                campo.classList.add('editando');
                campo.focus();
            });
            
            const btnEditar = tarea.querySelector('.btn-editar');
            btnEditar.innerHTML = '<i class="fas fa-save"></i>';
            btnEditar.onclick = () => guardarEdicionTarea(id);
        }

        async function guardarEdicionTarea(id) {
            const tarea = document.querySelector(`[data-id="${id}"]`);
            const campos = tarea.querySelectorAll('.tarea-campo');
            const datosActualizados = {};
            
            campos.forEach(campo => {
                const campoNombre = campo.dataset.campo;
                datosActualizados[campoNombre] = campo.textContent.trim();
                campo.contentEditable = false;
                campo.classList.remove('editando');
            });
            
            try {
                await actualizarTareaEnDB(id, datosActualizados);
                
                const btnEditar = tarea.querySelector('.btn-editar');
                btnEditar.innerHTML = '<i class="fas fa-edit"></i>';
                btnEditar.onclick = () => habilitarEdicionTarea(id);
                
                mostrarNotificacion('Tarea actualizada correctamente', 'success');
                actualizarDashboard();
            } catch (error) {
                console.error('Error actualizando tarea:', error);
                mostrarNotificacion('Error al actualizar tarea', 'error');
            }
        }

        async function actualizarTareaEnDB(id, datos) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction(['tareas'], 'readwrite');
                const store = transaction.objectStore('tareas');
                const request = store.get(parseInt(id));
                
                request.onsuccess = () => {
                    const tarea = request.result;
                    const tareaActualizada = { ...tarea, ...datos, fechaActualizacion: new Date().toISOString() };
                    
                    const updateRequest = store.put(tareaActualizada);
                    updateRequest.onsuccess = () => resolve();
                    updateRequest.onerror = () => reject(updateRequest.error);
                };
                
                request.onerror = () => reject(request.error);
            });
        }

        async function eliminarTarea(id) {
            if (!await mostrarConfirmacion('¿Está seguro de eliminar esta tarea?')) {
                return;
            }
            
            const tarea = document.querySelector(`[data-id="${id}"]`);
            tarea.style.transition = 'all 0.3s';
            tarea.style.opacity = '0';
            tarea.style.height = '0';
            tarea.style.padding = '0';
            tarea.style.margin = '0';
            
            try {
                await eliminarTareaDeDB(id);
                
                setTimeout(() => {
                    tarea.remove();
                    mostrarNotificacion('Tarea eliminada correctamente', 'success');
                    actualizarDashboard();
                }, 300);
            } catch (error) {
                console.error('Error eliminando tarea:', error);
                tarea.style.opacity = '1';
                tarea.style.height = '';
                tarea.style.padding = '';
                tarea.style.margin = '';
                mostrarNotificacion('Error al eliminar tarea', 'error');
            }
        }

        async function eliminarTareaDeDB(id) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction(['tareas'], 'readwrite');
                const store = transaction.objectStore('tareas');
                const request = store.delete(parseInt(id));
                
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        // ===== INFORMES EXPANDIBLES =====
        function toggleDetalle(informeId) {
            const detalle = document.getElementById(`detalle-${informeId}`);
            const botones = document.querySelectorAll(`[onclick="toggleDetalle('${informeId}')"]`);
            
            if (detalle.classList.contains('expandido')) {
                detalle.classList.remove('expandido');
                botones.forEach(boton => {
                    boton.innerHTML = '<i class="fas fa-chevron-down"></i> Ver más detalles';
                });
            } else {
                detalle.classList.add('expandido');
                botones.forEach(boton => {
                    boton.innerHTML = '<i class="fas fa-chevron-up"></i> Ocultar detalles';
                });
            }
        }

        function expandirInforme(informeId) {
            const detalle = document.getElementById(`detalle-${informeId}`);
            if (!detalle.classList.contains('expandido')) {
                detalle.classList.add('expandido');
            }
        }

        // ===== SISTEMA DE RESPALDO =====
        class SistemaRespaldo {
            constructor() {
                this.maxRespaldos = 10;
                this.iniciarRespaldoAutomatico();
            }
            
            async crearRespaldo() {
                mostrarProgreso(true, 'Creando respaldo...');
                
                try {
                    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
                    const datos = await this.obtenerTodosDatos();
                    
                    const respaldo = {
                        id: `respaldo-${timestamp}`,
                        fecha: new Date().toISOString(),
                        datos: datos,
                        metadata: {
                            version: '1.0',
                            usuario: currentUser.nombre,
                            totalRegistros: Object.values(datos).reduce((acc, arr) => acc + arr.length, 0)
                        }
                    };
                    
                    await this.guardarRespaldo(respaldo);
                    await this.limitarRespaldos();
                    
                    mostrarProgreso(false);
                    mostrarNotificacion('Respaldo creado exitosamente', 'success');
                    actualizarEstadoSistema();
                    
                    // Generar archivo descargable
                    this.generarArchivoRespaldo(respaldo);
                    
                    return respaldo;
                } catch (error) {
                    mostrarProgreso(false);
                    console.error('Error creando respaldo:', error);
                    mostrarNotificacion('Error al crear respaldo', 'error');
                    throw error;
                }
            }
            
            async obtenerTodosDatos() {
                const stores = ['bitacoras', 'tareas', 'archivos', 'eventos', 'configuracion'];
                const datos = {};
                
                for (const storeName of stores) {
                    datos[storeName] = await this.obtenerDatosStore(storeName);
                }
                
                return datos;
            }
            
            async obtenerDatosStore(storeName) {
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction([storeName], 'readonly');
                    const store = transaction.objectStore(storeName);
                    const request = store.getAll();
                    
                    request.onsuccess = () => resolve(request.result);
                    request.onerror = () => reject(request.error);
                });
            }
            
            async guardarRespaldo(respaldo) {
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction(['respaldos'], 'readwrite');
                    const store = transaction.objectStore('respaldos');
                    const request = store.add(respaldo);
                    
                    request.onsuccess = () => resolve();
                    request.onerror = () => reject(request.error);
                });
            }
            
            async limitarRespaldos() {
                const respaldos = await this.obtenerDatosStore('respaldos');
                
                if (respaldos.length > this.maxRespaldos) {
                    const excedentes = respaldos.length - this.maxRespaldos;
                    const respaldosAEliminar = respaldos.slice(0, excedentes);
                    
                    for (const respaldo of respaldosAEliminar) {
                        await this.eliminarRespaldo(respaldo.id);
                    }
                }
            }
            
            async eliminarRespaldo(id) {
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction(['respaldos'], 'readwrite');
                    const store = transaction.objectStore('respaldos');
                    const request = store.delete(id);
                    
                    request.onsuccess = () => resolve();
                    request.onerror = () => reject(request.error);
                });
            }
            
            generarArchivoRespaldo(respaldo) {
                const datos = JSON.stringify(respaldo, null, 2);
                const blob = new Blob([datos], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `respaldo-drte-${new Date().toISOString().slice(0,10)}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
            
            async restaurarRespaldo(id) {
                if (!await mostrarConfirmacion('¿Restaurar este respaldo? Se perderán datos actuales.')) {
                    return;
                }
                
                mostrarProgreso(true, 'Restaurando respaldo...');
                
                try {
                    const respaldo = await this.obtenerRespaldo(id);
                    if (!respaldo) throw new Error('Respaldo no encontrado');
                    
                    // Limpiar datos actuales
                    await this.limpiarBaseDatos();
                    
                    // Cargar datos del respaldo
                    await this.cargarRespaldo(respaldo.datos);
                    
                    mostrarProgreso(false);
                    mostrarNotificacion('Sistema restaurado correctamente', 'success');
                    
                    // Recargar la página
                    setTimeout(() => {
                        location.reload();
                    }, 1500);
                    
                } catch (error) {
                    mostrarProgreso(false);
                    console.error('Error restaurando respaldo:', error);
                    mostrarNotificacion('Error al restaurar respaldo', 'error');
                }
            }
            
            async obtenerRespaldo(id) {
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction(['respaldos'], 'readonly');
                    const store = transaction.objectStore('respaldos');
                    const request = store.get(id);
                    
                    request.onsuccess = () => resolve(request.result);
                    request.onerror = () => reject(request.error);
                });
            }
            
            async limpiarBaseDatos() {
                const stores = ['bitacoras', 'tareas', 'archivos', 'eventos'];
                
                for (const storeName of stores) {
                    await this.limpiarStore(storeName);
                }
            }
            
            async limpiarStore(storeName) {
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction([storeName], 'readwrite');
                    const store = transaction.objectStore(storeName);
                    const request = store.clear();
                    
                    request.onsuccess = () => resolve();
                    request.onerror = () => reject(request.error);
                });
            }
            
            async cargarRespaldo(datos) {
                for (const [storeName, items] of Object.entries(datos)) {
                    await this.cargarDatosStore(storeName, items);
                }
            }
            
            async cargarDatosStore(storeName, items) {
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction([storeName], 'readwrite');
                    const store = transaction.objectStore(storeName);
                    
                    items.forEach(item => {
                        store.add(item);
                    });
                    
                    transaction.oncomplete = () => resolve();
                    transaction.onerror = () => reject(transaction.error);
                });
            }
            
            iniciarRespaldoAutomatico() {
                if (configuracion.respaldoAutomatico && configuracion.intervaloRespaldo) {
                    setInterval(async () => {
                        await this.crearRespaldo();
                    }, configuracion.intervaloRespaldo);
                    
                    console.log('Respaldo automático configurado');
                }
            }
        }

        // ===== UTILIDADES =====
        function mostrarNotificacion(mensaje, tipo = 'info', duracion = 5000) {
            const toastContainer = document.querySelector('.toast-container');
            const toast = document.createElement('div');
            toast.className = `toast toast-${tipo}`;
            
            const iconos = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle'
            };
            
            toast.innerHTML = `
                <div class="toast-icon">
                    <i class="${iconos[tipo]}"></i>
                </div>
                <div class="toast-content">
                    <p>${mensaje}</p>
                </div>
                <button class="toast-close">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            toastContainer.appendChild(toast);
            
            // Auto-eliminar
            setTimeout(() => {
                toast.remove();
            }, duracion);
            
            // Cerrar manualmente
            toast.querySelector('.toast-close').addEventListener('click', () => {
                toast.remove();
            });
        }

        async function mostrarConfirmacion(mensaje) {
            return new Promise((resolve) => {
                const modal = document.getElementById('confirmModal');
                const mensajeElemento = document.getElementById('confirmMessage');
                const btnCancelar = document.getElementById('confirmCancel');
                const btnConfirmar = document.getElementById('confirmOk');
                
                mensajeElemento.textContent = mensaje;
                modal.classList.add('active');
                
                const cerrarModal = (confirmado) => {
                    modal.classList.remove('active');
                    resolve(confirmado);
                };
                
                btnCancelar.onclick = () => cerrarModal(false);
                btnConfirmar.onclick = () => cerrarModal(true);
                
                // Cerrar al hacer clic fuera del modal
                modal.onclick = (e) => {
                    if (e.target === modal) cerrarModal(false);
                };
            });
        }

        function mostrarProgreso(mostrar, texto = '') {
            const progress = document.getElementById('globalProgress');
            const progressText = document.querySelector('.progress-text');
            
            if (mostrar) {
                progress.classList.add('active');
                progressText.textContent = texto || '0%';
            } else {
                progress.classList.remove('active');
            }
        }

        function actualizarProgreso(porcentaje, texto = '') {
            const progressFill = document.querySelector('.progress-fill');
            const progressText = document.querySelector('.progress-text');
            
            progressFill.style.width = `${porcentaje}%`;
            progressText.textContent = texto || `${porcentaje}%`;
        }

        function configurarAtajosTeclado() {
            document.addEventListener('keydown', (e) => {
                // Ctrl + S: Guardar
                if (e.ctrlKey && e.key === 's') {
                    e.preventDefault();
                    guardarTodo();
                }
                
                // Ctrl + F: Buscar
                if (e.ctrlKey && e.key === 'f') {
                    e.preventDefault();
                    document.getElementById('globalSearch').focus();
                }
                
                // Ctrl + N: Nueva tarea
                if (e.ctrlKey && e.key === 'n') {
                    e.preventDefault();
                    showSection('tareas');
                    document.getElementById('tituloTarea').focus();
                }
                
                // Ctrl + B: Nueva bitácora
                if (e.ctrlKey && e.key === 'b') {
                    e.preventDefault();
                    showSection('bitacora');
                }
                
                // Esc: Cerrar modales
                if (e.key === 'Escape') {
                    cerrarModales();
                }
            });
        }

        function guardarTodo() {
            // Guardar configuraciones pendientes
            guardarConfiguracion();
            mostrarNotificacion('Cambios guardados', 'success');
        }

        function cerrarModales() {
            document.querySelectorAll('.modal.active').forEach(modal => {
                modal.classList.remove('active');
            });
        }

        // ===== CARGA DE DATOS =====
        async function cargarDatosIniciales() {
            try {
                // Cargar tareas
                tareas = await obtenerTodasLasTareas();
                
                // Cargar bitácoras
                bitacoras = await obtenerTodasLasBitacoras();
                
                // Cargar archivos
                archivosSubidos = await obtenerTodosLosArchivos();
                
                // Cargar eventos
                eventos = await obtenerTodosLosEventos();
                
                actualizarDashboard();
                actualizarEstadoSistema();
            } catch (error) {
                console.error('Error cargando datos iniciales:', error);
            }
        }

        // ===== DASHBOARD =====
        async function actualizarDashboard() {
            // Actualizar estadísticas
            const tareasPendientes = tareas.filter(t => t.estado === 'pendiente').length;
            const actividadesHoy = eventos.filter(e => 
                new Date(e.fecha).toDateString() === new Date().toDateString()
            ).length;
            const documentosSubidos = archivosSubidos.length;
            const productividad = tareas.length > 0 ? 
                Math.round((tareas.filter(t => t.estado === 'completado').length / tareas.length) * 100) : 0;
            
            document.getElementById('tareasPendientes').textContent = tareasPendientes;
            document.getElementById('actividadesHoy').textContent = actividadesHoy;
            document.getElementById('documentosSubidos').textContent = documentosSubidos;
            document.getElementById('productividad').textContent = `${productividad}%`;
            
            // Actualizar actividad reciente
            actualizarActividadReciente();
            
            // Actualizar próximas actividades
            actualizarProximasActividades();
        }

        function actualizarActividadReciente() {
            const contenedor = document.getElementById('actividadReciente');
            const actividades = [...bitacoras, ...tareas.map(t => ({
                fecha: t.fechaCreacion,
                descripcion: t.titulo,
                tipo: 'tarea'
            }))].sort((a, b) => new Date(b.fecha) - new Date(a.fecha)).slice(0, 5);
            
            contenedor.innerHTML = actividades.map(act => `
                <div class="activity-item">
                    <div class="activity-icon">
                        <i class="fas fa-${act.tipo === 'tarea' ? 'tasks' : 'book'}"></i>
                    </div>
                    <div>
                        <p><strong>${act.descripcion}</strong></p>
                        <small>${new Date(act.fecha).toLocaleString()}</small>
                    </div>
                </div>
            `).join('');
        }

        function actualizarProximasActividades() {
            const contenedor = document.getElementById('proximasActividades');
            const actividadesProximas = eventos
                .filter(e => new Date(e.fecha) > new Date())
                .sort((a, b) => new Date(a.fecha) - new Date(b.fecha))
                .slice(0, 5);
            
            if (actividadesProximas.length === 0) {
                contenedor.innerHTML = '<p class="empty-state">No hay actividades próximas</p>';
                return;
            }
            
            contenedor.innerHTML = actividadesProximas.map(evento => `
                <div class="activity-item">
                    <div class="activity-icon">
                        <i class="fas fa-calendar"></i>
                    </div>
                    <div>
                        <p><strong>${evento.titulo}</strong></p>
                        <small>${new Date(evento.fecha).toLocaleString()}</small>
                        <p class="estado-${evento.prioridad || 'media'}">${evento.prioridad || 'Normal'}</p>
                    </div>
                </div>
            `).join('');
        }

        // ===== CONFIGURACIÓN =====
        function cargarConfiguracion() {
            const configGuardada = localStorage.getItem('configuracionDRTE');
            if (configGuardada) {
                configuracion = { ...configuracion, ...JSON.parse(configGuardada) };
                aplicarConfiguracion();
            }
        }

        function guardarConfiguracion() {
            // Guardar configuración del usuario
            currentUser.nombre = document.getElementById('nombreUsuario').value || 'Asesor DRTE';
            currentUser.correo = document.getElementById('correoUsuario').value || '';
            currentUser.rol = document.getElementById('rolUsuario').value || 'asesor';
            
            // Guardar otras configuraciones
            configuracion.tema = document.body.dataset.theme || 'light';
            configuracion.intervaloRespaldo = parseInt(document.getElementById('intervaloRespaldo').value) || 300000;
            configuracion.notificaciones = document.getElementById('notificaciones').checked;
            configuracion.modoOffline = document.getElementById('modoOffline').checked;
            configuracion.formatoExportacion = document.getElementById('formatoExportacion').value || 'pdf';
            
            localStorage.setItem('configuracionDRTE', JSON.stringify(configuracion));
            localStorage.setItem('usuarioDRTE', JSON.stringify(currentUser));
            
            mostrarNotificacion('Configuración guardada correctamente', 'success');
        }

        function aplicarConfiguracion() {
            // Aplicar tema
            aplicarTema();
            
            // Aplicar configuración de usuario
            if (currentUser.nombre) {
                document.getElementById('currentUser').textContent = currentUser.nombre;
                document.getElementById('nombreUsuario').value = currentUser.nombre;
                document.getElementById('correoUsuario').value = currentUser.correo || '';
                document.getElementById('rolUsuario').value = currentUser.rol || 'asesor';
            }
            
            // Aplicar otras configuraciones
            document.getElementById('intervaloRespaldo').value = configuracion.intervaloRespaldo || 300000;
            document.getElementById('notificaciones').checked = configuracion.notificaciones !== false;
            document.getElementById('modoOffline').checked = configuracion.modoOffline !== false;
            document.getElementById('formatoExportacion').value = configuracion.formatoExportacion || 'pdf';
            document.getElementById('incluirLogo').checked = true;
        }

        // ===== TEMA =====
        function aplicarTema() {
            const tema = configuracion.tema || 'light';
            document.body.dataset.theme = tema;
            
            const iconoTema = document.querySelector('#themeToggle i');
            iconoTema.className = tema === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
        }

        function alternarTema() {
            const temaActual = document.body.dataset.theme;
            const nuevoTema = temaActual === 'dark' ? 'light' : 'dark';
            
            document.body.dataset.theme = nuevoTema;
            configuracion.tema = nuevoTema;
            
            const iconoTema = document.querySelector('#themeToggle i');
            iconoTema.className = nuevoTema === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            
            guardarConfiguracion();
        }

        // ===== NAVEGACIÓN =====
        function showSection(sectionId) {
            // Ocultar todas las secciones
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remover activo de todos los enlaces
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Mostrar sección seleccionada
            document.getElementById(sectionId).classList.add('active');
            
            // Activar enlace correspondiente
            document.querySelector(`[href="#${sectionId}"]`).classList.add('active');
            
            // Actualizar título si es necesario
            actualizarTituloSeccion(sectionId);
            
            // Si es dashboard, actualizar datos
            if (sectionId === 'dashboard') {
                actualizarDashboard();
            }
        }

        function actualizarTituloSeccion(sectionId) {
            const titulos = {
                'dashboard': 'Dashboard',
                'bitacora': 'Bitácora Diaria',
                'tareas': 'Gestión de Tareas',
                'calendario': 'Calendario',
                'archivos': 'Sistema de Archivos',
                'informes': 'Informes Institucionales',
                'enlaces': 'Enlaces MEP',
                'config': 'Sistema y Configuración'
            };
            
            const titulo = titulos[sectionId] || 'Sistema DRTE MEP';
            document.title = `${titulo} - Sistema DRTE MEP`;
        }

        // ===== FUNCIONES DE BASE DE DATOS =====
        async function obtenerTodasLasTareas() {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction(['tareas'], 'readonly');
                const store = transaction.objectStore('tareas');
                const request = store.getAll();
                
                request.onsuccess = () => resolve(request.result || []);
                request.onerror = () => reject(request.error);
            });
        }

        async function obtenerTodasLasBitacoras() {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction(['bitacoras'], 'readonly');
                const store = transaction.objectStore('bitacoras');
                const request = store.getAll();
                
                request.onsuccess = () => resolve(request.result || []);
                request.onerror = () => reject(request.error);
            });
        }

        async function obtenerTodosLosArchivos() {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction(['archivos'], 'readonly');
                const store = transaction.objectStore('archivos');
                const request = store.getAll();
                
                request.onsuccess = () => resolve(request.result || []);
                request.onerror = () => reject(request.error);
            });
        }

        async function obtenerTodosLosEventos() {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction(['eventos'], 'readonly');
                const store = transaction.objectStore('eventos');
                const request = store.getAll();
                
                request.onsuccess = () => resolve(request.result || []);
                request.onerror = () => reject(request.error);
            });
        }

        // ===== EVENTOS =====
        function configurarEventos() {
            // Navegación
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = link.getAttribute('href').substring(1);
                    showSection(sectionId);
                });
            });
            
            // Tema
            document.getElementById('themeToggle').addEventListener('click', alternarTema);
            
            // Menú de usuario
            document.getElementById('userMenuBtn').addEventListener('click', (e) => {
                e.stopPropagation();
                const menu = document.querySelector('.dropdown-menu');
                menu.classList.toggle('active');
            });
            
            // Cerrar menú al hacer clic fuera
            document.addEventListener('click', () => {
                document.querySelectorAll('.dropdown-menu.active').forEach(menu => {
                    menu.classList.remove('active');
                });
            });
            
            // Respaldo
            document.getElementById('crearRespaldo').addEventListener('click', async () => {
                const sistemaRespaldo = new SistemaRespaldo();
                await sistemaRespaldo.crearRespaldo();
            });
            
            // Guardar configuración
            document.getElementById('guardarConfig').addEventListener('click', guardarConfiguracion);
            
            // Quick add button
            document.getElementById('quickAddBtn').addEventListener('click', () => {
                showSection('tareas');
                document.getElementById('tituloTarea').focus();
            });
            
            // Back to top
            const backToTopBtn = document.querySelector('.back-to-top');
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('visible');
                } else {
                    backToTopBtn.classList.remove('visible');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
            
            // Drag and drop de archivos
            const fileDropArea = document.getElementById('fileDropArea');
            if (fileDropArea) {
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    fileDropArea.addEventListener(eventName, preventDefaults, false);
                });
                
                function preventDefaults(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
                
                ['dragenter', 'dragover'].forEach(eventName => {
                    fileDropArea.addEventListener(eventName, highlight, false);
                });
                
                ['dragleave', 'drop'].forEach(eventName => {
                    fileDropArea.addEventListener(eventName, unhighlight, false);
                });
                
                function highlight() {
                    fileDropArea.classList.add('drag-over');
                }
                
                function unhighlight() {
                    fileDropArea.classList.remove('drag-over');
                }
                
                fileDropArea.addEventListener('drop', handleDrop, false);
                
                async function handleDrop(e) {
                    const dt = e.dataTransfer;
                    const files = dt.files;
                    await handleFiles(files);
                }
            }
            
            // Subida de archivos
            const archivosInput = document.getElementById('archivosBitacora');
            if (archivosInput) {
                archivosInput.addEventListener('change', async (e) => {
                    await handleFiles(e.target.files);
                });
            }
        }

        async function handleFiles(files) {
            const archivosProcesados = await subirArchivos(files);
            
            if (archivosProcesados.length > 0) {
                actualizarListaArchivos(archivosProcesados);
            }
        }

        function actualizarListaArchivos(archivos) {
            const lista = document.getElementById('listaArchivosBitacora');
            if (!lista) return;
            
            archivos.forEach(archivo => {
                const item = document.createElement('div');
                item.className = 'archivo-item';
                item.innerHTML = `
                    <div class="archivo-info">
                        <div class="archivo-icon">
                            <i class="${archivo.preview}"></i>
                        </div>
                        <div class="archivo-details">
                            <h4>${archivo.nombre}</h4>
                            <div class="archivo-meta">
                                ${formatBytes(archivo.tamaño)} • ${new Date(archivo.fecha).toLocaleDateString()}
                            </div>
                        </div>
                    </div>
                    <div class="archivo-actions">
                        <button class="btn-icon" onclick="descargarArchivo('${archivo.id}')">
                            <i class="fas fa-download"></i>
                        </button>
                        <button class="btn-icon btn-danger" onclick="eliminarArchivo('${archivo.id}', this)">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                lista.appendChild(item);
            });
        }

        function formatBytes(bytes, decimals = 2) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const dm = decimals < 0 ? 0 : decimals;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
        }

        // ===== ESTADO DEL SISTEMA =====
        function actualizarEstadoSistema() {
            // Estado de la base de datos
            document.getElementById('estadoDB').textContent = db ? 'Activa' : 'Inactiva';
            
            // Uso de almacenamiento
            if ('storage' in navigator && 'estimate' in navigator.storage) {
                navigator.storage.estimate().then(estimate => {
                    const porcentaje = estimate.quota ? (estimate.usage / estimate.quota * 100).toFixed(1) : 0;
                    document.getElementById('usoAlmacenamiento').textContent = `${porcentaje}%`;
                });
            }
            
            // Uso de memoria
            if (performance.memory) {
                const memory = performance.memory;
                const usedMB = Math.round(memory.usedJSHeapSize / 1024 / 1024);
                document.getElementById('usoMemoria').textContent = `${usedMB} MB`;
            }
            
            // Último respaldo
            const ultimoRespaldo = localStorage.getItem('ultimoRespaldo');
            if (ultimoRespaldo) {
                document.getElementById('ultimoRespaldo').textContent = 
                    new Date(ultimoRespaldo).toLocaleString();
            }
        }

        function actualizarEstadisticasArchivos() {
            // Esta función se llamará después de subir/eliminar archivos
            const totalArchivos = archivosSubidos.length;
            const totalPDF = archivosSubidos.filter(a => a.extension === 'pdf').length;
            const totalWord = archivosSubidos.filter(a => ['doc', 'docx'].includes(a.extension)).length;
            
            // Calcular espacio total usado
            const espacioUsado = archivosSubidos.reduce((total, archivo) => total + archivo.tamaño, 0);
            
            document.getElementById('totalArchivos').textContent = totalArchivos;
            document.getElementById('espacioUsado').textContent = formatBytes(espacioUsado);
            document.getElementById('totalPDF').textContent = totalPDF;
            document.getElementById('totalWord').textContent = totalWord;
        }

        // ===== VERIFICACIÓN DE RECORDATORIOS =====
        function verificarRecordatorios() {
            // Verificar cada hora
            setInterval(() => {
                const tareasPendientes = tareas.filter(t => 
                    t.estado === 'pendiente' && 
                    t.fechaVencimiento && 
                    new Date(t.fechaVencimiento) <= new Date()
                );
                
                if (tareasPendientes.length > 0 && configuracion.notificaciones) {
                    mostrarNotificacion(
                        `Tiene ${tareasPendientes.length} tarea(s) vencida(s)`,
                        'warning'
                    );
                }
            }, 3600000); // Cada hora
        }

        // ===== MOSTRAR/OCULTAR LOADING =====
        function mostrarLoading(mostrar) {
            const loadingOverlay = document.getElementById('loadingOverlay');
            if (mostrar) {
                loadingOverlay.style.display = 'flex';
            } else {
                setTimeout(() => {
                    loadingOverlay.style.display = 'none';
                }, 500);
            }
        }

        // ===== EXPORTACIÓN =====
        async function exportarInforme(tipo) {
            mostrarProgreso(true, 'Generando informe...');
            
            try {
                let contenido = '';
                
                switch(tipo) {
                    case 'mensual':
                        contenido = await generarInformeMensual();
                        break;
                    case 'tareas':
                        contenido = await generarInformeTareas();
                        break;
                    case 'archivos':
                        contenido = await generarInformeArchivos();
                        break;
                    default:
                        contenido = 'Informe no disponible';
                }
                
                const formato = document.getElementById('formatoExportacion').value;
                
                switch(formato) {
                    case 'pdf':
                        await exportarAPDF(contenido, tipo);
                        break;
                    case 'excel':
                        await exportarAExcel(contenido, tipo);
                        break;
                    case 'word':
                        await exportarAWord(contenido, tipo);
                        break;
                }
                
                mostrarProgreso(false);
                mostrarNotificacion('Informe exportado correctamente', 'success');
            } catch (error) {
                mostrarProgreso(false);
                console.error('Error exportando informe:', error);
                mostrarNotificacion('Error al exportar informe', 'error');
            }
        }

        async function exportarAPDF(contenido, tipo) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Encabezado
            doc.setFontSize(16);
            doc.setTextColor(0, 51, 102);
            doc.text('Ministerio de Educación Pública', 105, 20, null, null, 'center');
            doc.text('Dirección Regional de Educación', 105, 28, null, null, 'center');
            
            doc.setFontSize(14);
            doc.text(`INFORME ${tipo.toUpperCase()}`, 105, 40, null, null, 'center');
            
            // Fecha
            doc.setFontSize(10);
            doc.text(`Generado: ${new Date().toLocaleString()}`, 10, 50);
            
            // Contenido
            doc.setFontSize(11);
            const lineas = doc.splitTextToSize(contenido, 180);
            doc.text(lineas, 10, 70);
            
            // Pie de página
            doc.setFontSize(8);
            doc.text('Sistema Integral de Gestión DRTE', 105, 285, null, null, 'center');
            
            doc.save(`Informe_${tipo}_${Date.now()}.pdf`);
        }

        // ===== INICIALIZACIÓN FINAL =====
        // Asegurar que todas las funciones estén disponibles globalmente
        window.subirArchivos = subirArchivos;
        window.eliminarArchivo = eliminarArchivo;
        window.habilitarEdicionTarea = habilitarEdicionTarea;
        window.guardarEdicionTarea = guardarEdicionTarea;
        window.eliminarTarea = eliminarTarea;
        window.toggleDetalle = toggleDetalle;
        window.expandirInforme = expandirInforme;
        window.showSection = showSection;
        window.exportarInforme = exportarInforme;
        window.formatBytes = formatBytes;
        window.descargarArchivo = async function(id) {
            // Implementar descarga de archivo
            mostrarNotificacion('Descarga iniciada', 'info');
        };

        // ===== CALENDARIO FUNCIONAL =====
        let calendario;
        
        class CalendarioDRTE {
            constructor() {
                this.fechaActual = new Date();
                this.vistaActual = 'mes';
                this.eventos = [];
            }
        
            async inicializar() {
                await this.cargarEventos();
                this.renderizarCalendario();
                this.configurarEventos();
                console.log('Calendario inicializado');
            }
        
            async cargarEventos() {
                try {
                    this.eventos = await obtenerTodosLosEventos();
                } catch (error) {
                    console.error('Error cargando eventos:', error);
                    this.eventos = [];
                }
            }
        
            renderizarCalendario() {
                const grid = document.getElementById('calendarioGrid');
                const mesActual = document.getElementById('mesActual');
                
                if (!grid || !mesActual) return;
                
                // Actualizar título del mes
                const opciones = { year: 'numeric', month: 'long' };
                mesActual.textContent = this.fechaActual.toLocaleDateString('es-ES', opciones);
                
                // Limpiar grid
                grid.innerHTML = '';
                
                // Días de la semana
                const diasSemana = ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'];
                diasSemana.forEach(dia => {
                    const diaElement = document.createElement('div');
                    diaElement.className = 'calendario-dia nombre-dia';
                    diaElement.textContent = dia;
                    grid.appendChild(diaElement);
                });
                
                // Obtener primer y último día del mes
                const primerDia = new Date(this.fechaActual.getFullYear(), this.fechaActual.getMonth(), 1);
                const ultimoDia = new Date(this.fechaActual.getFullYear(), this.fechaActual.getMonth() + 1, 0);
                
                // Días del mes anterior
                const diaSemanaPrimerDia = primerDia.getDay();
                for (let i = 0; i < diaSemanaPrimerDia; i++) {
                    const fecha = new Date(primerDia);
                    fecha.setDate(fecha.getDate() - (diaSemanaPrimerDia - i));
                    this.crearDiaCalendario(grid, fecha, true);
                }
                
                // Días del mes actual
                for (let dia = 1; dia <= ultimoDia.getDate(); dia++) {
                    const fecha = new Date(this.fechaActual.getFullYear(), this.fechaActual.getMonth(), dia);
                    this.crearDiaCalendario(grid, fecha, false);
                }
                
                // Días del mes siguiente
                const celdasUsadas = diaSemanaPrimerDia + ultimoDia.getDate();
                const celdasRestantes = 42 - celdasUsadas; // 6 semanas
                
                for (let i = 1; i <= celdasRestantes; i++) {
                    const fecha = new Date(ultimoDia);
                    fecha.setDate(fecha.getDate() + i);
                    this.crearDiaCalendario(grid, fecha, true);
                }
                
                // Actualizar lista de eventos
                this.actualizarListaEventos();
            }
        
            crearDiaCalendario(contenedor, fecha, esOtroMes) {
                const diaElement = document.createElement('div');
                diaElement.className = 'calendario-dia';
                
                if (esOtroMes) {
                    diaElement.classList.add('otro-mes');
                }
                
                // Marcar hoy
                const hoy = new Date();
                if (fecha.toDateString() === hoy.toDateString()) {
                    diaElement.classList.add('hoy');
                }
                
                // Número del día
                const numeroElement = document.createElement('div');
                numeroElement.className = 'calendario-dia-numero';
                numeroElement.textContent = fecha.getDate();
                diaElement.appendChild(numeroElement);
                
                // Eventos del día
                const eventosDia = this.obtenerEventosDia(fecha);
                if (eventosDia.length > 0) {
                    const eventosContainer = document.createElement('div');
                    eventosContainer.className = 'calendario-eventos';
                    
                    eventosDia.slice(0, 2).forEach(evento => {
                        const eventoElement = document.createElement('div');
                        eventoElement.className = `calendario-evento evento-${evento.prioridad || 'normal'}`;
                        eventoElement.title = evento.titulo;
                        eventoElement.innerHTML = `<i class="fas fa-circle"></i> ${evento.titulo.substring(0, 10)}${evento.titulo.length > 10 ? '...' : ''}`;
                        eventosContainer.appendChild(eventoElement);
                    });
                    
                    if (eventosDia.length > 2) {
                        const masElement = document.createElement('div');
                        masElement.className = 'calendario-mas-eventos';
                        masElement.textContent = `+${eventosDia.length - 2} más`;
                        eventosContainer.appendChild(masElement);
                    }
                    
                    diaElement.appendChild(eventosContainer);
                }
                
                // Click en día
                diaElement.addEventListener('click', () => {
                    this.mostrarEventosDia(fecha, eventosDia);
                });
                
                contenedor.appendChild(diaElement);
            }
        
            obtenerEventosDia(fecha) {
                return this.eventos.filter(evento => {
                    const fechaEvento = new Date(evento.fecha);
                    return fechaEvento.toDateString() === fecha.toDateString();
                });
            }
        
            mostrarEventosDia(fecha, eventos) {
                let mensaje = `<strong>${fecha.toLocaleDateString('es-ES', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                })}</strong><br><br>`;
                
                if (eventos.length === 0) {
                    mensaje += '<p>No hay eventos programados para este día.</p>';
                    if (confirm('¿Desea agregar un evento para este día?')) {
                        this.agregarEvento(fecha);
                    }
                } else {
                    eventos.forEach(evento => {
                        const hora = evento.hora ? ` (${evento.hora})` : '';
                        mensaje += `• <strong>${evento.titulo}</strong>${hora}<br>`;
                        if (evento.descripcion) {
                            mensaje += `  <small>${evento.descripcion}</small><br>`;
                        }
                        mensaje += '<br>';
                    });
                }
                
                this.mostrarModal('Eventos del día', mensaje);
            }
        
            mostrarModal(titulo, mensaje) {
                const modal = document.getElementById('infoModal');
                const tituloElement = modal.querySelector('h3');
                const mensajeElement = document.getElementById('infoMessage');
                
                tituloElement.innerHTML = `<i class="fas fa-calendar-day"></i> ${titulo}`;
                mensajeElement.innerHTML = mensaje;
                modal.classList.add('active');
            }
        
            async agregarEvento(fecha) {
                const titulo = prompt('Título del evento:');
                if (!titulo) return;
                
                const descripcion = prompt('Descripción (opcional):');
                const hora = prompt('Hora (opcional, formato HH:MM):');
                const prioridad = prompt('Prioridad (alta/media/baja, opcional):') || 'media';
                
                const nuevoEvento = {
                    titulo: titulo,
                    descripcion: descripcion || '',
                    fecha: fecha.toISOString(),
                    hora: hora || '',
                    prioridad: prioridad,
                    fechaCreacion: new Date().toISOString()
                };
                
                try {
                    await this.guardarEvento(nuevoEvento);
                    this.eventos.push(nuevoEvento);
                    this.renderizarCalendario();
                    mostrarNotificacion('Evento agregado correctamente', 'success');
                } catch (error) {
                    console.error('Error guardando evento:', error);
                    mostrarNotificacion('Error al guardar evento', 'error');
                }
            }
        
            async guardarEvento(evento) {
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction(['eventos'], 'readwrite');
                    const store = transaction.objectStore('eventos');
                    const request = store.add(evento);
                    
                    request.onsuccess = () => resolve();
                    request.onerror = () => reject(request.error);
                });
            }
        
            actualizarListaEventos() {
                const contenedor = document.getElementById('listaEventos');
                if (!contenedor) return;
                
                // Eventos del mes actual
                const primerDiaMes = new Date(this.fechaActual.getFullYear(), this.fechaActual.getMonth(), 1);
                const ultimoDiaMes = new Date(this.fechaActual.getFullYear(), this.fechaActual.getMonth() + 1, 0);
                
                const eventosMes = this.eventos.filter(evento => {
                    const fechaEvento = new Date(evento.fecha);
                    return fechaEvento >= primerDiaMes && fechaEvento <= ultimoDiaMes;
                }).sort((a, b) => new Date(a.fecha) - new Date(b.fecha));
                
                if (eventosMes.length === 0) {
                    contenedor.innerHTML = '<p class="empty-state"><i class="fas fa-calendar"></i> No hay eventos este mes</p>';
                    return;
                }
                
                let html = '';
                eventosMes.forEach(evento => {
                    const fecha = new Date(evento.fecha);
                    const fechaFormateada = fecha.toLocaleDateString('es-ES', {
                        weekday: 'short',
                        day: 'numeric',
                        month: 'short'
                    });
                    
                    html += `
                        <div class="activity-item">
                            <div class="activity-icon evento-${evento.prioridad || 'normal'}">
                                <i class="fas fa-calendar-day"></i>
                            </div>
                            <div>
                                <p><strong>${evento.titulo}</strong></p>
                                <small>${fechaFormateada} ${evento.hora ? '• ' + evento.hora : ''}</small>
                                ${evento.descripcion ? `<p class="text-small">${evento.descripcion}</p>` : ''}
                            </div>
                        </div>
                    `;
                });
                
                contenedor.innerHTML = html;
            }
        
            cambiarMes(direccion) {
                this.fechaActual.setMonth(this.fechaActual.getMonth() + direccion);
                this.renderizarCalendario();
            }
        
            irHoy() {
                this.fechaActual = new Date();
                this.renderizarCalendario();
            }
        
            cambiarVista(vista) {
                this.vistaActual = vista;
                // Por ahora solo implementamos vista mensual
                mostrarNotificacion(`Vista ${vista} en desarrollo`, 'info');
            }
        
            configurarEventos() {
                // Navegación de meses
                document.getElementById('mesAnterior')?.addEventListener('click', () => this.cambiarMes(-1));
                document.getElementById('mesSiguiente')?.addEventListener('click', () => this.cambiarMes(1));
                document.getElementById('hoy')?.addEventListener('click', () => this.irHoy());
                
                // Botones de vista
                document.getElementById('vistaDia')?.addEventListener('click', (e) => {
                    e.target.classList.add('active');
                    document.getElementById('vistaSemana')?.classList.remove('active');
                    document.getElementById('vistaMes')?.classList.remove('active');
                    this.cambiarVista('dia');
                });
                
                document.getElementById('vistaSemana')?.addEventListener('click', (e) => {
                    e.target.classList.add('active');
                    document.getElementById('vistaDia')?.classList.remove('active');
                    document.getElementById('vistaMes')?.classList.remove('active');
                    this.cambiarVista('semana');
                });
                
                document.getElementById('vistaMes')?.addEventListener('click', (e) => {
                    e.target.classList.add('active');
                    document.getElementById('vistaDia')?.classList.remove('active');
                    document.getElementById('vistaSemana')?.classList.remove('active');
                    this.cambiarVista('mes');
                });
                
                // Botón nuevo evento
                document.getElementById('nuevoEvento')?.addEventListener('click', () => {
                    this.agregarEvento(new Date());
                });
            }
        }
        
        // ===== SISTEMA DE TEMAS MEJORADO =====
        function cambiarTema(tema) {
            document.body.dataset.theme = tema;
            configuracion.tema = tema;
            
            const iconoTema = document.querySelector('#themeToggle i');
            const iconos = {
                'light': 'fas fa-sun',
                'dark': 'fas fa-moon',
                'high-contrast': 'fas fa-eye'
            };
            iconoTema.className = iconos[tema] || 'fas fa-moon';
            
            // Guardar configuración
            localStorage.setItem('configuracionDRTE', JSON.stringify(configuracion));
            
            // Mostrar notificación
            const nombresTema = {
                'light': 'Claro',
                'dark': 'Oscuro',
                'high-contrast': 'Alto Contraste'
            };
            mostrarNotificacion(`Tema cambiado a: ${nombresTema[tema]}`, 'info');
        }
        
        // Alternar tema cíclicamente
        function alternarTema() {
            const temas = ['light', 'dark', 'high-contrast'];
            const temaActual = document.body.dataset.theme || 'light';
            const indiceActual = temas.indexOf(temaActual);
            const siguienteTema = temas[(indiceActual + 1) % temas.length];
            
            cambiarTema(siguienteTema);
        }
        
        // Función para aplicar tema al cargar
        function aplicarTema() {
            const tema = configuracion.tema || 'light';
            document.body.dataset.theme = tema;
            
            const iconoTema = document.querySelector('#themeToggle i');
            const iconos = {
                'light': 'fas fa-sun',
                'dark': 'fas fa-moon',
                'high-contrast': 'fas fa-eye'
            };
            iconoTema.className = iconos[tema] || 'fas fa-moon';
        }
        
        // Hacer calendario disponible globalmente
        window.calendario = calendario;
        
        // ===== INICIALIZACIÓN MEJORADA =====
        async function inicializarSistema() {
            try {
                await inicializarBaseDatos();
                cargarConfiguracion();
                aplicarTema();
                configurarAtajosTeclado();
                iniciarRespaldoAutomatico();
                verificarRecordatorios();
                
                // Inicializar calendario
                calendario = new CalendarioDRTE();
                await calendario.inicializar();
                
                // Configurar eventos de tema
                document.querySelectorAll('.theme-option').forEach(boton => {
                    boton.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const tema = boton.dataset.theme;
                        cambiarTema(tema);
                    });
                });
                
                // Cerrar menú de temas al hacer clic fuera
                document.addEventListener('click', () => {
                    document.querySelector('.theme-menu').style.display = 'none';
                });
                
                mostrarNotificacion('Sistema inicializado correctamente', 'success');
            } catch (error) {
                console.error('Error inicializando sistema:', error);
                mostrarNotificacion('Error al inicializar el sistema', 'error');
            }
        }

        console.log('Sistema DRTE MEP - Versión 1.0.0');
        console.log('Todos los sistemas inicializados correctamente');
        console.log('Sistema listo para producción');
    </script>
</body>
</html>
