<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Integral DRTE MEP - Gestión de Evidencias y Agenda</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACjSURBVHgB7dKxDYAwDETRG4CCEVggJqBgBBagYAMkpOllc05kI+7hVvT9l5QADeABHMAN2FipFZC4AB1QsgA2uAEfD2YzAZgqQDGAqgC+J0BX3IEyYQXIM5gLqAbQ/x5CMJMyg/0OpoOYNQFZ9xVgkAHkNWkZAThHgOgTQQeQ3hAzAVQAVAVQHoBvB5QBiJnAPgNRBEhPwJ+APQFyE4gz+BeAj7uY2wAAAABJRU5ErkJggg==">
    <style>
        /* ESTILOS ANTERIORES MANTENIDOS... */
        /* (Mantengo todos los estilos CSS anteriores que ya tienes) */
        /* Solo agregaré los estilos esenciales para las nuevas funcionalidades */
        
        /* ===== CALENDARIO FUNCIONAL ===== */
        .calendario-funcional {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .calendario-header-func {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .calendario-grid-func {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            background: #f0f0f0;
            border: 1px solid #f0f0f0;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .calendario-dia-func {
            background: white;
            padding: 10px;
            min-height: 100px;
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .calendario-dia-func:hover {
            background: #f8f9fa;
            transform: translateY(-2px);
            z-index: 1;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .calendario-dia-func.dia-actual {
            background: #e3f2fd;
            border: 2px solid #2196f3;
        }
        
        .calendario-dia-func.otro-mes {
            background: #f8f9fa;
            color: #adb5bd;
        }
        
        .calendario-dia-header {
            font-weight: bold;
            background: #2196f3;
            color: white;
            text-align: center;
            padding: 10px;
            font-size: 0.9rem;
        }
        
        .numero-dia {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }
        
        .evento-calendario {
            font-size: 0.75rem;
            padding: 3px 5px;
            margin: 2px 0;
            border-radius: 3px;
            background: #e3f2fd;
            border-left: 3px solid #2196f3;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .evento-alta {
            background: #ffebee;
            border-left-color: #f44336;
        }
        
        .evento-media {
            background: #fff3e0;
            border-left-color: #ff9800;
        }
        
        .evento-baja {
            background: #e8f5e8;
            border-left-color: #4caf50;
        }
        
        /* ===== PANEL DE ENLACES SIMILAR A SYMBALOO ===== */
        .symbaloo-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .enlace-boton {
            background: white;
            border-radius: 10px;
            padding: 20px 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: all 0.3s;
            cursor: pointer;
            text-decoration: none;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .enlace-boton:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            background: #2196f3;
            color: white;
        }
        
        .enlace-boton:hover .icono-enlace {
            transform: scale(1.2);
            color: white;
        }
        
        .icono-enlace {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #2196f3;
            transition: all 0.3s;
        }
        
        .nombre-enlace {
            font-size: 0.85rem;
            font-weight: 500;
            line-height: 1.2;
        }
        
        /* ===== ASISTENTE VIRTUAL ===== */
        .asistente-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .asistente-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #2196f3;
            color: white;
            border: none;
            box-shadow: 0 4px 15px rgba(33,150,243,0.4);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.3s;
        }
        
        .asistente-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(33,150,243,0.6);
        }
        
        .asistente-chat {
            position: absolute;
            bottom: 70px;
            right: 0;
            width: 300px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.2);
            display: none;
        }
        
        .asistente-chat.activo {
            display: block;
        }
        
        .chat-header {
            background: #2196f3;
            color: white;
            padding: 15px;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chat-mensajes {
            height: 300px;
            overflow-y: auto;
            padding: 15px;
        }
        
        .chat-input {
            padding: 15px;
            border-top: 1px solid #eee;
        }
        
        /* ===== SECCIÓN INFORMES COMPACTA ===== */
        .informes-compactos {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .informe-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .informe-item:last-child {
            border-bottom: none;
        }
        
        .informe-acciones {
            display: flex;
            gap: 10px;
        }
        
        /* ===== GENERADOR DE INFORMES ===== */
        .generador-informes {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .campo-informe {
            margin-bottom: 20px;
        }
        
        .campo-informe label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }
        
        .campo-informe textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            resize: vertical;
            min-height: 100px;
        }
        
        /* ===== DASHBOARD FUNCIONAL ===== */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        
        .stat-info h3 {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-info p {
            font-size: 1.8rem;
            font-weight: bold;
            color: #333;
        }
        
        /* ===== MEJORAS PARA BOTONES ===== */
        .btn-guardar {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-guardar:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76,175,80,0.3);
        }
        
        .btn-nuevo {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-nuevo:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33,150,243,0.3);
        }
        
        /* ===== MODAL PARA AGREGAR ENLACES ===== */
        .modal-enlace {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }
        
        .modal-enlace.activo {
            display: flex;
        }
        
        .modal-contenido {
            background: white;
            border-radius: 10px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 30px rgba(0,0,0,0.2);
        }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .symbaloo-container {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
                gap: 10px;
            }
            
            .calendario-grid-func {
                grid-template-columns: repeat(7, 1fr);
            }
            
            .calendario-dia-func {
                min-height: 80px;
                padding: 5px;
            }
            
            .dashboard-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .asistente-chat {
                width: 280px;
                right: -50px;
            }
        }
        
        @media (max-width: 480px) {
            .dashboard-stats {
                grid-template-columns: 1fr;
            }
            
            .symbaloo-container {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .asistente-chat {
                width: 250px;
                right: -80px;
            }
        }
    </style>
</head>
<body data-theme="light">
    <!-- Asistente Virtual -->
    <div class="asistente-container">
        <div class="asistente-chat" id="asistenteChat">
            <div class="chat-header">
                <div>
                    <h4 style="margin: 0;"><i class="fas fa-robot"></i> Asistente DRTE</h4>
                    <small>¿En qué puedo ayudarte?</small>
                </div>
                <button onclick="cerrarAsistente()" style="background: none; border: none; color: white; cursor: pointer;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="chat-mensajes" id="chatMensajes">
                <div class="mensaje asistente">
                    <p>¡Hola! Soy tu asistente virtual. ¿En qué puedo ayudarte hoy?</p>
                    <small>Puedo ayudarte con:</small>
                    <ul style="margin: 5px 0; padding-left: 20px;">
                        <li>Recordatorios de tareas</li>
                        <li>Informes pendientes</li>
                        <li>Calendario MEP</li>
                        <li>Configuración del sistema</li>
                    </ul>
                </div>
            </div>
            <div class="chat-input">
                <input type="text" id="inputChat" placeholder="Escribe tu pregunta..." 
                       style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                <button onclick="enviarMensaje()" style="margin-top: 10px; padding: 10px 20px; background: #2196f3; color: white; border: none; border-radius: 5px; cursor: pointer;">
                    Enviar
                </button>
            </div>
        </div>
        <button class="asistente-btn" onclick="mostrarAsistente()">
            <i class="fas fa-robot"></i>
        </button>
    </div>

    <!-- Modal para agregar enlaces -->
    <div class="modal-enlace" id="modalEnlace">
        <div class="modal-contenido">
            <h3><i class="fas fa-plus"></i> Agregar Nuevo Enlace</h3>
            <div class="campo-informe">
                <label>Nombre del enlace:</label>
                <input type="text" id="nombreEnlace" class="form-control" placeholder="Ej: SharePoint DRTE">
            </div>
            <div class="campo-informe">
                <label>URL:</label>
                <input type="url" id="urlEnlace" class="form-control" placeholder="https://ejemplo.com">
            </div>
            <div class="campo-informe">
                <label>Icono (código FontAwesome):</label>
                <input type="text" id="iconoEnlace" class="form-control" placeholder="fas fa-link">
                <small>Ej: fas fa-envelope, fas fa-file-excel, etc.</small>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button onclick="agregarEnlace()" class="btn-guardar">
                    <i class="fas fa-save"></i> Guardar
                </button>
                <button onclick="cerrarModalEnlace()" class="btn-secondary">
                    <i class="fas fa-times"></i> Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Header (mantener el existente) -->
    <header class="sticky-header">
        <!-- Mantener header original -->
    </header>

    <!-- Contenido Principal Mejorado -->
    <main>
        <!-- Sección Dashboard Funcional -->
        <section id="dashboard" class="content-section active">
            <div class="section-header">
                <h2><i class="fas fa-tachometer-alt"></i> Dashboard de Actividades</h2>
                <div class="section-controls">
                    <button id="refreshDashboard" class="btn-nuevo">
                        <i class="fas fa-sync-alt"></i> Actualizar
                    </button>
                </div>
            </div>
            
            <div class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-icon" style="background: #4CAF50;">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <div class="stat-info">
                        <h3>Tareas Pendientes</h3>
                        <p id="tareasPendientesCount">0</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: #2196F3;">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="stat-info">
                        <h3>Eventos Hoy</h3>
                        <p id="eventosHoyCount">0</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: #FF9800;">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <div class="stat-info">
                        <h3>Bitácoras</h3>
                        <p id="bitacorasCount">0</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: #9C27B0;">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-info">
                        <h3>Productividad</h3>
                        <p id="productividadPorcentaje">0%</p>
                    </div>
                </div>
            </div>
            
            <!-- Recordatorios del Asistente -->
            <div class="informes-compactos">
                <h3><i class="fas fa-bell"></i> Recordatorios y Alertas</h3>
                <div id="recordatoriosLista">
                    <!-- Se llenará dinámicamente -->
                </div>
            </div>
        </section>

        <!-- Sección Bitácora con Guardar Funcional -->
        <section id="bitacora" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-book"></i> Bitácora Diaria</h2>
                <div class="section-controls">
                    <button onclick="nuevaBitacora()" class="btn-nuevo">
                        <i class="fas fa-plus"></i> Nueva
                    </button>
                </div>
            </div>
            
            <div class="generador-informes">
                <div class="campo-informe">
                    <label><i class="fas fa-calendar"></i> Fecha</label>
                    <input type="date" id="fechaBitacoraInput" class="form-control" value="<?php echo date('Y-m-d'); ?>">
                </div>
                
                <div class="campo-informe">
                    <label><i class="fas fa-tasks"></i> Actividades Realizadas</label>
                    <textarea id="actividadesBitacora" class="form-control" 
                              placeholder="Describa las actividades realizadas durante el día..."></textarea>
                </div>
                
                <div class="campo-informe">
                    <label><i class="fas fa-sticky-note"></i> Observaciones</label>
                    <textarea id="observacionesBitacora" class="form-control" 
                              placeholder="Observaciones importantes, dificultades, logros..."></textarea>
                </div>
                
                <div class="campo-informe">
                    <label><i class="fas fa-paperclip"></i> Archivos Adjuntos</label>
                    <div style="border: 2px dashed #ddd; padding: 20px; text-align: center; border-radius: 5px; cursor: pointer;"
                         onclick="document.getElementById('archivosBitacoraInput').click()">
                        <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: #666;"></i>
                        <p>Arrastra archivos o haz clic para seleccionar</p>
                        <input type="file" id="archivosBitacoraInput" multiple style="display: none;">
                    </div>
                    <div id="listaArchivosBitacora"></div>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button onclick="guardarBitacora()" class="btn-guardar">
                        <i class="fas fa-save"></i> Guardar Bitácora
                    </button>
                    <button onclick="limpiarBitacora()" class="btn-secondary">
                        <i class="fas fa-trash"></i> Limpiar
                    </button>
                </div>
            </div>
            
            <!-- Historial de Bitácoras -->
            <div class="informes-compactos">
                <h3><i class="fas fa-history"></i> Historial de Bitácoras</h3>
                <div id="historialBitacoras">
                    <!-- Se llenará dinámicamente -->
                </div>
            </div>
        </section>

        <!-- Sección Tareas con Guardar Funcional -->
        <section id="tareas" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-tasks"></i> Gestión de Tareas</h2>
                <div class="section-controls">
                    <button onclick="nuevaTarea()" class="btn-nuevo">
                        <i class="fas fa-plus"></i> Nueva Tarea
                    </button>
                </div>
            </div>
            
            <div class="generador-informes">
                <div class="campo-informe">
                    <label><i class="fas fa-heading"></i> Título de la Tarea</label>
                    <input type="text" id="tituloTareaInput" class="form-control" placeholder="Ej: Revisión de informes mensuales">
                </div>
                
                <div class="campo-informe">
                    <label><i class="fas fa-align-left"></i> Descripción</label>
                    <textarea id="descripcionTareaInput" class="form-control" 
                              placeholder="Descripción detallada de la tarea..."></textarea>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="campo-informe">
                        <label><i class="fas fa-exclamation-circle"></i> Prioridad</label>
                        <select id="prioridadTareaInput" class="form-control">
                            <option value="alta">Alta</option>
                            <option value="media" selected>Media</option>
                            <option value="baja">Baja</option>
                        </select>
                    </div>
                    
                    <div class="campo-informe">
                        <label><i class="fas fa-calendar-times"></i> Fecha Límite</label>
                        <input type="date" id="fechaLimiteTareaInput" class="form-control">
                    </div>
                </div>
                
                <div class="campo-informe">
                    <label><i class="fas fa-tag"></i> Categoría</label>
                    <select id="categoriaTareaInput" class="form-control">
                        <option value="teletrabajo">Teletrabajo</option>
                        <option value="oficina">Oficina</option>
                        <option value="reunion">Reunión</option>
                        <option value="informe">Informe</option>
                        <option value="capacitacion">Capacitación</option>
                    </select>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button onclick="guardarTarea()" class="btn-guardar">
                        <i class="fas fa-save"></i> Guardar Tarea
                    </button>
                    <button onclick="cancelarTarea()" class="btn-secondary">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                </div>
            </div>
            
            <!-- Lista de Tareas -->
            <div class="informes-compactos">
                <h3><i class="fas fa-list"></i> Lista de Tareas</h3>
                <div style="margin-bottom: 15px;">
                    <select id="filtroTareas" onchange="filtrarTareas()" class="form-control">
                        <option value="todas">Todas las tareas</option>
                        <option value="pendientes">Pendientes</option>
                        <option value="completadas">Completadas</option>
                        <option value="hoy">Para hoy</option>
                    </select>
                </div>
                <div id="listaTareasContainer">
                    <!-- Se llenará dinámicamente -->
                </div>
            </div>
        </section>

        <!-- Sección Calendario Funcional -->
        <section id="calendario" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-calendar-alt"></i> Calendario MEP</h2>
                <div class="section-controls">
                    <button onclick="agregarEventoCalendario()" class="btn-nuevo">
                        <i class="fas fa-plus"></i> Nuevo Evento
                    </button>
                </div>
            </div>
            
            <!-- Calendario Interactivo -->
            <div class="calendario-funcional">
                <div class="calendario-header-func">
                    <div>
                        <button onclick="cambiarMes(-1)" class="btn-secondary" style="margin-right: 10px;">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <h3 id="mesActualCalendario" style="display: inline-block; margin: 0;"></h3>
                        <button onclick="cambiarMes(1)" class="btn-secondary" style="margin-left: 10px;">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <button onclick="irHoy()" class="btn-nuevo">
                        <i class="fas fa-calendar-day"></i> Hoy
                    </button>
                </div>
                
                <div class="calendario-grid-func" id="calendarioGrid">
                    <!-- Se generará dinámicamente -->
                </div>
            </div>
            
            <!-- Eventos del Mes -->
            <div class="informes-compactos">
                <h3><i class="fas fa-calendar-day"></i> Eventos del Mes</h3>
                <div id="listaEventosCalendario">
                    <!-- Se llenará dinámicamente -->
                </div>
            </div>
        </section>

        <!-- Sección Informes Compacta -->
        <section id="informes" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-chart-bar"></i> Sistema de Informes</h2>
                <div class="section-controls">
                    <button onclick="generarNuevoInforme()" class="btn-nuevo">
                        <i class="fas fa-plus"></i> Nuevo Informe
                    </button>
                </div>
            </div>
            
            <!-- Generador de Informes -->
            <div class="generador-informes">
                <div class="campo-informe">
                    <label><i class="fas fa-file-alt"></i> Tipo de Informe</label>
                    <select id="tipoInformeInput" class="form-control" onchange="cambiarFormularioInforme()">
                        <option value="semanal">Informe Semanal</option>
                        <option value="mensual">Informe Mensual</option>
                        <option value="trimestral">Informe Trimestral</option>
                        <option value="anual">Informe Anual</option>
                    </select>
                </div>
                
                <div class="campo-informe">
                    <label><i class="fas fa-calendar"></i> Período</label>
                    <input type="month" id="periodoInformeInput" class="form-control">
                </div>
                
                <div class="campo-informe" id="camposSemanal">
                    <label><i class="fas fa-tasks"></i> Actividades por día</label>
                    <textarea id="actividadesSemanalInput" class="form-control" 
                              placeholder="Describa las actividades realizadas cada día de la semana..."></textarea>
                </div>
                
                <div class="campo-informe" id="camposMensual" style="display: none;">
                    <label><i class="fas fa-chart-pie"></i> Metas alcanzadas</label>
                    <textarea id="metasMensualInput" class="form-control" 
                              placeholder="Describa las metas alcanzadas durante el mes..."></textarea>
                </div>
                
                <div class="campo-informe">
                    <label><i class="fas fa-bullseye"></i> Objetivos para el próximo período</label>
                    <textarea id="objetivosInformeInput" class="form-control" 
                              placeholder="Establezca los objetivos para el próximo período..."></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button onclick="generarInforme()" class="btn-guardar">
                        <i class="fas fa-file-export"></i> Generar Informe
                    </button>
                    <button onclick="exportarInforme()" class="btn-secondary">
                        <i class="fas fa-download"></i> Exportar
                    </button>
                </div>
            </div>
            
            <!-- Historial de Informes -->
            <div class="informes-compactos">
                <h3><i class="fas fa-history"></i> Informes Anteriores</h3>
                <div id="historialInformes">
                    <!-- Se llenará dinámicamente -->
                </div>
            </div>
        </section>

        <!-- Sección Enlaces estilo Symbaloo -->
        <section id="enlaces" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-link"></i> Enlaces Rápidos</h2>
                <div class="section-controls">
                    <button onclick="abrirModalEnlace()" class="btn-nuevo">
                        <i class="fas fa-plus"></i> Agregar Enlace
                    </button>
                </div>
            </div>
            
            <!-- Panel estilo Symbaloo -->
            <div class="symbaloo-container" id="symbalooGrid">
                <!-- Enlaces se agregarán aquí dinámicamente -->
            </div>
            
            <!-- Enlaces Institucionales MEP -->
            <div class="informes-compactos">
                <h3><i class="fas fa-university"></i> Enlaces Institucionales MEP</h3>
                <div class="symbaloo-container">
                    <a href="https://pnft.mep.go.cr/asesoriapnft/app/home" target="_blank" class="enlace-boton">
                        <i class="fas fa-chalkboard-teacher icono-enlace"></i>
                        <span class="nombre-enlace">Plataforma PNFT</span>
                    </a>
                    
                    <a href="https://adminmepcr.sharepoint.com" target="_blank" class="enlace-boton">
                        <i class="fas fa-share-alt icono-enlace"></i>
                        <span class="nombre-enlace">SharePoint</span>
                    </a>
                    
                    <a href="https://outlook.office.com" target="_blank" class="enlace-boton">
                        <i class="fas fa-envelope icono-enlace"></i>
                        <span class="nombre-enlace">Correo MEP</span>
                    </a>
                    
                    <a href="https://teams.microsoft.com" target="_blank" class="enlace-boton">
                        <i class="fas fa-users icono-enlace"></i>
                        <span class="nombre-enlace">Teams</span>
                    </a>
                    
                    <a href="https://onedrive.live.com" target="_blank" class="enlace-boton">
                        <i class="fas fa-cloud icono-enlace"></i>
                        <span class="nombre-enlace">OneDrive</span>
                    </a>
                    
                    <a href="#" onclick="abrirModalEnlace()" class="enlace-boton">
                        <i class="fas fa-plus icono-enlace"></i>
                        <span class="nombre-enlace">Agregar</span>
                    </a>
                </div>
            </div>
        </section>
    </main>

    <script>
        // ===== VARIABLES GLOBALES =====
        let tareas = [];
        let bitacoras = [];
        let eventos = [];
        let enlacesPersonalizados = [];
        let fechaCalendario = new Date();
        let asistenteActivo = false;

        // ===== INICIALIZACIÓN =====
        document.addEventListener('DOMContentLoaded', function() {
            cargarDatos();
            inicializarCalendario();
            inicializarAsistente();
            actualizarDashboard();
            cargarEnlacesPersonalizados();
            configurarEventos();
            
            // Mostrar sección activa
            showSection('dashboard');
        });

        // ===== FUNCIONES DE NAVEGACIÓN =====
        function showSection(sectionId) {
            // Ocultar todas las secciones
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remover activo de todos los enlaces
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Mostrar sección seleccionada
            document.getElementById(sectionId).classList.add('active');
            
            // Activar enlace correspondiente
            document.querySelector(`[href="#${sectionId}"]`).classList.add('active');
            
            // Actualizar contenido específico
            switch(sectionId) {
                case 'calendario':
                    actualizarCalendario();
                    break;
                case 'tareas':
                    cargarTareas();
                    break;
                case 'bitacora':
                    cargarBitacoras();
                    break;
                case 'enlaces':
                    actualizarEnlaces();
                    break;
            }
        }

        // ===== CONFIGURACIÓN DE EVENTOS =====
        function configurarEventos() {
            // Navegación
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = link.getAttribute('href').substring(1);
                    showSection(sectionId);
                });
            });
            
            // Botón guardar bitácora
            document.getElementById('guardarBitacora')?.addEventListener('click', guardarBitacora);
            
            // Botón guardar tarea
            document.getElementById('guardarTarea')?.addEventListener('click', guardarTarea);
            
            // Tecla Enter en chat
            document.getElementById('inputChat')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') enviarMensaje();
            });
        }

        // ===== SISTEMA DE BITÁCORA =====
        function guardarBitacora() {
            const fecha = document.getElementById('fechaBitacoraInput').value;
            const actividades = document.getElementById('actividadesBitacora').value;
            const observaciones = document.getElementById('observacionesBitacora').value;
            
            if (!fecha || !actividades) {
                alert('Por favor complete la fecha y actividades');
                return;
            }
            
            const nuevaBitacora = {
                id: Date.now(),
                fecha: fecha,
                actividades: actividades,
                observaciones: observaciones,
                archivos: [],
                fechaCreacion: new Date().toISOString()
            };
            
            // Obtener archivos si existen
            const archivosInput = document.getElementById('archivosBitacoraInput');
            if (archivosInput.files.length > 0) {
                // En un sistema real, aquí se subirían los archivos
                nuevaBitacora.archivos = Array.from(archivosInput.files).map(f => f.name);
            }
            
            bitacoras.push(nuevaBitacora);
            guardarEnStorage('bitacoras', bitacoras);
            
            mostrarMensaje('Bitácora guardada exitosamente', 'success');
            limpiarBitacora();
            cargarBitacoras();
            actualizarDashboard();
        }

        function limpiarBitacora() {
            document.getElementById('fechaBitacoraInput').value = '';
            document.getElementById('actividadesBitacora').value = '';
            document.getElementById('observacionesBitacora').value = '';
            document.getElementById('archivosBitacoraInput').value = '';
            document.getElementById('listaArchivosBitacora').innerHTML = '';
        }

        function cargarBitacoras() {
            const contenedor = document.getElementById('historialBitacoras');
            if (!contenedor) return;
            
            if (bitacoras.length === 0) {
                contenedor.innerHTML = '<p style="text-align: center; color: #666;">No hay bitácoras registradas</p>';
                return;
            }
            
            let html = '';
            bitacoras.slice().reverse().forEach(bitacora => {
                html += `
                    <div class="informe-item">
                        <div>
                            <strong>${formatearFecha(bitacora.fecha)}</strong>
                            <p style="margin: 5px 0; color: #666;">${bitacora.actividades.substring(0, 100)}...</p>
                        </div>
                        <div class="informe-acciones">
                            <button onclick="verBitacora(${bitacora.id})" class="btn-secondary" style="padding: 5px 10px;">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                `;
            });
            
            contenedor.innerHTML = html;
        }

        function verBitacora(id) {
            const bitacora = bitacoras.find(b => b.id === id);
            if (!bitacora) return;
            
            alert(`Bitácora del ${formatearFecha(bitacora.fecha)}\n\nActividades:\n${bitacora.actividades}\n\nObservaciones:\n${bitacora.observaciones}`);
        }

        // ===== SISTEMA DE TAREAS =====
        function guardarTarea() {
            const titulo = document.getElementById('tituloTareaInput').value;
            const descripcion = document.getElementById('descripcionTareaInput').value;
            const prioridad = document.getElementById('prioridadTareaInput').value;
            const fechaLimite = document.getElementById('fechaLimiteTareaInput').value;
            const categoria = document.getElementById('categoriaTareaInput').value;
            
            if (!titulo || !fechaLimite) {
                alert('Por favor complete el título y fecha límite');
                return;
            }
            
            const nuevaTarea = {
                id: Date.now(),
                titulo: titulo,
                descripcion: descripcion,
                prioridad: prioridad,
                fechaLimite: fechaLimite,
                categoria: categoria,
                completada: false,
                fechaCreacion: new Date().toISOString()
            };
            
            tareas.push(nuevaTarea);
            guardarEnStorage('tareas', tareas);
            
            mostrarMensaje('Tarea guardada exitosamente', 'success');
            cancelarTarea();
            cargarTareas();
            actualizarDashboard();
            
            // Notificar al asistente
            agregarRecordatorio(`Nueva tarea: ${titulo}`, 'info');
        }

        function cancelarTarea() {
            document.getElementById('tituloTareaInput').value = '';
            document.getElementById('descripcionTareaInput').value = '';
            document.getElementById('prioridadTareaInput').value = 'media';
            document.getElementById('fechaLimiteTareaInput').value = '';
            document.getElementById('categoriaTareaInput').value = 'teletrabajo';
        }

        function cargarTareas() {
            const contenedor = document.getElementById('listaTareasContainer');
            if (!contenedor) return;
            
            if (tareas.length === 0) {
                contenedor.innerHTML = '<p style="text-align: center; color: #666;">No hay tareas registradas</p>';
                return;
            }
            
            let html = '';
            const filtro = document.getElementById('filtroTareas')?.value || 'todas';
            const hoy = new Date().toISOString().split('T')[0];
            
            const tareasFiltradas = tareas.filter(t => {
                if (filtro === 'pendientes') return !t.completada;
                if (filtro === 'completadas') return t.completada;
                if (filtro === 'hoy') return t.fechaLimite === hoy;
                return true;
            });
            
            tareasFiltradas.forEach(tarea => {
                const prioridadClass = `evento-${tarea.prioridad}`;
                const fechaFormateada = formatearFecha(tarea.fechaLimite);
                const hoy = new Date();
                const fechaLimite = new Date(tarea.fechaLimite);
                const diasRestantes = Math.ceil((fechaLimite - hoy) / (1000 * 60 * 60 * 24));
                
                let alerta = '';
                if (diasRestantes === 0) alerta = '<span style="color: #f44336;">¡Vence hoy!</span>';
                else if (diasRestantes < 0) alerta = `<span style="color: #f44336;">Vencida hace ${Math.abs(diasRestantes)} días</span>`;
                else if (diasRestantes <= 3) alerta = `<span style="color: #ff9800;">Vence en ${diasRestantes} días</span>`;
                
                html += `
                    <div class="informe-item ${tarea.completada ? 'completada' : ''}">
                        <div style="flex-grow: 1;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                                <span class="${prioridadClass}" style="padding: 2px 8px; border-radius: 3px; font-size: 0.8rem;">
                                    ${tarea.prioridad.toUpperCase()}
                                </span>
                                <strong>${tarea.titulo}</strong>
                            </div>
                            <p style="margin: 5px 0; color: #666; font-size: 0.9rem;">${tarea.descripcion || 'Sin descripción'}</p>
                            <div style="display: flex; gap: 15px; font-size: 0.85rem; color: #888;">
                                <span><i class="far fa-calendar"></i> ${fechaFormateada}</span>
                                <span><i class="fas fa-tag"></i> ${tarea.categoria}</span>
                                ${alerta ? `<span>${alerta}</span>` : ''}
                            </div>
                        </div>
                        <div class="informe-acciones">
                            <button onclick="alternarTarea(${tarea.id})" class="${tarea.completada ? 'btn-secondary' : 'btn-guardar'}" style="padding: 5px 15px;">
                                <i class="fas ${tarea.completada ? 'fa-undo' : 'fa-check'}"></i>
                                ${tarea.completada ? 'Reabrir' : 'Completar'}
                            </button>
                            <button onclick="eliminarTarea(${tarea.id})" class="btn-secondary" style="padding: 5px 10px;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            });
            
            contenedor.innerHTML = html;
        }

        function alternarTarea(id) {
            const tarea = tareas.find(t => t.id === id);
            if (tarea) {
                tarea.completada = !tarea.completada;
                guardarEnStorage('tareas', tareas);
                cargarTareas();
                actualizarDashboard();
                
                if (tarea.completada) {
                    mostrarMensaje('¡Tarea completada!', 'success');
                    agregarRecordatorio(`Tarea completada: ${tarea.titulo}`, 'success');
                }
            }
        }

        function eliminarTarea(id) {
            if (confirm('¿Está seguro de eliminar esta tarea?')) {
                tareas = tareas.filter(t => t.id !== id);
                guardarEnStorage('tareas', tareas);
                cargarTareas();
                actualizarDashboard();
                mostrarMensaje('Tarea eliminada', 'info');
            }
        }

        function filtrarTareas() {
            cargarTareas();
        }

        // ===== CALENDARIO FUNCIONAL =====
        function inicializarCalendario() {
            eventos = obtenerDeStorage('eventos') || [];
            fechaCalendario = new Date();
            actualizarCalendario();
        }

        function actualizarCalendario() {
            const meses = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 
                          'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            
            // Actualizar título
            document.getElementById('mesActualCalendario').textContent = 
                `${meses[fechaCalendario.getMonth()]} ${fechaCalendario.getFullYear()}`;
            
            // Generar calendario
            const primerDia = new Date(fechaCalendario.getFullYear(), fechaCalendario.getMonth(), 1);
            const ultimoDia = new Date(fechaCalendario.getFullYear(), fechaCalendario.getMonth() + 1, 0);
            const primerDiaSemana = primerDia.getDay();
            const totalDias = ultimoDia.getDate();
            
            const grid = document.getElementById('calendarioGrid');
            grid.innerHTML = '';
            
            // Días de la semana
            const diasSemana = ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'];
            diasSemana.forEach(dia => {
                const celda = document.createElement('div');
                celda.className = 'calendario-dia-header';
                celda.textContent = dia;
                grid.appendChild(celda);
            });
            
            // Días vacíos al inicio
            for (let i = 0; i < primerDiaSemana; i++) {
                const celda = document.createElement('div');
                celda.className = 'calendario-dia-func otro-mes';
                celda.textContent = '';
                grid.appendChild(celda);
            }
            
            // Días del mes
            const hoy = new Date();
            const hoyString = hoy.toDateString();
            
            for (let dia = 1; dia <= totalDias; dia++) {
                const celda = document.createElement('div');
                const fecha = new Date(fechaCalendario.getFullYear(), fechaCalendario.getMonth(), dia);
                const fechaString = fecha.toDateString();
                
                celda.className = 'calendario-dia-func';
                if (fechaString === hoyString) {
                    celda.classList.add('dia-actual');
                }
                
                celda.innerHTML = `<div class="numero-dia">${dia}</div>`;
                
                // Agregar eventos del día
                const eventosDia = eventos.filter(e => {
                    const fechaEvento = new Date(e.fecha);
                    return fechaEvento.toDateString() === fechaString;
                });
                
                eventosDia.forEach(evento => {
                    const eventoElement = document.createElement('div');
                    eventoElement.className = `evento-calendario evento-${evento.prioridad || 'normal'}`;
                    eventoElement.textContent = evento.titulo;
                    eventoElement.title = `${evento.titulo}\n${evento.descripcion || ''}`;
                    celda.appendChild(eventoElement);
                });
                
                // Click para agregar evento
                celda.addEventListener('click', () => {
                    agregarEvento(fecha);
                });
                
                grid.appendChild(celda);
            }
            
            // Actualizar lista de eventos
            actualizarListaEventos();
        }

        function cambiarMes(direccion) {
            fechaCalendario.setMonth(fechaCalendario.getMonth() + direccion);
            actualizarCalendario();
        }

        function irHoy() {
            fechaCalendario = new Date();
            actualizarCalendario();
        }

        function agregarEvento(fecha) {
            const titulo = prompt('Título del evento:');
            if (!titulo) return;
            
            const descripcion = prompt('Descripción (opcional):');
            const prioridad = prompt('Prioridad (alta/media/baja):', 'media');
            
            const nuevoEvento = {
                id: Date.now(),
                titulo: titulo,
                descripcion: descripcion || '',
                fecha: fecha.toISOString(),
                prioridad: prioridad.toLowerCase(),
                fechaCreacion: new Date().toISOString()
            };
            
            eventos.push(nuevoEvento);
            guardarEnStorage('eventos', eventos);
            actualizarCalendario();
            
            mostrarMensaje('Evento agregado al calendario', 'success');
            agregarRecordatorio(`Nuevo evento: ${titulo}`, 'info');
        }

        function actualizarListaEventos() {
            const contenedor = document.getElementById('listaEventosCalendario');
            if (!contenedor) return;
            
            const eventosMes = eventos.filter(e => {
                const fechaEvento = new Date(e.fecha);
                return fechaEvento.getMonth() === fechaCalendario.getMonth() &&
                       fechaEvento.getFullYear() === fechaCalendario.getFullYear();
            }).sort((a, b) => new Date(a.fecha) - new Date(b.fecha));
            
            if (eventosMes.length === 0) {
                contenedor.innerHTML = '<p style="text-align: center; color: #666;">No hay eventos este mes</p>';
                return;
            }
            
            let html = '';
            eventosMes.forEach(evento => {
                const fecha = new Date(evento.fecha);
                const fechaFormateada = formatearFecha(evento.fecha);
                
                html += `
                    <div class="informe-item">
                        <div>
                            <strong>${evento.titulo}</strong>
                            <p style="margin: 5px 0; color: #666;">${fechaFormateada}</p>
                            ${evento.descripcion ? `<p style="font-size: 0.9rem;">${evento.descripcion}</p>` : ''}
                        </div>
                        <span class="evento-${evento.prioridad}" style="padding: 2px 8px; border-radius: 3px; font-size: 0.8rem;">
                            ${evento.prioridad.toUpperCase()}
                        </span>
                    </div>
                `;
            });
            
            contenedor.innerHTML = html;
        }

        // ===== SISTEMA DE INFORMES =====
        function cambiarFormularioInforme() {
            const tipo = document.getElementById('tipoInformeInput').value;
            document.getElementById('camposSemanal').style.display = tipo === 'semanal' ? 'block' : 'none';
            document.getElementById('camposMensual').style.display = tipo === 'mensual' ? 'block' : 'none';
        }

        function generarInforme() {
            const tipo = document.getElementById('tipoInformeInput').value;
            const periodo = document.getElementById('periodoInformeInput').value;
            const actividades = document.getElementById('actividadesSemanalInput').value;
            const metas = document.getElementById('metasMensualInput').value;
            const objetivos = document.getElementById('objetivosInformeInput').value;
            
            if (!periodo) {
                alert('Por favor seleccione un período');
                return;
            }
            
            const nuevoInforme = {
                id: Date.now(),
                tipo: tipo,
                periodo: periodo,
                actividades: actividades,
                metas: metas,
                objetivos: objetivos,
                fechaGeneracion: new Date().toISOString()
            };
            
            // Guardar en localStorage
            const informes = obtenerDeStorage('informes') || [];
            informes.push(nuevoInforme);
            guardarEnStorage('informes', informes);
            
            mostrarMensaje('Informe generado exitosamente', 'success');
            
            // Mostrar vista previa
            mostrarVistaPreviaInforme(nuevoInforme);
        }

        function exportarInforme() {
            // Aquí se implementaría la exportación a PDF/Excel
            mostrarMensaje('Funcionalidad de exportación en desarrollo', 'info');
        }

        // ===== SISTEMA DE ENLACES =====
        function abrirModalEnlace() {
            document.getElementById('modalEnlace').classList.add('activo');
        }

        function cerrarModalEnlace() {
            document.getElementById('modalEnlace').classList.remove('activo');
        }

        function agregarEnlace() {
            const nombre = document.getElementById('nombreEnlace').value;
            const url = document.getElementById('urlEnlace').value;
            const icono = document.getElementById('iconoEnlace').value || 'fas fa-link';
            
            if (!nombre || !url) {
                alert('Por favor complete nombre y URL');
                return;
            }
            
            const nuevoEnlace = {
                id: Date.now(),
                nombre: nombre,
                url: url,
                icono: icono,
                fechaCreacion: new Date().toISOString()
            };
            
            enlacesPersonalizados.push(nuevoEnlace);
            guardarEnStorage('enlacesPersonalizados', enlacesPersonalizados);
            
            mostrarMensaje('Enlace agregado exitosamente', 'success');
            cerrarModalEnlace();
            actualizarEnlaces();
        }

        function cargarEnlacesPersonalizados() {
            enlacesPersonalizados = obtenerDeStorage('enlacesPersonalizados') || [];
            actualizarEnlaces();
        }

        function actualizarEnlaces() {
            const grid = document.getElementById('symbalooGrid');
            if (!grid) return;
            
            let html = '';
            
            // Enlaces personalizados
            enlacesPersonalizados.forEach(enlace => {
                html += `
                    <a href="${enlace.url}" target="_blank" class="enlace-boton" title="${enlace.nombre}">
                        <i class="${enlace.icono} icono-enlace"></i>
                        <span class="nombre-enlace">${enlace.nombre}</span>
                    </a>
                `;
            });
            
            // Botón para agregar más
            html += `
                <a href="#" onclick="abrirModalEnlace()" class="enlace-boton">
                    <i class="fas fa-plus icono-enlace"></i>
                    <span class="nombre-enlace">Agregar</span>
                </a>
            `;
            
            grid.innerHTML = html;
        }

        // ===== ASISTENTE VIRTUAL =====
        function inicializarAsistente() {
            // Verificar recordatorios iniciales
            setTimeout(() => {
                verificarRecordatorios();
            }, 1000);
            
            // Verificar cada hora
            setInterval(verificarRecordatorios, 3600000);
        }

        function mostrarAsistente() {
            const chat = document.getElementById('asistenteChat');
            asistenteActivo = !asistenteActivo;
            
            if (asistenteActivo) {
                chat.classList.add('activo');
                document.getElementById('inputChat').focus();
            } else {
                chat.classList.remove('activo');
            }
        }

        function cerrarAsistente() {
            document.getElementById('asistenteChat').classList.remove('activo');
            asistenteActivo = false;
        }

        function enviarMensaje() {
            const input = document.getElementById('inputChat');
            const mensaje = input.value.trim();
            
            if (!mensaje) return;
            
            // Agregar mensaje del usuario
            agregarMensajeChat(mensaje, 'usuario');
            input.value = '';
            
            // Procesar mensaje
            procesarMensajeAsistente(mensaje);
        }

        function procesarMensajeAsistente(mensaje) {
            const mensajeLower = mensaje.toLowerCase();
            let respuesta = '';
            
            if (mensajeLower.includes('tarea') || mensajeLower.includes('pendiente')) {
                const tareasPendientes = tareas.filter(t => !t.completada).length;
                respuesta = `Tienes ${tareasPendientes} tareas pendientes. Puedes verlas en la sección de Tareas.`;
                
            } else if (mensajeLower.includes('calendario') || mensajeLower.includes('evento')) {
                const eventosHoy = eventos.filter(e => {
                    const fechaEvento = new Date(e.fecha);
                    const hoy = new Date();
                    return fechaEvento.toDateString() === hoy.toDateString();
                }).length;
                respuesta = `Hoy tienes ${eventosHoy} eventos en el calendario.`;
                
            } else if (mensajeLower.includes('informe') || mensajeLower.includes('reporte')) {
                respuesta = 'Puedes generar informes semanales, mensuales o anuales en la sección de Informes.';
                
            } else if (mensajeLower.includes('ayuda') || mensajeLower.includes('comandos')) {
                respuesta = 'Puedo ayudarte con:\n• Ver tareas pendientes\n• Consultar eventos del calendario\n• Recordatorios importantes\n• Generar informes\n¿En qué necesitas ayuda?';
                
            } else {
                respuesta = 'Entendido. Si necesitas ayuda específica, pregúntame sobre tareas, calendario o informes.';
            }
            
            // Respuesta con delay
            setTimeout(() => {
                agregarMensajeChat(respuesta, 'asistente');
            }, 1000);
        }

        function agregarMensajeChat(mensaje, tipo) {
            const contenedor = document.getElementById('chatMensajes');
            const mensajeElement = document.createElement('div');
            mensajeElement.className = `mensaje ${tipo}`;
            mensajeElement.innerHTML = `<p>${mensaje.replace(/\n/g, '<br>')}</p>`;
            contenedor.appendChild(mensajeElement);
            contenedor.scrollTop = contenedor.scrollHeight;
        }

        function verificarRecordatorios() {
            const hoy = new Date();
            const hoyString = hoy.toISOString().split('T')[0];
            
            // Tareas que vencen hoy
            const tareasHoy = tareas.filter(t => 
                !t.completada && t.fechaLimite === hoyString
            );
            
            if (tareasHoy.length > 0) {
                agregarRecordatorio(`Tienes ${tareasHoy.length} tarea(s) que vencen hoy`, 'warning');
            }
            
            // Eventos de hoy
            const eventosHoy = eventos.filter(e => {
                const fechaEvento = new Date(e.fecha);
                return fechaEvento.toDateString() === hoy.toDateString();
            });
            
            if (eventosHoy.length > 0) {
                agregarRecordatorio(`Tienes ${eventosHoy.length} evento(s) programado(s) para hoy`, 'info');
            }
        }

        function agregarRecordatorio(mensaje, tipo) {
            const contenedor = document.getElementById('recordatoriosLista');
            if (!contenedor) return;
            
            const recordatorio = document.createElement('div');
            recordatorio.className = 'informe-item';
            recordatorio.innerHTML = `
                <div>
                    <strong><i class="fas fa-bell" style="color: ${tipo === 'warning' ? '#ff9800' : '#2196f3'}"></i> Recordatorio</strong>
                    <p style="margin: 5px 0;">${mensaje}</p>
                </div>
                <button onclick="this.parentElement.remove()" style="background: none; border: none; cursor: pointer;">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            contenedor.prepend(recordatorio);
            
            // Notificación si el asistente está activo
            if (asistenteActivo) {
                agregarMensajeChat(mensaje, 'asistente');
            }
        }

        // ===== DASHBOARD =====
        function actualizarDashboard() {
            // Tareas pendientes
            const tareasPendientes = tareas.filter(t => !t.completada).length;
            document.getElementById('tareasPendientesCount').textContent = tareasPendientes;
            
            // Eventos hoy
            const hoy = new Date().toDateString();
            const eventosHoy = eventos.filter(e => new Date(e.fecha).toDateString() === hoy).length;
            document.getElementById('eventosHoyCount').textContent = eventosHoy;
            
            // Bitácoras
            document.getElementById('bitacorasCount').textContent = bitacoras.length;
            
            // Productividad
            const totalTareas = tareas.length;
            const tareasCompletadas = tareas.filter(t => t.completada).length;
            const productividad = totalTareas > 0 ? Math.round((tareasCompletadas / totalTareas) * 100) : 0;
            document.getElementById('productividadPorcentaje').textContent = `${productividad}%`;
        }

        // ===== UTILIDADES =====
        function cargarDatos() {
            tareas = obtenerDeStorage('tareas') || [];
            bitacoras = obtenerDeStorage('bitacoras') || [];
            eventos = obtenerDeStorage('eventos') || [];
            enlacesPersonalizados = obtenerDeStorage('enlacesPersonalizados') || [];
        }

        function guardarEnStorage(clave, datos) {
            localStorage.setItem(`drte_${clave}`, JSON.stringify(datos));
        }

        function obtenerDeStorage(clave) {
            const datos = localStorage.getItem(`drte_${clave}`);
            return datos ? JSON.parse(datos) : null;
        }

        function formatearFecha(fechaString) {
            const fecha = new Date(fechaString);
            return fecha.toLocaleDateString('es-ES', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        function mostrarMensaje(mensaje, tipo) {
            const tipos = {
                'success': {icono: 'fas fa-check-circle', color: '#4caf50'},
                'error': {icono: 'fas fa-exclamation-circle', color: '#f44336'},
                'info': {icono: 'fas fa-info-circle', color: '#2196f3'},
                'warning': {icono: 'fas fa-exclamation-triangle', color: '#ff9800'}
            };
            
            const tipoConfig = tipos[tipo] || tipos.info;
            
            // Crear notificación
            const notificacion = document.createElement('div');
            notificacion.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: white;
                padding: 15px 20px;
                border-radius: 5px;
                box-shadow: 0 3px 15px rgba(0,0,0,0.2);
                display: flex;
                align-items: center;
                gap: 10px;
                z-index: 10000;
                border-left: 4px solid ${tipoConfig.color};
                animation: slideIn 0.3s ease;
            `;
            
            notificacion.innerHTML = `
                <i class="${tipoConfig.icono}" style="color: ${tipoConfig.color};"></i>
                <span>${mensaje}</span>
            `;
            
            document.body.appendChild(notificacion);
            
            // Auto-eliminar
            setTimeout(() => {
                notificacion.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notificacion.remove(), 300);
            }, 3000);
            
            // Agregar estilos de animación
            if (!document.getElementById('notificacionEstilos')) {
                const estilos = document.createElement('style');
                estilos.id = 'notificacionEstilos';
                estilos.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(estilos);
            }
        }

        // ===== FUNCIONES GLOBALES =====
        window.guardarBitacora = guardarBitacora;
        window.limpiarBitacora = limpiarBitacora;
        window.guardarTarea = guardarTarea;
        window.cancelarTarea = cancelarTarea;
        window.alternarTarea = alternarTarea;
        window.eliminarTarea = eliminarTarea;
        window.filtrarTareas = filtrarTareas;
        window.cambiarMes = cambiarMes;
        window.irHoy = irHoy;
        window.agregarEventoCalendario = () => agregarEvento(new Date());
        window.cambiarFormularioInforme = cambiarFormularioInforme;
        window.generarInforme = generarInforme;
        window.exportarInforme = exportarInforme;
        window.abrirModalEnlace = abrirModalEnlace;
        window.cerrarModalEnlace = cerrarModalEnlace;
        window.agregarEnlace = agregarEnlace;
        window.mostrarAsistente = mostrarAsistente;
        window.cerrarAsistente = cerrarAsistente;
        window.enviarMensaje = enviarMensaje;
        window.showSection = showSection;

        // Inicializar dashboard al cargar
        setTimeout(() => {
            actualizarDashboard();
            verificarRecordatorios();
        }, 500);
    </script>
</body>
</html>
