<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Integral DRTE MEP v3.0</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* SISTEMA DE DISEÑO PROFESIONAL - INSPIRADO EN APLICACIONES MODERNAS */
        :root {
            /* Paleta de colores profesional */
            --primary-color: #2563eb;
            --primary-dark: #1d4ed8;
            --primary-light: #3b82f6;
            --secondary-color: #7c3aed;
            --accent-color: #06b6d4;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --info-color: #0ea5e9;
            
            /* Colores de fondo y superficie */
            --bg-primary: #f8fafc;
            --bg-secondary: #f1f5f9;
            --bg-surface: #ffffff;
            --bg-sidebar: #1e293b;
            --bg-card: #ffffff;
            
            /* Colores de texto */
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-light: #94a3b8;
            --text-on-dark: #f1f5f9;
            
            /* Bordes y sombras */
            --border-color: #e2e8f0;
            --border-radius: 12px;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.1);
            
            /* Transiciones */
            --transition-fast: 150ms ease;
            --transition-normal: 300ms ease;
            --transition-slow: 500ms ease;
        }

        /* RESET Y CONFIGURACIÓN BASE */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            height: 100%;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* LAYOUT PRINCIPAL - SISTEMA DE GRID */
        .app-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            grid-template-rows: 70px 1fr;
            min-height: 100vh;
            position: relative;
        }

        /* HEADER MODERNO */
        .header {
            grid-column: 1 / -1;
            background: var(--bg-surface);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-md);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            transition: all var(--transition-normal);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            box-shadow: 0 4px 6px rgba(37, 99, 235, 0.2);
        }

        .logo-text h1 {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-text p {
            font-size: 0.75rem;
            color: var(--text-secondary);
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .user-actions {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .notification-badge {
            position: relative;
            cursor: pointer;
            color: var(--text-secondary);
            transition: color var(--transition-fast);
        }

        .notification-badge:hover {
            color: var(--primary-color);
        }

        .badge-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--danger-color);
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .user-profile:hover {
            background: var(--border-color);
        }

        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* SIDEBAR MODERNA */
        .sidebar {
            background: linear-gradient(180deg, var(--bg-sidebar) 0%, #0f172a 100%);
            padding: 2rem 0;
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            z-index: 90;
        }

        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .nav-section {
            padding: 0 1.5rem;
            margin-bottom: 1.5rem;
        }

        .section-label {
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.75rem;
            padding-left: 0.5rem;
        }

        .nav-list {
            list-style: none;
            margin-bottom: 2rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.875rem 1.5rem;
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: all var(--transition-fast);
            border-left: 3px solid transparent;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s ease;
        }

        .nav-item:hover::before {
            left: 100%;
        }

        .nav-item:hover {
            color: white;
            background: rgba(255, 255, 255, 0.05);
            border-left-color: var(--primary-color);
        }

        .nav-item.active {
            color: white;
            background: rgba(37, 99, 235, 0.15);
            border-left-color: var(--primary-color);
            font-weight: 600;
        }

        .nav-item i {
            width: 20px;
            text-align: center;
            font-size: 1.1rem;
        }

        .nav-item .badge {
            margin-left: auto;
            background: var(--primary-color);
            color: white;
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
        }

        /* ASISTENTE IA MEJORADO */
        .assistant-container {
            margin: 2rem 1.5rem;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .assistant-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
        }

        .assistant-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .assistant-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.3);
        }

        .assistant-title h4 {
            color: white;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .assistant-title p {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.85rem;
        }

        .assistant-messages {
            height: 250px;
            overflow-y: auto;
            margin-bottom: 1rem;
            padding-right: 0.5rem;
        }

        .assistant-messages::-webkit-scrollbar {
            width: 4px;
        }

        .assistant-messages::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .assistant-messages::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
        }

        .message {
            margin-bottom: 1rem;
            padding: 0.75rem 1rem;
            border-radius: var(--border-radius);
            animation: messageSlide 0.3s ease;
            position: relative;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.ai {
            background: rgba(255, 255, 255, 0.1);
            border-left: 3px solid var(--accent-color);
            color: white;
        }

        .message.user {
            background: rgba(37, 99, 235, 0.2);
            border-left: 3px solid var(--primary-color);
            color: white;
            margin-left: 1rem;
        }

        .message .sender {
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .message .content {
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .message .timestamp {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.4);
            text-align: right;
            margin-top: 0.5rem;
        }

        .assistant-input-container {
            position: relative;
            margin-top: 1rem;
        }

        .assistant-input {
            width: 100%;
            padding: 0.875rem 1rem 0.875rem 3rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            color: white;
            font-family: inherit;
            font-size: 0.9rem;
            transition: all var(--transition-fast);
        }

        .assistant-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
            background: rgba(255, 255, 255, 0.15);
        }

        .assistant-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .assistant-input-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.5);
        }

        .assistant-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.75rem;
            flex-wrap: wrap;
        }

        .assistant-action {
            padding: 0.5rem 0.75rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            color: white;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .assistant-action:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* CONTENIDO PRINCIPAL */
        .main-content {
            padding: 2rem;
            overflow-y: auto;
            background: var(--bg-primary);
        }

        .content-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .section-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-title i {
            color: var(--primary-color);
            font-size: 1.5rem;
        }

        .section-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        /* BOTONES MEJORADOS */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--border-radius);
            font-family: inherit;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }

        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }

        .btn:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }

        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            100% {
                transform: scale(20, 20);
                opacity: 0;
            }
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            box-shadow: 0 4px 6px rgba(37, 99, 235, 0.2);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(37, 99, 235, 0.3);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--border-color);
            transform: translateY(-2px);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #34d399);
            color: white;
            box-shadow: 0 4px 6px rgba(16, 185, 129, 0.2);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-outline:hover {
            background: var(--primary-color);
            color: white;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            padding: 0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .btn-icon:hover {
            background: var(--border-color);
            color: var(--text-primary);
            transform: rotate(15deg);
        }

        /* ESTADÍSTICAS DASHBOARD */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-color);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, var(--primary-color), var(--secondary-color));
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: white;
        }

        .stat-icon.tareas {
            background: linear-gradient(135deg, var(--danger-color), #f87171);
        }

        .stat-icon.eventos {
            background: linear-gradient(135deg, var(--info-color), #60a5fa);
        }

        .stat-icon.bitacoras {
            background: linear-gradient(135deg, var(--success-color), #34d399);
        }

        .stat-icon.productividad {
            background: linear-gradient(135deg, var(--warning-color), #fbbf24);
        }

        .stat-content {
            display: flex;
            flex-direction: column;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.75rem;
            margin-top: 0.5rem;
        }

        .trend-up {
            color: var(--success-color);
        }

        .trend-down {
            color: var(--danger-color);
        }

        /* CALENDARIO MEJORADO */
        .calendar-container {
            background: var(--bg-surface);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .calendar-nav {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .current-month {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            min-width: 200px;
            text-align: center;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            background: var(--bg-surface);
        }

        .calendar-day-header {
            padding: 1rem;
            text-align: center;
            font-weight: 600;
            color: var(--text-secondary);
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .calendar-day {
            min-height: 120px;
            padding: 0.75rem;
            border-right: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-surface);
            position: relative;
            transition: all var(--transition-fast);
        }

        .calendar-day:nth-child(7n) {
            border-right: none;
        }

        .calendar-day:hover {
            background: var(--bg-secondary);
        }

        .calendar-day.today {
            background: rgba(37, 99, 235, 0.05);
            border-left: 3px solid var(--primary-color);
        }

        .calendar-day.today .day-number {
            color: var(--primary-color);
            font-weight: 700;
        }

        .day-number {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .event-list {
            margin-top: 0.5rem;
        }

        .event-item {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            margin-bottom: 0.25rem;
            border-radius: 4px;
            cursor: pointer;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: all var(--transition-fast);
        }

        .event-item:hover {
            transform: translateX(2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .event-reunion { background: #dbeafe; color: #1e40af; border-left: 3px solid #3b82f6; }
        .event-informe { background: #dcfce7; color: #166534; border-left: 3px solid #10b981; }
        .event-teletrabajo { background: #f3e8ff; color: #6b21a8; border-left: 3px solid #8b5cf6; }
        .event-oficina { background: #fef3c7; color: #92400e; border-left: 3px solid #f59e0b; }

        /* GESTIÓN DE TAREAS MEJORADA */
        .tasks-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .task-card {
            background: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .task-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .task-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
        }

        .task-card.priority-alta::before { background: linear-gradient(90deg, #ef4444, #f87171); }
        .task-card.priority-media::before { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .task-card.priority-baja::before { background: linear-gradient(90deg, #10b981, #34d399); }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .task-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            flex: 1;
            line-height: 1.4;
        }

        .task-status {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 1rem;
            white-space: nowrap;
        }

        .status-pendiente { background: #fee2e2; color: #991b1b; }
        .status-proceso { background: #fef3c7; color: #92400e; }
        .status-completada { background: #d1fae5; color: #065f46; }

        .task-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 1rem;
            max-height: 60px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }

        .task-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }

        .task-date {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .task-actions {
            display: flex;
            gap: 0.5rem;
        }

        .task-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: none;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .task-btn:hover {
            background: var(--border-color);
            color: var(--text-primary);
            transform: scale(1.1);
        }

        .task-btn.edit:hover { background: #dbeafe; color: var(--primary-color); }
        .task-btn.delete:hover { background: #fee2e2; color: var(--danger-color); }
        .task-btn.complete:hover { background: #d1fae5; color: var(--success-color); }

        /* SISTEMA DE BITÁCORAS COMPLETO */
        .bitacoras-system {
            background: var(--bg-surface);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .bitacoras-header {
            display: flex;
            gap: 1rem;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .bitacora-tab {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            color: var(--text-secondary);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .bitacora-tab:hover {
            background: var(--bg-surface);
            color: var(--text-primary);
        }

        .bitacora-tab.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .bitacora-content {
            padding: 2rem;
            min-height: 400px;
        }

        .bitacora-form {
            max-width: 800px;
            margin: 0 auto;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .form-control {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            background: var(--bg-surface);
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9rem;
            transition: all var(--transition-fast);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-control::placeholder {
            color: var(--text-light);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
            line-height: 1.5;
        }

        .bitacora-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .bitacora-item {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            transition: all var(--transition-fast);
        }

        .bitacora-item:hover {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-sm);
            transform: translateX(5px);
        }

        .bitacora-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .bitacora-title {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1.1rem;
        }

        .bitacora-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .badge-diaria { background: #dbeafe; color: #1e40af; }
        .badge-semanal { background: #fef3c7; color: #92400e; }
        .badge-mensual { background: #dcfce7; color: #166534; }

        .bitacora-content-preview {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 1rem;
            max-height: 80px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }

        .bitacora-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text-light);
            font-size: 0.85rem;
        }

        /* SISTEMA DE ENLACES MEJORADO */
        .enlaces-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 1.5rem;
        }

        .enlace-card {
            background: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: 1.5rem 1rem;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            color: var(--text-primary);
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .enlace-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            transform: scaleX(0);
            transition: transform var(--transition-normal);
        }

        .enlace-card:hover::before {
            transform: scaleX(1);
        }

        .enlace-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-color);
        }

        .enlace-icon {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            transition: all var(--transition-fast);
        }

        .enlace-card:hover .enlace-icon {
            transform: scale(1.2);
            color: var(--secondary-color);
        }

        .enlace-title {
            font-weight: 600;
            font-size: 0.9rem;
            text-align: center;
            line-height: 1.3;
            max-height: 2.6em;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .enlace-url {
            font-size: 0.75rem;
            color: var(--text-light);
            text-align: center;
            word-break: break-all;
            max-height: 1.5em;
            overflow: hidden;
        }

        /* MODALES MEJORADOS */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-surface);
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: color var(--transition-fast);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .modal-close:hover {
            color: var(--danger-color);
            background: var(--bg-secondary);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* NOTIFICACIONES */
        .notification-container {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            max-width: 400px;
        }

        .notification {
            background: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: 1rem 1.25rem;
            box-shadow: var(--shadow-lg);
            border-left: 4px solid var(--primary-color);
            animation: slideInRight 0.3s ease;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .notification-icon {
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        .notification-success .notification-icon { color: var(--success-color); }
        .notification-error .notification-icon { color: var(--danger-color); }
        .notification-info .notification-icon { color: var(--info-color); }
        .notification-warning .notification-icon { color: var(--warning-color); }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .notification-message {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .notification-close {
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            font-size: 1rem;
            transition: color var(--transition-fast);
        }

        .notification-close:hover {
            color: var(--text-primary);
        }

        /* RESPONSIVE DESIGN */
        @media (max-width: 1200px) {
            .app-container {
                grid-template-columns: 250px 1fr;
            }
        }

        @media (max-width: 992px) {
            .app-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto 1fr;
            }
            
            .sidebar {
                display: none;
                position: fixed;
                top: 70px;
                left: 0;
                width: 280px;
                height: calc(100vh - 70px);
                z-index: 999;
            }
            
            .sidebar.active {
                display: block;
            }
            
            .mobile-menu-btn {
                display: block !important;
            }
            
            .main-content {
                padding: 1rem;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .tasks-container {
                grid-template-columns: 1fr;
            }
            
            .calendar-grid {
                font-size: 0.9rem;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 0 1rem;
            }
            
            .user-profile .user-name {
                display: none;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .calendar-day {
                min-height: 100px;
                padding: 0.5rem;
            }
            
            .enlaces-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
            
            .modal-content {
                margin: 0.5rem;
                max-height: calc(100vh - 1rem);
            }
        }

        @media (max-width: 576px) {
            .header {
                flex-direction: column;
                height: auto;
                padding: 1rem;
                gap: 1rem;
            }
            
            .logo-container, .user-actions {
                width: 100%;
                justify-content: center;
            }
            
            .section-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .section-actions {
                justify-content: center;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .calendar-header {
                flex-direction: column;
                gap: 1rem;
            }
            
            .calendar-nav {
                order: 2;
            }
        }

        /* UTILITY CLASSES */
        .text-success { color: var(--success-color); }
        .text-danger { color: var(--danger-color); }
        .text-warning { color: var(--warning-color); }
        .text-info { color: var(--info-color); }
        .text-muted { color: var(--text-light); }

        .bg-success { background: var(--success-color); }
        .bg-danger { background: var(--danger-color); }
        .bg-warning { background: var(--warning-color); }
        .bg-info { background: var(--info-color); }

        .d-none { display: none !important; }
        .d-flex { display: flex !important; }
        .d-block { display: block !important; }

        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .text-left { text-align: left; }

        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }

        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }

        .p-1 { padding: 0.5rem; }
        .p-2 { padding: 1rem; }
        .p-3 { padding: 1.5rem; }
        .p-4 { padding: 2rem; }

        /* LOADER */
        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* MOBILE MENU BUTTON */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: var(--border-radius);
            transition: all var(--transition-fast);
        }

        .mobile-menu-btn:hover {
            background: var(--bg-secondary);
        }

        /* PRINT STYLES */
        @media print {
            .sidebar, .header, .modal, .notification-container {
                display: none !important;
            }
            
            .main-content {
                padding: 0;
                background: white;
            }
            
            .content-section {
                display: block !important;
                animation: none;
            }
        }
    </style>
</head>
<body>
    <!-- NOTIFICACIONES -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- APP CONTAINER -->
    <div class="app-container">
        <!-- HEADER -->
        <header class="header">
            <div class="logo-container">
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="logo">
                    <i class="fas fa-tasks"></i>
                </div>
                <div class="logo-text">
                    <h1>DRTE MEP</h1>
                    <p>Sistema Integral de Gestión</p>
                </div>
            </div>

            <div class="user-actions">
                <div class="notification-badge">
                    <i class="fas fa-bell"></i>
                    <span class="badge-count">3</span>
                </div>
                <div class="user-profile" id="userProfile">
                    <div class="avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="user-name">
                        <div style="font-weight: 600; color: var(--text-primary);">Asesor Nacional</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">MEP Costa Rica</div>
                    </div>
                </div>
            </div>
        </header>

        <!-- SIDEBAR -->
        <aside class="sidebar" id="sidebar">
            <!-- ASISTENTE IA MEJORADO -->
            <div class="assistant-container">
                <div class="assistant-header">
                    <div class="assistant-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="assistant-title">
                        <h4>Asistente DRTE</h4>
                        <p>Inteligencia Artificial</p>
                    </div>
                </div>

                <div class="assistant-messages" id="assistantMessages">
                    <div class="message ai">
                        <div class="sender">Asistente DRTE</div>
                        <div class="content">¡Hola! Soy tu asistente de inteligencia artificial. ¿En qué puedo ayudarte hoy?</div>
                        <div class="timestamp" id="currentTime"></div>
                    </div>
                </div>

                <div class="assistant-input-container">
                    <i class="fas fa-paper-plane assistant-input-icon"></i>
                    <input type="text" class="assistant-input" id="assistantInput" 
                           placeholder="Escribe tu pregunta o comando..." 
                           autocomplete="off"
                           onkeypress="if(event.key === 'Enter') handleAssistantQuery()">
                </div>

                <div class="assistant-actions">
                    <div class="assistant-action" onclick="quickCommand('tareas-hoy')">
                        <i class="fas fa-tasks"></i> Tareas Hoy
                    </div>
                    <div class="assistant-action" onclick="quickCommand('actividades-ayer')">
                        <i class="fas fa-calendar-day"></i> Ayer
                    </div>
                    <div class="assistant-action" onclick="quickCommand('informe-semanal')">
                        <i class="fas fa-file-alt"></i> Informe
                    </div>
                    <div class="assistant-action" onclick="quickCommand('eventos-hoy')">
                        <i class="fas fa-calendar-check"></i> Eventos
                    </div>
                </div>
            </div>

            <!-- NAVEGACIÓN -->
            <div class="nav-section">
                <div class="section-label">Navegación Principal</div>
                <ul class="nav-list">
                    <li>
                        <a class="nav-item active" data-section="dashboard">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Dashboard</span>
                            <span class="badge">Inicio</span>
                        </a>
                    </li>
                    <li>
                        <a class="nav-item" data-section="calendario">
                            <i class="fas fa-calendar-alt"></i>
                            <span>Calendario</span>
                        </a>
                    </li>
                    <li>
                        <a class="nav-item" data-section="tareas">
                            <i class="fas fa-tasks"></i>
                            <span>Gestión de Tareas</span>
                            <span class="badge" id="pendingTasksBadge">0</span>
                        </a>
                    </li>
                    <li>
                        <a class="nav-item" data-section="bitacoras">
                            <i class="fas fa-book"></i>
                            <span>Bitácoras</span>
                        </a>
                    </li>
                    <li>
                        <a class="nav-item" data-section="informes">
                            <i class="fas fa-chart-bar"></i>
                            <span>Informes</span>
                        </a>
                    </li>
                    <li>
                        <a class="nav-item" data-section="enlaces">
                            <i class="fas fa-link"></i>
                            <span>Enlaces Rápidos</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="nav-section">
                <div class="section-label">Herramientas</div>
                <ul class="nav-list">
                    <li>
                        <a class="nav-item" data-section="configuracion">
                            <i class="fas fa-cog"></i>
                            <span>Configuración</span>
                        </a>
                    </li>
                    <li>
                        <a class="nav-item" onclick="exportAllData()">
                            <i class="fas fa-download"></i>
                            <span>Exportar Datos</span>
                        </a>
                    </li>
                    <li>
                        <a class="nav-item" onclick="importData()">
                            <i class="fas fa-upload"></i>
                            <span>Importar Datos</span>
                        </a>
                    </li>
                </ul>
            </div>
        </aside>

        <!-- CONTENIDO PRINCIPAL -->
        <main class="main-content" id="mainContent">
            <!-- DASHBOARD -->
            <section id="dashboard" class="content-section active">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-tachometer-alt"></i>
                        Dashboard Principal
                    </h2>
                    <div class="section-actions">
                        <button class="btn btn-outline" onclick="generarInforme('diario')">
                            <i class="fas fa-file-export"></i> Informe Diario
                        </button>
                        <button class="btn btn-primary" onclick="checkDailyBitacora()">
                            <i class="fas fa-plus"></i> Bitácora Diaria
                        </button>
                    </div>
                </div>

                <!-- ESTADÍSTICAS -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon tareas">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="totalTareas">0</div>
                            <div class="stat-label">Tareas Pendientes</div>
                            <div class="stat-trend trend-up" id="tasksTrend">
                                <i class="fas fa-arrow-up"></i>
                                <span>+2 esta semana</span>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon eventos">
                            <i class="fas fa-calendar-day"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="eventosHoy">0</div>
                            <div class="stat-label">Eventos Hoy</div>
                            <div class="stat-trend" id="eventsTrend">
                                <i class="fas fa-calendar"></i>
                                <span>Ver calendario</span>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon bitacoras">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="totalBitacoras">0</div>
                            <div class="stat-label">Bitácoras Registradas</div>
                            <div class="stat-trend trend-up" id="bitacorasTrend">
                                <i class="fas fa-chart-line"></i>
                                <span>Actividad alta</span>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon productividad">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="productividad">0%</div>
                            <div class="stat-label">Productividad</div>
                            <div class="stat-trend trend-up" id="productivityTrend">
                                <i class="fas fa-arrow-up"></i>
                                <span>+5% este mes</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PRÓXIMAS ACTIVIDADES -->
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-calendar-check"></i>
                        Próximas Actividades
                    </h2>
                    <button class="btn btn-secondary" onclick="navigateTo('calendario')">
                        <i class="fas fa-calendar-alt"></i> Ver Calendario Completo
                    </button>
                </div>

                <div class="calendar-container">
                    <div id="miniCalendar"></div>
                </div>
            </section>

            <!-- CALENDARIO -->
            <section id="calendario" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-calendar-alt"></i>
                        Calendario Avanzado
                    </h2>
                    <div class="section-actions">
                        <div class="btn-group">
                            <button class="btn btn-secondary" onclick="changeView('month')">
                                <i class="fas fa-calendar-alt"></i> Mes
                            </button>
                            <button class="btn btn-secondary" onclick="changeView('week')">
                                <i class="fas fa-calendar-week"></i> Semana
                            </button>
                            <button class="btn btn-secondary" onclick="changeView('day')">
                                <i class="fas fa-calendar-day"></i> Día
                            </button>
                        </div>
                        <button class="btn btn-primary" onclick="openEventModal()">
                            <i class="fas fa-plus"></i> Nuevo Evento
                        </button>
                    </div>
                </div>

                <div class="calendar-container">
                    <div class="calendar-header">
                        <div class="calendar-nav">
                            <button class="btn-icon" onclick="prevPeriod()">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <h3 class="current-month" id="calendarTitle">Enero 2026</h3>
                            <button class="btn-icon" onclick="nextPeriod()">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        <button class="btn btn-secondary" onclick="goToToday()">
                            <i class="fas fa-calendar-day"></i> Hoy
                        </button>
                    </div>
                    <div class="calendar-grid" id="calendarView">
                        <!-- Calendario se renderiza dinámicamente -->
                    </div>
                </div>
            </section>

            <!-- GESTIÓN DE TAREAS -->
            <section id="tareas" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-tasks"></i>
                        Gestión de Tareas
                    </h2>
                    <div class="section-actions">
                        <div class="filter-group">
                            <select class="form-control" id="taskFilter" onchange="filterTasks()" style="width: auto;">
                                <option value="all">Todas las tareas</option>
                                <option value="pending">Pendientes</option>
                                <option value="in-progress">En progreso</option>
                                <option value="completed">Completadas</option>
                                <option value="high">Alta prioridad</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" onclick="openTaskModal()">
                            <i class="fas fa-plus"></i> Nueva Tarea
                        </button>
                    </div>
                </div>

                <div class="tasks-container" id="tasksContainer">
                    <!-- Tareas se cargan dinámicamente -->
                </div>
            </section>

            <!-- BITÁCORAS COMPLETO -->
            <section id="bitacoras" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-book"></i>
                        Sistema de Bitácoras
                    </h2>
                    <div class="section-actions">
                        <button class="btn btn-secondary" onclick="openBitacoraModal('diaria')">
                            <i class="fas fa-plus"></i> Bitácora Diaria
                        </button>
                        <button class="btn btn-primary" onclick="openBitacoraModal('semanal')">
                            <i class="fas fa-calendar-week"></i> Plan Semanal
                        </button>
                    </div>
                </div>

                <div class="bitacoras-system">
                    <div class="bitacoras-header">
                        <button class="bitacora-tab active" data-tab="diaria">
                            <i class="fas fa-calendar-day"></i> Bitácoras Diarias
                        </button>
                        <button class="bitacora-tab" data-tab="semanal">
                            <i class="fas fa-calendar-week"></i> Planes Semanales
                        </button>
                        <button class="bitacora-tab" data-tab="mensual">
                            <i class="fas fa-calendar-month"></i> Informes Mensuales
                        </button>
                    </div>

                    <div class="bitacora-content">
                        <div class="bitacora-tab-content active" id="tab-diaria">
                            <div class="bitacora-list" id="diariaList">
                                <!-- Bitácoras diarias se cargan dinámicamente -->
                            </div>
                        </div>
                        <div class="bitacora-tab-content" id="tab-semanal">
                            <div class="bitacora-list" id="semanalList">
                                <!-- Planes semanales se cargan dinámicamente -->
                            </div>
                        </div>
                        <div class="bitacora-tab-content" id="tab-mensual">
                            <div class="bitacora-list" id="mensualList">
                                <!-- Informes mensuales se cargan dinámicamente -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- INFORMES COMPLETO -->
            <section id="informes" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-chart-bar"></i>
                        Informes y Exportación
                    </h2>
                    <div class="section-actions">
                        <button class="btn btn-primary" onclick="exportAllReports()">
                            <i class="fas fa-file-export"></i> Exportar Todo
                        </button>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card" onclick="generarInforme('diario')" style="cursor: pointer;">
                        <div class="stat-icon tareas">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number">Diario</div>
                            <div class="stat-label">Informe del día</div>
                            <div class="stat-trend">
                                <i class="fas fa-clock"></i>
                                <span>Generar ahora</span>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card" onclick="generarInforme('semanal')" style="cursor: pointer;">
                        <div class="stat-icon eventos">
                            <i class="fas fa-file-contract"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number">Semanal</div>
                            <div class="stat-label">Resumen semanal</div>
                            <div class="stat-trend">
                                <i class="fas fa-calendar-week"></i>
                                <span>Última semana</span>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card" onclick="generarInforme('mensual')" style="cursor: pointer;">
                        <div class="stat-icon bitacoras">
                            <i class="fas fa-file-invoice"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number">Mensual</div>
                            <div class="stat-label">Reporte mensual</div>
                            <div class="stat-trend">
                                <i class="fas fa-calendar-month"></i>
                                <span>Este mes</span>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card" onclick="openExportModal()" style="cursor: pointer;">
                        <div class="stat-icon productividad">
                            <i class="fas fa-download"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number">Exportar</div>
                            <div class="stat-label">PDF, Excel, Word</div>
                            <div class="stat-trend">
                                <i class="fas fa-file-export"></i>
                                <span>Multiples formatos</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CONFIGURACIÓN DE INFORME AUTOMÁTICO -->
                <div class="section-header mt-4">
                    <h3 class="section-title">
                        <i class="fas fa-cogs"></i>
                        Informe Automático de las 8 AM
                    </h3>
                </div>

                <div class="calendar-container">
                    <div class="p-4">
                        <div class="form-group">
                            <label class="form-label">Activar informe automático diario</label>
                            <div style="display: flex; align-items: center; gap: 1rem; margin-top: 0.5rem;">
                                <label class="switch">
                                    <input type="checkbox" id="autoReportToggle" onchange="toggleAutoReport()">
                                    <span class="slider"></span>
                                </label>
                                <span id="reportStatus" class="text-muted">Inactivo</span>
                            </div>
                            <small class="text-muted">El sistema generará y enviará automáticamente un informe diario a las 8:00 AM</small>
                        </div>

                        <div class="form-group mt-3">
                            <label class="form-label">Destinatarios del informe</label>
                            <input type="text" class="form-control" id="reportRecipients" 
                                   placeholder="correo@ejemplo.com, otro@ejemplo.com"
                                   value="asesor@mep.go.cr, supervisor@mep.go.cr">
                        </div>

                        <div class="mt-3">
                            <button class="btn btn-primary" onclick="testAutoReport()">
                                <i class="fas fa-play-circle"></i> Probar Ahora
                            </button>
                            <button class="btn btn-success" onclick="generateTestReport()">
                                <i class="fas fa-file-pdf"></i> Generar PDF de Prueba
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ENLACES RÁPIDOS -->
            <section id="enlaces" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-link"></i>
                        Enlaces Rápidos
                    </h2>
                    <button class="btn btn-primary" onclick="openLinkModal()">
                        <i class="fas fa-plus"></i> Agregar Enlace
                    </button>
                </div>

                <div class="enlaces-grid" id="enlacesGrid">
                    <!-- Enlaces se cargan dinámicamente -->
                </div>
            </section>

            <!-- CONFIGURACIÓN -->
            <section id="configuracion" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-cog"></i>
                        Configuración del Sistema
                    </h2>
                </div>

                <div class="calendar-container">
                    <div class="p-4">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Tema del sistema</label>
                                <select class="form-control" id="themeSelect" onchange="changeTheme()">
                                    <option value="light">Claro</option>
                                    <option value="dark">Oscuro</option>
                                    <option value="auto">Automático</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Idioma</label>
                                <select class="form-control" id="languageSelect">
                                    <option value="es">Español</option>
                                    <option value="en">English</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Notificaciones</label>
                            <div style="display: flex; flex-direction: column; gap: 0.5rem; margin-top: 0.5rem;">
                                <label class="d-flex align-items-center">
                                    <input type="checkbox" id="notifyTasks" checked>
                                    <span style="margin-left: 0.5rem;">Recordatorios de tareas</span>
                                </label>
                                <label class="d-flex align-items-center">
                                    <input type="checkbox" id="notifyEvents" checked>
                                    <span style="margin-left: 0.5rem;">Recordatorios de eventos</span>
                                </label>
                                <label class="d-flex align-items-center">
                                    <input type="checkbox" id="notifyReports" checked>
                                    <span style="margin-left: 0.5rem;">Informes automáticos</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group mt-3">
                            <label class="form-label">Copia de seguridad automática</label>
                            <select class="form-control" id="backupFrequency">
                                <option value="daily">Diariamente</option>
                                <option value="weekly">Semanalmente</option>
                                <option value="monthly">Mensualmente</option>
                                <option value="never">Nunca</option>
                            </select>
                        </div>

                        <div class="mt-4">
                            <button class="btn btn-primary" onclick="saveSettings()">
                                <i class="fas fa-save"></i> Guardar Configuración
                            </button>
                            <button class="btn btn-secondary" onclick="resetSettings()">
                                <i class="fas fa-undo"></i> Restablecer
                            </button>
                            <button class="btn btn-danger" onclick="clearAllData()">
                                <i class="fas fa-trash"></i> Borrar Todos los Datos
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- MODALES -->
    <!-- Modal para Tareas -->
    <div class="modal" id="taskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="taskModalTitle">Nueva Tarea</h3>
                <button class="modal-close" onclick="closeModal('taskModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="taskForm">
                    <input type="hidden" id="taskId">
                    <div class="form-group">
                        <label class="form-label">Título de la tarea *</label>
                        <input type="text" class="form-control" id="taskTitle" required 
                               placeholder="Ingrese el título de la tarea">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Descripción</label>
                        <textarea class="form-control" id="taskDescription" rows="3" 
                                  placeholder="Describa la tarea en detalle"></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Prioridad</label>
                            <select class="form-control" id="taskPriority">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Media</option>
                                <option value="baja">Baja</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Estado</label>
                            <select class="form-control" id="taskStatus">
                                <option value="pendiente">Pendiente</option>
                                <option value="en-proceso">En proceso</option>
                                <option value="completada">Completada</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Fecha de inicio</label>
                            <input type="date" class="form-control" id="taskStartDate">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Fecha límite</label>
                            <input type="date" class="form-control" id="taskDueDate">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Etiquetas (separadas por comas)</label>
                        <input type="text" class="form-control" id="taskTags" 
                               placeholder="urgente, informe, reunión">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('taskModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="saveTask()">Guardar Tarea</button>
            </div>
        </div>
    </div>

    <!-- Modal para Eventos -->
    <div class="modal" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="eventModalTitle">Nuevo Evento</h3>
                <button class="modal-close" onclick="closeModal('eventModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="eventForm">
                    <input type="hidden" id="eventId">
                    <div class="form-group">
                        <label class="form-label">Título del evento *</label>
                        <input type="text" class="form-control" id="eventTitle" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Tipo de evento</label>
                        <select class="form-control" id="eventType">
                            <option value="reunion">Reunión</option>
                            <option value="informe">Informe</option>
                            <option value="teletrabajo">Teletrabajo</option>
                            <option value="oficina">Oficina</option>
                            <option value="capacitacion">Capacitación</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Fecha y hora de inicio *</label>
                            <input type="datetime-local" class="form-control" id="eventStart" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Fecha y hora de fin *</label>
                            <input type="datetime-local" class="form-control" id="eventEnd" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Descripción</label>
                        <textarea class="form-control" id="eventDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Ubicación / Enlace</label>
                        <input type="text" class="form-control" id="eventLocation" 
                               placeholder="Sala de reuniones o enlace de videoconferencia">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Recordatorio</label>
                        <select class="form-control" id="eventReminder">
                            <option value="none">Sin recordatorio</option>
                            <option value="5">5 minutos antes</option>
                            <option value="15">15 minutos antes</option>
                            <option value="30">30 minutos antes</option>
                            <option value="60">1 hora antes</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('eventModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="saveEvent()">Guardar Evento</button>
            </div>
        </div>
    </div>

    <!-- Modal para Bitácoras -->
    <div class="modal" id="bitacoraModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="bitacoraModalTitle">Bitácora Diaria</h3>
                <button class="modal-close" onclick="closeModal('bitacoraModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="bitacoraForm">
                    <input type="hidden" id="bitacoraId">
                    <input type="hidden" id="bitacoraTipo" value="diaria">
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Fecha *</label>
                            <input type="date" class="form-control" id="bitacoraFecha" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Modalidad *</label>
                            <select class="form-control" id="bitacoraModalidad" required>
                                <option value="teletrabajo">Teletrabajo</option>
                                <option value="oficina">Oficina</option>
                                <option value="hibrido">Híbrido</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Actividades realizadas *</label>
                        <textarea class="form-control" id="bitacoraActividades" rows="4" required
                                  placeholder="Describa las actividades realizadas durante el día..."></textarea>
                        <small class="text-muted">Separe cada actividad con un punto y aparte.</small>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Horas invertidas *</label>
                            <input type="number" class="form-control" id="bitacoraHoras" 
                                   min="0" max="24" step="0.5" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Productividad</label>
                            <select class="form-control" id="bitacoraProductividad">
                                <option value="alta">Alta</option>
                                <option value="media" selected>Media</option>
                                <option value="baja">Baja</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Observaciones</label>
                        <textarea class="form-control" id="bitacoraObservaciones" rows="3"
                                  placeholder="Observaciones adicionales, dificultades encontradas, etc."></textarea>
                    </div>
                    
                    <div class="form-group" id="planSemanalGroup" style="display: none;">
                        <label class="form-label">Objetivos de la semana *</label>
                        <textarea class="form-control" id="planObjetivos" rows="3"
                                  placeholder="Defina los objetivos principales para esta semana..."></textarea>
                    </div>
                    
                    <div class="form-group" id="actividadesPorDiaGroup" style="display: none;">
                        <label class="form-label">Actividades por día</label>
                        <div class="day-activities">
                            <div class="day-activity">
                                <label class="form-label">Lunes</label>
                                <textarea class="form-control" rows="2" placeholder="Actividades para el lunes"></textarea>
                            </div>
                            <div class="day-activity">
                                <label class="form-label">Martes</label>
                                <textarea class="form-control" rows="2" placeholder="Actividades para el martes"></textarea>
                            </div>
                            <!-- Más días... -->
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('bitacoraModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="saveBitacora()">Guardar Bitácora</button>
            </div>
        </div>
    </div>

    <!-- Modal para Enlaces -->
    <div class="modal" id="linkModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Agregar Enlace Rápido</h3>
                <button class="modal-close" onclick="closeModal('linkModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="linkForm">
                    <div class="form-group">
                        <label class="form-label">URL del enlace *</label>
                        <input type="url" class="form-control" id="linkUrl" required
                               placeholder="https://ejemplo.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Nombre (se detectará automáticamente)</label>
                        <input type="text" class="form-control" id="linkName" 
                               placeholder="Dejar en blanco para auto-detectar">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Categoría</label>
                        <select class="form-control" id="linkCategory">
                            <option value="trabajo">Trabajo</option>
                            <option value="comunicacion">Comunicación</option>
                            <option value="herramientas">Herramientas</option>
                            <option value="recursos">Recursos</option>
                            <option value="personal">Personal</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Icono (opcional)</label>
                        <div class="icon-preview" style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                            <div id="iconPreview" style="font-size: 1.5rem; color: var(--primary-color);">
                                <i class="fas fa-external-link-alt"></i>
                            </div>
                            <input type="text" class="form-control" id="linkIcon" 
                                   placeholder="fas fa-envelope" 
                                   onchange="updateIconPreview()">
                        </div>
                        <small class="text-muted">Usa clases de FontAwesome o deja en blanco para auto-detectar</small>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('linkModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="saveLink()">Agregar Enlace</button>
            </div>
        </div>
    </div>

    <!-- Modal para Exportar -->
    <div class="modal" id="exportModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title">Exportar Informes</h3>
                <button class="modal-close" onclick="closeModal('exportModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Seleccione formato de exportación</label>
                    <div class="export-options" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-top: 1rem;">
                        <div class="export-option" onclick="exportTo('pdf')" style="cursor: pointer; padding: 1rem; border: 1px solid var(--border-color); border-radius: var(--border-radius); text-align: center; transition: all var(--transition-fast);">
                            <div style="font-size: 2rem; color: #ff6b6b; margin-bottom: 0.5rem;">
                                <i class="fas fa-file-pdf"></i>
                            </div>
                            <div style="font-weight: 600;">PDF</div>
                            <small class="text-muted">Documento imprimible</small>
                        </div>
                        <div class="export-option" onclick="exportTo('excel')" style="cursor: pointer; padding: 1rem; border: 1px solid var(--border-color); border-radius: var(--border-radius); text-align: center; transition: all var(--transition-fast);">
                            <div style="font-size: 2rem; color: #51cf66; margin-bottom: 0.5rem;">
                                <i class="fas fa-file-excel"></i>
                            </div>
                            <div style="font-weight: 600;">Excel</div>
                            <small class="text-muted">Tabla de datos</small>
                        </div>
                        <div class="export-option" onclick="exportTo('word')" style="cursor: pointer; padding: 1rem; border: 1px solid var(--border-color); border-radius: var(--border-radius); text-align: center; transition: all var(--transition-fast);">
                            <div style="font-size: 2rem; color: #339af0; margin-bottom: 0.5rem;">
                                <i class="fas fa-file-word"></i>
                            </div>
                            <div style="font-weight: 600;">Word</div>
                            <small class="text-muted">Documento editable</small>
                        </div>
                        <div class="export-option" onclick="exportTo('csv')" style="cursor: pointer; padding: 1rem; border: 1px solid var(--border-color); border-radius: var(--border-radius); text-align: center; transition: all var(--transition-fast);">
                            <div style="font-size: 2rem; color: #ff922b; margin-bottom: 0.5rem;">
                                <i class="fas fa-file-csv"></i>
                            </div>
                            <div style="font-weight: 600;">CSV</div>
                            <small class="text-muted">Datos estructurados</small>
                        </div>
                    </div>
                </div>
                
                <div class="form-group mt-3">
                    <label class="form-label">Rango de fechas</label>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="date" class="form-control" id="exportStartDate">
                        </div>
                        <div class="form-group">
                            <input type="date" class="form-control" id="exportEndDate" value="<?php echo date('Y-m-d'); ?>">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Incluir</label>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem; margin-top: 0.5rem;">
                        <label class="d-flex align-items-center">
                            <input type="checkbox" id="includeTasks" checked>
                            <span style="margin-left: 0.5rem;">Tareas</span>
                        </label>
                        <label class="d-flex align-items-center">
                            <input type="checkbox" id="includeEvents" checked>
                            <span style="margin-left: 0.5rem;">Eventos</span>
                        </label>
                        <label class="d-flex align-items-center">
                            <input type="checkbox" id="includeBitacoras" checked>
                            <span style="margin-left: 0.5rem;">Bitácoras</span>
                        </label>
                        <label class="d-flex align-items-center">
                            <input type="checkbox" id="includeStats" checked>
                            <span style="margin-left: 0.5rem;">Estadísticas</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('exportModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="startExport()">Exportar</button>
            </div>
        </div>
    </div>

    <!-- TOGGLE SWITCH STYLES -->
    <style>
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--success-color);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
    </style>

    <script>
        // ==============================================
        // SISTEMA DE GESTIÓN DRTE MEP v3.0
        // ==============================================

        // CLASE PRINCIPAL DEL SISTEMA
        class SistemaDRTE {
            constructor() {
                this.initialize();
            }
            
            initialize() {
                // Cargar datos del localStorage
                this.loadData();
                
                // Configurar fecha y hora actual
                this.updateCurrentTime();
                
                // Inicializar componentes
                this.initEventListeners();
                this.initAssistant();
                this.renderDashboard();
                this.loadInitialData();
                
                // Configurar informe automático
                this.setupAutoReport();
                
                console.log('✅ Sistema DRTE MEP v3.0 inicializado');
            }
            
            loadData() {
                // Cargar datos desde localStorage o usar valores por defecto
                this.tareas = JSON.parse(localStorage.getItem('drte_tareas')) || this.getDefaultTasks();
                this.eventos = JSON.parse(localStorage.getItem('drte_eventos')) || [];
                this.bitacoras = JSON.parse(localStorage.getItem('drte_bitacoras')) || [];
                this.enlaces = JSON.parse(localStorage.getItem('drte_enlaces')) || this.getDefaultLinks();
                this.configuracion = JSON.parse(localStorage.getItem('drte_config')) || this.getDefaultConfig();
                
                // Inicializar contadores
                this.updateCounters();
            }
            
            getDefaultTasks() {
                return [
                    {
                        id: 1,
                        titulo: "Revisar informes mensuales",
                        descripcion: "Revisar y aprobar los informes mensuales del departamento",
                        prioridad: "alta",
                        estado: "pendiente",
                        fechaCreacion: "2026-01-15",
                        fechaLimite: "2026-01-20",
                        etiquetas: ["informe", "revision", "urgente"]
                    },
                    {
                        id: 2,
                        titulo: "Preparar presentación para reunión",
                        descripcion: "Preparar la presentación para la reunión de coordinación",
                        prioridad: "media",
                        estado: "en-proceso",
                        fechaCreacion: "2026-01-14",
                        fechaLimite: "2026-01-18",
                        etiquetas: ["presentacion", "reunion"]
                    }
                ];
            }
            
            getDefaultLinks() {
                return [
                    {
                        id: 1,
                        nombre: "Outlook MEP",
                        url: "https://outlook.office.com",
                        icono: "fas fa-envelope",
                        categoria: "comunicacion"
                    },
                    {
                        id: 2,
                        nombre: "Microsoft Teams",
                        url: "https://teams.microsoft.com",
                        icono: "fas fa-users",
                        categoria: "comunicacion"
                    },
                    {
                        id: 3,
                        nombre: "Symbaloo",
                        url: "https://www.symbaloo.com",
                        icono: "fas fa-th",
                        categoria: "herramientas"
                    },
                    {
                        id: 4,
                        nombre: "Copilot",
                        url: "https://copilot.microsoft.com",
                        icono: "fas fa-robot",
                        categoria: "herramientas"
                    },
                    {
                        id: 5,
                        nombre: "Portal MEP",
                        url: "https://www.mep.go.cr",
                        icono: "fas fa-graduation-cap",
                        categoria: "trabajo"
                    },
                    {
                        id: 6,
                        nombre: "Google Drive",
                        url: "https://drive.google.com",
                        icono: "fab fa-google-drive",
                        categoria: "herramientas"
                    }
                ];
            }
            
            getDefaultConfig() {
                return {
                    tema: "light",
                    idioma: "es",
                    notificaciones: {
                        tareas: true,
                        eventos: true,
                        informes: true
                    },
                    backup: "weekly",
                    autoReport: {
                        enabled: false,
                        time: "08:00",
                        recipients: "asesor@mep.go.cr"
                    }
                };
            }
            
            saveData() {
                localStorage.setItem('drte_tareas', JSON.stringify(this.tareas));
                localStorage.setItem('drte_eventos', JSON.stringify(this.eventos));
                localStorage.setItem('drte_bitacoras', JSON.stringify(this.bitacoras));
                localStorage.setItem('drte_enlaces', JSON.stringify(this.enlaces));
                localStorage.setItem('drte_config', JSON.stringify(this.configuracion));
            }
            
            updateCounters() {
                // Actualizar contador de tareas pendientes
                const pendingTasks = this.tareas.filter(t => t.estado === 'pendiente').length;
                document.getElementById('totalTareas').textContent = pendingTasks;
                document.getElementById('pendingTasksBadge').textContent = pendingTasks;
                
                // Actualizar eventos de hoy
                const today = new Date().toDateString();
                const todayEvents = this.eventos.filter(e => {
                    return new Date(e.inicio).toDateString() === today;
                }).length;
                document.getElementById('eventosHoy').textContent = todayEvents;
                
                // Actualizar total de bitácoras
                document.getElementById('totalBitacoras').textContent = this.bitacoras.length;
                
                // Calcular productividad
                const completedTasks = this.tareas.filter(t => t.estado === 'completada').length;
                const productivity = this.tareas.length > 0 
                    ? Math.round((completedTasks / this.tareas.length) * 100) 
                    : 0;
                document.getElementById('productividad').textContent = `${productivity}%`;
            }
            
            updateCurrentTime() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('es-ES', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                document.getElementById('currentTime').textContent = timeString;
                
                // Actualizar cada minuto
                setTimeout(() => this.updateCurrentTime(), 60000);
            }
            
            initEventListeners() {
                // Navegación
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        const section = item.getAttribute('data-section');
                        this.navigateTo(section);
                    });
                });
                
                // Tabs de bitácoras
                document.querySelectorAll('.bitacora-tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabId = tab.getAttribute('data-tab');
                        this.switchBitacoraTab(tabId);
                    });
                });
                
                // Botón menú móvil
                document.getElementById('mobileMenuBtn').addEventListener('click', () => {
                    document.getElementById('sidebar').classList.toggle('active');
                });
                
                // Cerrar menú al hacer clic fuera
                document.addEventListener('click', (e) => {
                    const sidebar = document.getElementById('sidebar');
                    const menuBtn = document.getElementById('mobileMenuBtn');
                    
                    if (!sidebar.contains(e.target) && !menuBtn.contains(e.target)) {
                        sidebar.classList.remove('active');
                    }
                });
            }
            
            navigateTo(section) {
                // Actualizar navegación activa
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                event.target.classList.add('active');
                
                // Ocultar todas las secciones
                document.querySelectorAll('.content-section').forEach(sec => {
                    sec.classList.remove('active');
                });
                
                // Mostrar sección seleccionada
                document.getElementById(section).classList.add('active');
                
                // Cargar datos específicos de la sección
                switch(section) {
                    case 'tareas':
                        this.renderTareas();
                        break;
                    case 'calendario':
                        this.renderCalendar();
                        break;
                    case 'bitacoras':
                        this.renderBitacoras();
                        break;
                    case 'enlaces':
                        this.renderEnlaces();
                        break;
                }
                
                // Cerrar menú en móvil
                document.getElementById('sidebar').classList.remove('active');
            }
            
            initAssistant() {
                // Configurar comandos rápidos
                window.quickCommand = (command) => {
                    let query = '';
                    switch(command) {
                        case 'tareas-hoy':
                            query = "¿Qué tareas tengo para hoy?";
                            break;
                        case 'actividades-ayer':
                            query = "¿Qué actividades hice ayer?";
                            break;
                        case 'informe-semanal':
                            query = "Genera mi informe semanal";
                            break;
                        case 'eventos-hoy':
                            query = "¿Qué eventos tengo hoy?";
                            break;
                    }
                    
                    document.getElementById('assistantInput').value = query;
                    this.handleAssistantQuery();
                };
                
                // Configurar input del asistente
                document.getElementById('assistantInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.handleAssistantQuery();
                    }
                });
            }
            
            async handleAssistantQuery() {
                const input = document.getElementById('assistantInput');
                const query = input.value.trim();
                
                if (!query) return;
                
                // Mostrar mensaje del usuario
                this.addAssistantMessage(query, 'user');
                input.value = '';
                
                // Mostrar indicador de carga
                const loadingId = this.showLoading();
                
                // Procesar consulta
                setTimeout(() => {
                    const response = this.processQuery(query);
                    this.removeLoading(loadingId);
                    this.addAssistantMessage(response, 'ai');
                }, 800);
            }
            
            processQuery(query) {
                const queryLower = query.toLowerCase();
                
                // COMANDOS DE TAREAS
                if (queryLower.includes('tarea') || queryLower.includes('pendiente')) {
                    if (queryLower.includes('hoy') || queryLower.includes('para hoy')) {
                        const today = new Date().toISOString().split('T')[0];
                        const tasksToday = this.tareas.filter(t => 
                            t.fechaLimite === today && t.estado !== 'completada'
                        );
                        
                        if (tasksToday.length === 0) {
                            return "No tienes tareas pendientes para hoy. ¡Excelente trabajo!";
                        }
                        
                        let response = `Tienes ${tasksToday.length} tarea(s) pendiente(s) para hoy:\n\n`;
                        tasksToday.forEach((task, index) => {
                            response += `${index + 1}. ${task.titulo} (${task.prioridad} prioridad)\n`;
                        });
                        
                        return response;
                    }
                    
                    const pendingTasks = this.tareas.filter(t => t.estado === 'pendiente');
                    if (pendingTasks.length === 0) {
                        return "No tienes tareas pendientes. ¡Todo está al día!";
                    }
                    
                    let response = `Tienes ${pendingTasks.length} tarea(s) pendiente(s):\n\n`;
                    pendingTasks.slice(0, 5).forEach((task, index) => {
                        const dueDate = task.fechaLimite ? 
                            `Vence: ${new Date(task.fechaLimite).toLocaleDateString('es-ES')}` : 
                            'Sin fecha límite';
                        response += `${index + 1}. ${task.titulo}\n   ${dueDate}\n`;
                    });
                    
                    if (pendingTasks.length > 5) {
                        response += `\n... y ${pendingTasks.length - 5} tarea(s) más.`;
                    }
                    
                    return response;
                }
                
                // COMANDOS DE BITÁCORAS
                if (queryLower.includes('bitácora') || queryLower.includes('actividad')) {
                    if (queryLower.includes('ayer')) {
                        const yesterday = new Date();
                        yesterday.setDate(yesterday.getDate() - 1);
                        const yesterdayStr = yesterday.toISOString().split('T')[0];
                        
                        const bitacorasAyer = this.bitacoras.filter(b => 
                            b.fecha === yesterdayStr && b.tipo === 'diaria'
                        );
                        
                        if (bitacorasAyer.length === 0) {
                            return "No registraste bitácoras ayer.";
                        }
                        
                        const totalHoras = bitacorasAyer.reduce((sum, b) => sum + (parseFloat(b.horas) || 0), 0);
                        return `Ayer registraste ${bitacorasAyer.length} bitácora(s). Total de horas trabajadas: ${totalHoras}h.`;
                    }
                    
                    if (queryLower.includes('hoy')) {
                        const today = new Date().toISOString().split('T')[0];
                        const bitacorasHoy = this.bitacoras.filter(b => 
                            b.fecha === today && b.tipo === 'diaria'
                        );
                        
                        if (bitacorasHoy.length === 0) {
                            return "Aún no has registrado bitácoras para hoy. ¿Quieres crear una?";
                        }
                        
                        return `Hoy has registrado ${bitacorasHoy.length} bitácora(s).`;
                    }
                }
                
                // COMANDOS DE EVENTOS
                if (queryLower.includes('evento') || queryLower.includes('reunión') || queryLower.includes('cita')) {
                    if (queryLower.includes('hoy')) {
                        const today = new Date().toDateString();
                        const eventosHoy = this.eventos.filter(e => 
                            new Date(e.inicio).toDateString() === today
                        );
                        
                        if (eventosHoy.length === 0) {
                            return "No tienes eventos programados para hoy.";
                        }
                        
                        let response = `Hoy tienes ${eventosHoy.length} evento(s):\n\n`;
                        eventosHoy.forEach((evento, index) => {
                            const time = new Date(evento.inicio).toLocaleTimeString('es-ES', {
                                hour: '2-digit',
                                minute: '2-digit'
                            });
                            response += `${index + 1}. ${evento.titulo}\n   Hora: ${time}\n`;
                        });
                        
                        return response;
                    }
                }
                
                // COMANDOS DE INFORMES
                if (queryLower.includes('informe') || queryLower.includes('reporte')) {
                    if (queryLower.includes('semanal') || queryLower.includes('semana')) {
                        this.generarInforme('semanal');
                        return "Estoy generando tu informe semanal. Se abrirá en una nueva ventana.";
                    }
                    
                    if (queryLower.includes('diario') || queryLower.includes('día') || queryLower.includes('hoy')) {
                        this.generarInforme('diario');
                        return "Informe diario generado. Revisa la nueva ventana.";
                    }
                    
                    if (queryLower.includes('mensual') || queryLower.includes('mes')) {
                        this.generarInforme('mensual');
                        return "Informe mensual en proceso de generación.";
                    }
                    
                    return "Puedo generar informes diarios, semanales o mensuales. ¿Cuál necesitas?";
                }
                
                // COMANDOS GENERALES
                if (queryLower.includes('hola') || queryLower.includes('buenos')) {
                    const now = new Date().getHours();
                    let greeting = "¡Hola!";
                    
                    if (now < 12) greeting = "¡Buenos días!";
                    else if (now < 19) greeting = "¡Buenas tardes!";
                    else greeting = "¡Buenas noches!";
                    
                    return `${greeting} Soy tu asistente DRTE. Puedo ayudarte con tareas, eventos, bitácoras e informes. ¿En qué puedo asistirte?`;
                }
                
                if (queryLower.includes('ayuda') || queryLower.includes('qué puedes')) {
                    return "Puedo ayudarte con:\n• Tareas pendientes\n• Eventos del día\n• Bitácoras registradas\n• Generar informes\n\nSolo pregúntame lo que necesites.";
                }
                
                // RESPUESTA POR DEFECTO
                return "Entendí tu consulta. Para ayudarte mejor, puedes preguntarme específicamente sobre:\n\n• '¿Qué tareas tengo hoy?'\n• '¿Qué eventos tengo programados?'\n• 'Genera informe semanal'\n• 'Registro de actividades de ayer'";
            }
            
            addAssistantMessage(text, sender) {
                const container = document.getElementById('assistantMessages');
                const message = document.createElement('div');
                message.className = `message ${sender}`;
                
                const now = new Date();
                const timeString = now.toLocaleTimeString('es-ES', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                message.innerHTML = `
                    <div class="sender">${sender === 'ai' ? 'Asistente DRTE' : 'Tú'}</div>
                    <div class="content">${text.replace(/\n/g, '<br>')}</div>
                    <div class="timestamp">${timeString}</div>
                `;
                
                container.appendChild(message);
                container.scrollTop = container.scrollHeight;
            }
            
            showLoading() {
                const container = document.getElementById('assistantMessages');
                const loading = document.createElement('div');
                loading.className = 'message ai';
                loading.id = 'assistantLoading';
                loading.innerHTML = `
                    <div class="sender">Asistente DRTE</div>
                    <div class="content">
                        <div class="loader" style="display: inline-block;"></div>
                        <span style="margin-left: 0.5rem;">Pensando...</span>
                    </div>
                `;
                
                container.appendChild(loading);
                container.scrollTop = container.scrollHeight;
                
                return 'assistantLoading';
            }
            
            removeLoading(id) {
                const loading = document.getElementById(id);
                if (loading) {
                    loading.remove();
                }
            }
            
            renderDashboard() {
                this.updateCounters();
                this.renderMiniCalendar();
            }
            
            renderMiniCalendar() {
                const container = document.getElementById('miniCalendar');
                if (!container) return;
                
                const today = new Date();
                const month = today.getMonth();
                const year = today.getFullYear();
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const daysInMonth = lastDay.getDate();
                
                let html = `
                    <div class="calendar-header">
                        <h3 style="margin: 0;">${today.toLocaleDateString('es-ES', { month: 'long', year: 'numeric' })}</h3>
                    </div>
                    <div class="calendar-grid" style="grid-template-columns: repeat(7, 1fr); font-size: 0.9rem;">
                `;
                
                // Días de la semana
                const days = ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'];
                days.forEach(day => {
                    html += `<div class="calendar-day-header">${day}</div>`;
                });
                
                // Espacios vacíos al inicio
                for (let i = 0; i < firstDay.getDay(); i++) {
                    html += `<div class="calendar-day"></div>`;
                }
                
                // Días del mes
                for (let day = 1; day <= daysInMonth; day++) {
                    const currentDate = new Date(year, month, day);
                    const isToday = currentDate.toDateString() === today.toDateString();
                    const hasEvents = this.eventos.some(e => 
                        new Date(e.inicio).toDateString() === currentDate.toDateString()
                    );
                    
                    let dayClass = 'calendar-day';
                    if (isToday) dayClass += ' today';
                    
                    html += `
                        <div class="${dayClass}">
                            <div class="day-number">${day}</div>
                            ${hasEvents ? '<div class="event-item event-reunion" style="font-size: 0.7rem;">Eventos</div>' : ''}
                        </div>
                    `;
                }
                
                html += '</div>';
                container.innerHTML = html;
            }
            
            renderTareas(filter = 'all') {
                const container = document.getElementById('tasksContainer');
                if (!container) return;
                
                let filteredTasks = [...this.tareas];
                
                // Aplicar filtro
                switch(filter) {
                    case 'pending':
                        filteredTasks = filteredTasks.filter(t => t.estado === 'pendiente');
                        break;
                    case 'in-progress':
                        filteredTasks = filteredTasks.filter(t => t.estado === 'en-proceso');
                        break;
                    case 'completed':
                        filteredTasks = filteredTasks.filter(t => t.estado === 'completada');
                        break;
                    case 'high':
                        filteredTasks = filteredTasks.filter(t => t.prioridad === 'alta');
                        break;
                }
                
                // Ordenar por prioridad y fecha
                filteredTasks.sort((a, b) => {
                    const priorityOrder = { alta: 1, media: 2, baja: 3 };
                    if (priorityOrder[a.prioridad] !== priorityOrder[b.prioridad]) {
                        return priorityOrder[a.prioridad] - priorityOrder[b.prioridad];
                    }
                    return new Date(a.fechaLimite) - new Date(b.fechaLimite);
                });
                
                container.innerHTML = '';
                
                if (filteredTasks.length === 0) {
                    container.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
                            <i class="fas fa-tasks" style="font-size: 3rem; color: var(--text-light); margin-bottom: 1rem;"></i>
                            <h4>No hay tareas</h4>
                            <p>${filter === 'all' ? 'Comienza agregando tu primera tarea' : 'No hay tareas con este filtro'}</p>
                            <button class="btn btn-primary" onclick="sistema.openTaskModal()">
                                <i class="fas fa-plus"></i> Crear tarea
                            </button>
                        </div>
                    `;
                    return;
                }
                
                filteredTasks.forEach(task => {
                    const taskCard = document.createElement('div');
                    taskCard.className = `task-card priority-${task.prioridad}`;
                    
                    const dueDate = task.fechaLimite ? 
                        new Date(task.fechaLimite).toLocaleDateString('es-ES') : 
                        'Sin fecha límite';
                    
                    const statusText = {
                        'pendiente': 'Pendiente',
                        'en-proceso': 'En proceso',
                        'completada': 'Completada'
                    }[task.estado];
                    
                    const priorityText = {
                        'alta': 'Alta',
                        'media': 'Media',
                        'baja': 'Baja'
                    }[task.prioridad];
                    
                    taskCard.innerHTML = `
                        <div class="task-header">
                            <h4 class="task-title">${task.titulo}</h4>
                            <span class="task-status status-${task.estado}">${statusText}</span>
                        </div>
                        <p class="task-description">${task.descripcion || 'Sin descripción'}</p>
                        <div class="task-meta">
                            <div class="task-date">
                                <i class="far fa-calendar"></i>
                                <span>${dueDate}</span>
                                <span style="margin-left: 1rem;">
                                    <i class="fas fa-flag"></i>
                                    <span>${priorityText}</span>
                                </span>
                            </div>
                            <div class="task-actions">
                                <button class="task-btn edit" onclick="sistema.editTask(${task.id})" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="task-btn delete" onclick="sistema.deleteTask(${task.id})" title="Eliminar">
                                    <i class="fas fa-trash"></i>
                                </button>
                                ${task.estado !== 'completada' ? `
                                    <button class="task-btn complete" onclick="sistema.completeTask(${task.id})" title="Completar">
                                        <i class="fas fa-check"></i>
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(taskCard);
                });
            }
            
            openTaskModal(taskId = null) {
                const modal = document.getElementById('taskModal');
                const title = document.getElementById('taskModalTitle');
                const form = document.getElementById('taskForm');
                
                if (taskId) {
                    // Modo edición
                    const task = this.tareas.find(t => t.id == taskId);
                    if (task) {
                        title.textContent = 'Editar Tarea';
                        document.getElementById('taskId').value = task.id;
                        document.getElementById('taskTitle').value = task.titulo;
                        document.getElementById('taskDescription').value = task.descripcion || '';
                        document.getElementById('taskPriority').value = task.prioridad;
                        document.getElementById('taskStatus').value = task.estado;
                        document.getElementById('taskStartDate').value = task.fechaInicio || '';
                        document.getElementById('taskDueDate').value = task.fechaLimite || '';
                        document.getElementById('taskTags').value = task.etiquetas ? task.etiquetas.join(', ') : '';
                    }
                } else {
                    // Modo creación
                    title.textContent = 'Nueva Tarea';
                    form.reset();
                    document.getElementById('taskId').value = '';
                    
                    // Establecer valores por defecto
                    const today = new Date().toISOString().split('T')[0];
                    const nextWeek = new Date();
                    nextWeek.setDate(nextWeek.getDate() + 7);
                    const nextWeekStr = nextWeek.toISOString().split('T')[0];
                    
                    document.getElementById('taskStartDate').value = today;
                    document.getElementById('taskDueDate').value = nextWeekStr;
                }
                
                modal.classList.add('active');
            }
            
            saveTask() {
                const taskId = document.getElementById('taskId').value;
                const taskData = {
                    titulo: document.getElementById('taskTitle').value,
                    descripcion: document.getElementById('taskDescription').value,
                    prioridad: document.getElementById('taskPriority').value,
                    estado: document.getElementById('taskStatus').value,
                    fechaInicio: document.getElementById('taskStartDate').value,
                    fechaLimite: document.getElementById('taskDueDate').value,
                    etiquetas: document.getElementById('taskTags').value.split(',').map(tag => tag.trim()).filter(tag => tag)
                };
                
                if (!taskData.titulo) {
                    this.showNotification('El título de la tarea es requerido', 'error');
                    return;
                }
                
                if (taskId) {
                    // Actualizar tarea existente
                    const index = this.tareas.findIndex(t => t.id == taskId);
                    if (index !== -1) {
                        this.tareas[index] = { ...this.tareas[index], ...taskData };
                    }
                } else {
                    // Crear nueva tarea
                    taskData.id = Date.now();
                    taskData.fechaCreacion = new Date().toISOString().split('T')[0];
                    this.tareas.push(taskData);
                }
                
                this.saveData();
                this.updateCounters();
                this.renderTareas();
                this.closeModal('taskModal');
                this.showNotification('Tarea guardada correctamente', 'success');
            }
            
            editTask(id) {
                this.openTaskModal(id);
            }
            
            deleteTask(id) {
                if (confirm('¿Estás seguro de eliminar esta tarea?')) {
                    this.tareas = this.tareas.filter(t => t.id != id);
                    this.saveData();
                    this.updateCounters();
                    this.renderTareas();
                    this.showNotification('Tarea eliminada correctamente', 'success');
                }
            }
            
            completeTask(id) {
                const task = this.tareas.find(t => t.id == id);
                if (task) {
                    task.estado = 'completada';
                    this.saveData();
                    this.updateCounters();
                    this.renderTareas();
                    this.showNotification('¡Tarea completada!', 'success');
                }
            }
            
            filterTasks() {
                const filter = document.getElementById('taskFilter').value;
                this.renderTareas(filter);
            }
            
            renderCalendar() {
                // Implementación completa del calendario
                const today = new Date();
                const month = today.getMonth();
                const year = today.getFullYear();
                
                this.renderMonthCalendar(year, month);
            }
            
            renderMonthCalendar(year, month) {
                const container = document.getElementById('calendarView');
                const title = document.getElementById('calendarTitle');
                
                // Actualizar título
                const monthNames = [
                    'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                    'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'
                ];
                title.textContent = `${monthNames[month]} ${year}`;
                
                // Generar calendario
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const daysInMonth = lastDay.getDate();
                const startDay = firstDay.getDay();
                
                let html = '';
                
                // Días de la semana
                const days = ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'];
                days.forEach(day => {
                    html += `<div class="calendar-day-header">${day}</div>`;
                });
                
                // Espacios vacíos al inicio
                for (let i = 0; i < startDay; i++) {
                    html += `<div class="calendar-day"></div>`;
                }
                
                // Días del mes
                const today = new Date();
                for (let day = 1; day <= daysInMonth; day++) {
                    const currentDate = new Date(year, month, day);
                    const isToday = currentDate.toDateString() === today.toDateString();
                    
                    // Obtener eventos para este día
                    const dayEvents = this.eventos.filter(evento => {
                        const eventDate = new Date(evento.inicio);
                        return eventDate.toDateString() === currentDate.toDateString();
                    });
                    
                    let dayClass = 'calendar-day';
                    if (isToday) dayClass += ' today';
                    
                    html += `<div class="${dayClass}">`;
                    html += `<div class="day-number">${day}</div>`;
                    
                    // Mostrar eventos
                    dayEvents.slice(0, 3).forEach(evento => {
                        const eventClass = `event-item event-${evento.tipo}`;
                        const time = new Date(evento.inicio).toLocaleTimeString('es-ES', {
                            hour: '2-digit',
                            minute: '2-digit'
                        });
                        html += `
                            <div class="${eventClass}" onclick="sistema.viewEvent(${evento.id})" 
                                 title="${evento.titulo} - ${time}">
                                ${evento.titulo.substring(0, 15)}${evento.titulo.length > 15 ? '...' : ''}
                            </div>
                        `;
                    });
                    
                    if (dayEvents.length > 3) {
                        html += `<div class="event-item event-more">+${dayEvents.length - 3} más</div>`;
                    }
                    
                    html += `</div>`;
                }
                
                container.innerHTML = html;
            }
            
            viewEvent(eventId) {
                const evento = this.eventos.find(e => e.id == eventId);
                if (evento) {
                    let message = `EVENTO: ${evento.titulo}\n\n`;
                    message += `Tipo: ${evento.tipo}\n`;
                    message += `Inicio: ${new Date(evento.inicio).toLocaleString('es-ES')}\n`;
                    message += `Fin: ${new Date(evento.end).toLocaleString('es-ES')}\n`;
                    if (evento.descripcion) {
                        message += `\nDescripción:\n${evento.descripcion}\n`;
                    }
                    if (evento.location) {
                        message += `\nUbicación: ${evento.location}`;
                    }
                    
                    alert(message);
                }
            }
            
            openEventModal() {
                const modal = document.getElementById('eventModal');
                const form = document.getElementById('eventForm');
                
                form.reset();
                document.getElementById('eventId').value = '';
                
                // Establecer valores por defecto
                const now = new Date();
                const later = new Date(now.getTime() + 60 * 60 * 1000); // 1 hora después
                
                document.getElementById('eventStart').value = this.formatDateTimeLocal(now);
                document.getElementById('eventEnd').value = this.formatDateTimeLocal(later);
                
                modal.classList.add('active');
            }
            
            formatDateTimeLocal(date) {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                const hours = String(date.getHours()).padStart(2, '0');
                const minutes = String(date.getMinutes()).padStart(2, '0');
                
                return `${year}-${month}-${day}T${hours}:${minutes}`;
            }
            
            saveEvent() {
                const eventId = document.getElementById('eventId').value;
                const eventData = {
                    titulo: document.getElementById('eventTitle').value,
                    tipo: document.getElementById('eventType').value,
                    inicio: document.getElementById('eventStart').value,
                    fin: document.getElementById('eventEnd').value,
                    descripcion: document.getElementById('eventDescription').value,
                    ubicacion: document.getElementById('eventLocation').value,
                    recordatorio: document.getElementById('eventReminder').value
                };
                
                if (!eventData.titulo || !eventData.inicio || !eventData.fin) {
                    this.showNotification('Los campos marcados con * son requeridos', 'error');
                    return;
                }
                
                if (new Date(eventData.inicio) >= new Date(eventData.fin)) {
                    this.showNotification('La fecha de inicio debe ser anterior a la fecha de fin', 'error');
                    return;
                }
                
                if (eventId) {
                    // Actualizar evento existente
                    const index = this.eventos.findIndex(e => e.id == eventId);
                    if (index !== -1) {
                        this.eventos[index] = { ...this.eventos[index], ...eventData };
                    }
                } else {
                    // Crear nuevo evento
                    eventData.id = Date.now();
                    this.eventos.push(eventData);
                }
                
                this.saveData();
                this.updateCounters();
                this.renderCalendar();
                this.closeModal('eventModal');
                this.showNotification('Evento guardado correctamente', 'success');
            }
            
            renderBitacoras() {
                this.renderBitacorasDiarias();
                this.renderPlanesSemanales();
                this.renderInformesMensuales();
            }
            
            renderBitacorasDiarias() {
                const container = document.getElementById('diariaList');
                const diarias = this.bitacoras.filter(b => b.tipo === 'diaria');
                
                container.innerHTML = '';
                
                if (diarias.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: var(--text-light);">
                            <i class="fas fa-book" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                            <p>No hay bitácoras diarias registradas</p>
                            <button class="btn btn-primary" onclick="sistema.openBitacoraModal('diaria')">
                                <i class="fas fa-plus"></i> Crear primera bitácora
                            </button>
                        </div>
                    `;
                    return;
                }
                
                // Ordenar por fecha (más recientes primero)
                diarias.sort((a, b) => new Date(b.fecha) - new Date(a.fecha));
                
                diarias.forEach(bitacora => {
                    const item = document.createElement('div');
                    item.className = 'bitacora-item';
                    
                    const fecha = new Date(bitacora.fecha);
                    const fechaStr = fecha.toLocaleDateString('es-ES', {
                        weekday: 'long',
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                    
                    const modalidadText = {
                        'teletrabajo': 'Teletrabajo',
                        'oficina': 'Oficina',
                        'hibrido': 'Híbrido'
                    }[bitacora.modalidad] || bitacora.modalidad;
                    
                    item.innerHTML = `
                        <div class="bitacora-header">
                            <div class="bitacora-title">Bitácora del ${fechaStr}</div>
                            <span class="bitacora-badge badge-diaria">Bitácora Diaria</span>
                        </div>
                        <div class="bitacora-content-preview">
                            <p><strong>Modalidad:</strong> ${modalidadText}</p>
                            <p><strong>Horas:</strong> ${bitacora.horas} horas</p>
                            <p><strong>Actividades:</strong> ${bitacora.actividades.substring(0, 100)}...</p>
                        </div>
                        <div class="bitacora-meta">
                            <span><i class="far fa-clock"></i> ${bitacora.horas} horas</span>
                            <span><i class="fas fa-user-tie"></i> ${modalidadText}</span>
                            <button class="btn btn-secondary btn-sm" onclick="sistema.viewBitacora(${bitacora.id})">
                                <i class="fas fa-eye"></i> Ver
                            </button>
                        </div>
                    `;
                    
                    container.appendChild(item);
                });
            }
            
            renderPlanesSemanales() {
                const container = document.getElementById('semanalList');
                const semanales = this.bitacoras.filter(b => b.tipo === 'semanal');
                
                container.innerHTML = '';
                
                if (semanales.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: var(--text-light);">
                            <i class="fas fa-calendar-week" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                            <p>No hay planes semanales registrados</p>
                            <button class="btn btn-primary" onclick="sistema.openBitacoraModal('semanal')">
                                <i class="fas fa-plus"></i> Crear primer plan
                            </button>
                        </div>
                    `;
                    return;
                }
                
                semanales.forEach(plan => {
                    const item = document.createElement('div');
                    item.className = 'bitacora-item';
                    
                    const fecha = new Date(plan.fecha);
                    const semanaNum = this.getWeekNumber(fecha);
                    
                    item.innerHTML = `
                        <div class="bitacora-header">
                            <div class="bitacora-title">Plan Semanal #${semanaNum}</div>
                            <span class="bitacora-badge badge-semanal">Plan Semanal</span>
                        </div>
                        <div class="bitacora-content-preview">
                            <p><strong>Objetivos:</strong> ${plan.objetivos ? plan.objetivos.substring(0, 100) + '...' : 'No especificados'}</p>
                            <p><strong>Período:</strong> Semana del ${fecha.toLocaleDateString('es-ES')}</p>
                        </div>
                        <div class="bitacora-meta">
                            <span><i class="fas fa-bullseye"></i> ${plan.objetivos ? plan.objetivos.split(' ').length + ' objetivos' : 'Sin objetivos'}</span>
                            <button class="btn btn-secondary btn-sm" onclick="sistema.viewBitacora(${plan.id})">
                                <i class="fas fa-eye"></i> Ver Plan
                            </button>
                        </div>
                    `;
                    
                    container.appendChild(item);
                });
            }
            
            renderInformesMensuales() {
                const container = document.getElementById('mensualList');
                
                // Generar informes mensuales a partir de bitácoras diarias
                const mensuales = this.generateMonthlyReports();
                
                container.innerHTML = '';
                
                if (mensuales.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: var(--text-light);">
                            <i class="fas fa-calendar-month" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                            <p>No hay informes mensuales generados</p>
                            <button class="btn btn-primary" onclick="sistema.generarInforme('mensual')">
                                <i class="fas fa-file-alt"></i> Generar Informe
                            </button>
                        </div>
                    `;
                    return;
                }
                
                mensuales.forEach((informe, index) => {
                    const item = document.createElement('div');
                    item.className = 'bitacora-item';
                    
                    item.innerHTML = `
                        <div class="bitacora-header">
                            <div class="bitacora-title">Informe Mensual - ${informe.mes}</div>
                            <span class="bitacora-badge badge-mensual">Informe Mensual</span>
                        </div>
                        <div class="bitacora-content-preview">
                            <p><strong>Total de días:</strong> ${informe.totalDias} días</p>
                            <p><strong>Horas totales:</strong> ${informe.totalHoras} horas</p>
                            <p><strong>Actividades registradas:</strong> ${informe.totalActividades}</p>
                        </div>
                        <div class="bitacora-meta">
                            <span><i class="fas fa-chart-bar"></i> ${informe.productividad}% productividad</span>
                            <button class="btn btn-primary btn-sm" onclick="sistema.exportMonthlyReport(${index})">
                                <i class="fas fa-download"></i> Exportar
                            </button>
                        </div>
                    `;
                    
                    container.appendChild(item);
                });
            }
            
            generateMonthlyReports() {
                // Agrupar bitácoras por mes
                const meses = {};
                
                this.bitacoras.filter(b => b.tipo === 'diaria').forEach(bitacora => {
                    const fecha = new Date(bitacora.fecha);
                    const mesKey = `${fecha.getFullYear()}-${fecha.getMonth() + 1}`;
                    const mesNombre = fecha.toLocaleDateString('es-ES', { month: 'long', year: 'numeric' });
                    
                    if (!meses[mesKey]) {
                        meses[mesKey] = {
                            mes: mesNombre,
                            totalDias: 0,
                            totalHoras: 0,
                            totalActividades: 0,
                            productividad: 0
                        };
                    }
                    
                    meses[mesKey].totalDias++;
                    meses[mesKey].totalHoras += parseFloat(bitacora.horas) || 0;
                    meses[mesKey].totalActividades += (bitacora.actividades.match(/\n/g) || []).length + 1;
                });
                
                // Calcular productividad por mes
                Object.values(meses).forEach(mes => {
                    mes.productividad = Math.min(100, Math.round((mes.totalHoras / (mes.totalDias * 8)) * 100));
                });
                
                return Object.values(meses);
            }
            
            getWeekNumber(date) {
                const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
                const pastDaysOfYear = (date - firstDayOfYear) / 86400000;
                return Math.ceil((pastDaysOfYear + firstDayOfYear.getDay() + 1) / 7);
            }
            
            openBitacoraModal(tipo) {
                const modal = document.getElementById('bitacoraModal');
                const title = document.getElementById('bitacoraModalTitle');
                const form = document.getElementById('bitacoraForm');
                
                form.reset();
                document.getElementById('bitacoraId').value = '';
                document.getElementById('bitacoraTipo').value = tipo;
                
                // Establecer fecha actual por defecto
                document.getElementById('bitacoraFecha').value = new Date().toISOString().split('T')[0];
                
                // Mostrar/ocultar campos según tipo
                const planSemanalGroup = document.getElementById('planSemanalGroup');
                const actividadesPorDiaGroup = document.getElementById('actividadesPorDiaGroup');
                
                if (tipo === 'semanal') {
                    title.textContent = 'Plan Semanal';
                    planSemanalGroup.style.display = 'block';
                    actividadesPorDiaGroup.style.display = 'block';
                } else {
                    title.textContent = 'Bitácora Diaria';
                    planSemanalGroup.style.display = 'none';
                    actividadesPorDiaGroup.style.display = 'none';
                }
                
                modal.classList.add('active');
            }
            
            saveBitacora() {
                const bitacoraId = document.getElementById('bitacoraId').value;
                const tipo = document.getElementById('bitacoraTipo').value;
                
                const bitacoraData = {
                    tipo: tipo,
                    fecha: document.getElementById('bitacoraFecha').value,
                    modalidad: document.getElementById('bitacoraModalidad').value,
                    actividades: document.getElementById('bitacoraActividades').value,
                    horas: document.getElementById('bitacoraHoras').value,
                    observaciones: document.getElementById('bitacoraObservaciones').value,
                    productividad: document.getElementById('bitacoraProductividad').value
                };
                
                if (tipo === 'semanal') {
                    bitacoraData.objetivos = document.getElementById('planObjetivos').value;
                }
                
                // Validaciones
                if (!bitacoraData.fecha || !bitacoraData.actividades || !bitacoraData.horas) {
                    this.showNotification('Los campos marcados con * son requeridos', 'error');
                    return;
                }
                
                if (parseFloat(bitacoraData.horas) < 0 || parseFloat(bitacoraData.horas) > 24) {
                    this.showNotification('Las horas deben estar entre 0 y 24', 'error');
                    return;
                }
                
                if (bitacoraId) {
                    // Actualizar bitácora existente
                    const index = this.bitacoras.findIndex(b => b.id == bitacoraId);
                    if (index !== -1) {
                        this.bitacoras[index] = { ...this.bitacoras[index], ...bitacoraData };
                    }
                } else {
                    // Crear nueva bitácora
                    bitacoraData.id = Date.now();
                    this.bitacoras.push(bitacoraData);
                }
                
                this.saveData();
                this.updateCounters();
                this.renderBitacoras();
                this.closeModal('bitacoraModal');
                this.showNotification(`${tipo === 'diaria' ? 'Bitácora' : 'Plan'} guardado correctamente`, 'success');
            }
            
            viewBitacora(id) {
                const bitacora = this.bitacoras.find(b => b.id == id);
                if (bitacora) {
                    let message = '';
                    
                    if (bitacora.tipo === 'diaria') {
                        message = `BITÁCORA DIARIA\n\n`;
                        message += `Fecha: ${new Date(bitacora.fecha).toLocaleDateString('es-ES')}\n`;
                        message += `Modalidad: ${bitacora.modalidad}\n`;
                        message += `Horas: ${bitacora.horas}\n`;
                        message += `Productividad: ${bitacora.productividad || 'No especificada'}\n\n`;
                        message += `ACTIVIDADES:\n${bitacora.actividades}\n\n`;
                        if (bitacora.observaciones) {
                            message += `OBSERVACIONES:\n${bitacora.observaciones}`;
                        }
                    } else if (bitacora.tipo === 'semanal') {
                        message = `PLAN SEMANAL\n\n`;
                        message += `Semana: ${new Date(bitacora.fecha).toLocaleDateString('es-ES')}\n\n`;
                        message += `OBJETIVOS:\n${bitacora.objetivos || 'No especificados'}\n\n`;
                        message += `ACTIVIDADES:\n${bitacora.actividades}`;
                    }
                    
                    alert(message);
                }
            }
            
            switchBitacoraTab(tabId) {
                // Actualizar tabs activos
                document.querySelectorAll('.bitacora-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
                
                // Mostrar contenido correspondiente
                document.querySelectorAll('.bitacora-tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(`tab-${tabId}`).classList.add('active');
            }
            
            renderEnlaces() {
                const container = document.getElementById('enlacesGrid');
                container.innerHTML = '';
                
                this.enlaces.forEach(enlace => {
                    const enlaceCard = document.createElement('a');
                    enlaceCard.className = 'enlace-card';
                    enlaceCard.href = enlace.url;
                    enlaceCard.target = '_blank';
                    enlaceCard.rel = 'noopener noreferrer';
                    
                    enlaceCard.innerHTML = `
                        <div class="enlace-icon">
                            <i class="${enlace.icono}"></i>
                        </div>
                        <div class="enlace-title">${enlace.nombre}</div>
                        <div class="enlace-url">${new URL(enlace.url).hostname}</div>
                    `;
                    
                    container.appendChild(enlaceCard);
                });
            }
            
            openLinkModal() {
                const modal = document.getElementById('linkModal');
                const form = document.getElementById('linkForm');
                
                form.reset();
                modal.classList.add('active');
            }
            
            saveLink() {
                const url = document.getElementById('linkUrl').value;
                let nombre = document.getElementById('linkName').value;
                const categoria = document.getElementById('linkCategory').value;
                const icono = document.getElementById('linkIcon').value;
                
                if (!url) {
                    this.showNotification('La URL es requerida', 'error');
                    return;
                }
                
                // Validar URL
                try {
                    new URL(url);
                } catch (e) {
                    this.showNotification('La URL no es válida', 'error');
                    return;
                }
                
                // Si no hay nombre, extraer del dominio
                if (!nombre) {
                    try {
                        const urlObj = new URL(url);
                        nombre = urlObj.hostname.replace('www.', '').split('.')[0];
                        nombre = nombre.charAt(0).toUpperCase() + nombre.slice(1);
                    } catch (e) {
                        nombre = 'Nuevo Enlace';
                    }
                }
                
                // Determinar icono si no se especificó
                let finalIcono = icono;
                if (!finalIcono) {
                    finalIcono = this.detectIcon(url, categoria);
                }
                
                const enlaceData = {
                    id: Date.now(),
                    nombre: nombre,
                    url: url,
                    icono: finalIcono,
                    categoria: categoria
                };
                
                this.enlaces.push(enlaceData);
                this.saveData();
                this.renderEnlaces();
                this.closeModal('linkModal');
                this.showNotification('Enlace agregado correctamente', 'success');
            }
            
            detectIcon(url, categoria) {
                const urlLower = url.toLowerCase();
                const hostname = new URL(url).hostname;
                
                // Mapeo de iconos por dominio o categoría
                const iconMap = {
                    // Dominios específicos
                    'outlook': 'fas fa-envelope',
                    'office.com': 'fas fa-envelope',
                    'teams': 'fas fa-users',
                    'microsoft': 'fab fa-microsoft',
                    'google': 'fab fa-google',
                    'drive.google': 'fab fa-google-drive',
                    'github': 'fab fa-github',
                    'symbaloo': 'fas fa-th',
                    'mep.go.cr': 'fas fa-graduation-cap',
                    'copilot': 'fas fa-robot',
                    
                    // Categorías
                    'trabajo': 'fas fa-briefcase',
                    'comunicacion': 'fas fa-comments',
                    'herramientas': 'fas fa-tools',
                    'recursos': 'fas fa-book',
                    'personal': 'fas fa-user'
                };
                
                // Buscar por dominio
                for (const [key, value] of Object.entries(iconMap)) {
                    if (hostname.includes(key)) {
                        return value;
                    }
                }
                
                // Si no se encuentra, usar por categoría
                return iconMap[categoria] || 'fas fa-external-link-alt';
            }
            
            updateIconPreview() {
                const iconInput = document.getElementById('linkIcon').value;
                const preview = document.getElementById('iconPreview');
                
                if (iconInput) {
                    preview.innerHTML = `<i class="${iconInput}"></i>`;
                } else {
                    preview.innerHTML = '<i class="fas fa-external-link-alt"></i>';
                }
            }
            
            generarInforme(tipo) {
                let contenido = '';
                let titulo = '';
                let filename = '';
                
                const hoy = new Date();
                
                switch(tipo) {
                    case 'diario':
                        titulo = `INFORME DIARIO - ${hoy.toLocaleDateString('es-ES')}`;
                        filename = `informe_diario_${hoy.toISOString().split('T')[0]}.html`;
                        contenido = this.generateDailyReport();
                        break;
                        
                    case 'semanal':
                        titulo = `INFORME SEMANAL - Semana ${this.getWeekNumber(hoy)}`;
                        filename = `informe_semanal_${hoy.getFullYear()}_semana_${this.getWeekNumber(hoy)}.html`;
                        contenido = this.generateWeeklyReport();
                        break;
                        
                    case 'mensual':
                        const mes = hoy.toLocaleDateString('es-ES', { month: 'long', year: 'numeric' });
                        titulo = `INFORME MENSUAL - ${mes}`;
                        filename = `informe_mensual_${hoy.getFullYear()}_${hoy.getMonth() + 1}.html`;
                        contenido = this.generateMonthlyReport();
                        break;
                }
                
                // Crear ventana de informe
                const reportWindow = window.open('', '_blank');
                reportWindow.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>${titulo}</title>
                        <style>
                            body { 
                                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
                                margin: 0; 
                                padding: 2rem; 
                                color: #333;
                                line-height: 1.6;
                            }
                            .header { 
                                text-align: center; 
                                margin-bottom: 2rem;
                                border-bottom: 2px solid #2563eb;
                                padding-bottom: 1rem;
                            }
                            .logo { 
                                font-size: 1.5rem; 
                                color: #2563eb; 
                                font-weight: bold;
                                margin-bottom: 0.5rem;
                            }
                            .section { 
                                margin-bottom: 2rem;
                                page-break-inside: avoid;
                            }
                            .section-title {
                                color: #2563eb;
                                border-bottom: 1px solid #e2e8f0;
                                padding-bottom: 0.5rem;
                                margin-bottom: 1rem;
                            }
                            table {
                                width: 100%;
                                border-collapse: collapse;
                                margin: 1rem 0;
                                font-size: 0.9rem;
                            }
                            th, td {
                                border: 1px solid #e2e8f0;
                                padding: 0.75rem;
                                text-align: left;
                            }
                            th {
                                background-color: #f8fafc;
                                font-weight: 600;
                            }
                            .stats-grid {
                                display: grid;
                                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                                gap: 1rem;
                                margin: 1rem 0;
                            }
                            .stat-card {
                                border: 1px solid #e2e8f0;
                                border-radius: 8px;
                                padding: 1rem;
                                text-align: center;
                            }
                            .stat-number {
                                font-size: 1.5rem;
                                font-weight: bold;
                                color: #2563eb;
                            }
                            .footer {
                                margin-top: 3rem;
                                padding-top: 1rem;
                                border-top: 1px solid #e2e8f0;
                                text-align: right;
                                font-size: 0.9rem;
                                color: #64748b;
                            }
                            @media print {
                                body { padding: 1rem; }
                                .no-print { display: none; }
                            }
                        </style>
                    </head>
                    <body>
                        <div class="header">
                            <div class="logo">DRTE MEP - Sistema de Gestión</div>
                            <h1>${titulo}</h1>
                            <p>Generado el: ${new Date().toLocaleString('es-ES')}</p>
                        </div>
                        
                        ${contenido}
                        
                        <div class="footer">
                            <p>Documento generado automáticamente por el Sistema DRTE MEP</p>
                            <p>Ministerio de Educación Pública - Costa Rica</p>
                        </div>
                        
                        <div class="no-print" style="margin-top: 2rem; text-align: center;">
                            <button onclick="window.print()" style="padding: 0.5rem 1rem; background: #2563eb; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                📄 Imprimir Informe
                            </button>
                            <button onclick="window.close()" style="padding: 0.5rem 1rem; background: #64748b; color: white; border: none; border-radius: 4px; cursor: pointer; margin-left: 0.5rem;">
                                ❌ Cerrar
                            </button>
                        </div>
                    </body>
                    </html>
                `);
                reportWindow.document.close();
                
                this.showNotification(`Informe ${tipo} generado correctamente`, 'success');
            }
            
            generateDailyReport() {
                const hoy = new Date().toISOString().split('T')[0];
                
                // Tareas para hoy
                const tareasHoy = this.tareas.filter(t => t.fechaLimite === hoy);
                const tareasPendientes = tareasHoy.filter(t => t.estado !== 'completada');
                
                // Eventos de hoy
                const eventosHoy = this.eventos.filter(e => 
                    new Date(e.inicio).toISOString().split('T')[0] === hoy
                );
                
                // Bitácoras de hoy
                const bitacorasHoy = this.bitacoras.filter(b => 
                    b.fecha === hoy && b.tipo === 'diaria'
                );
                
                let html = `
                    <div class="section">
                        <h2 class="section-title">📊 Resumen del Día</h2>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-number">${tareasPendientes.length}</div>
                                <div>Tareas Pendientes</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">${eventosHoy.length}</div>
                                <div>Eventos Programados</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">${bitacorasHoy.length}</div>
                                <div>Bitácoras Registradas</div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Tareas pendientes
                if (tareasPendientes.length > 0) {
                    html += `
                        <div class="section">
                            <h2 class="section-title">📋 Tareas Pendientes para Hoy</h2>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Tarea</th>
                                        <th>Prioridad</th>
                                        <th>Estado</th>
                                        <th>Descripción</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    tareasPendientes.forEach(tarea => {
                        html += `
                            <tr>
                                <td>${tarea.titulo}</td>
                                <td>${tarea.prioridad}</td>
                                <td>${tarea.estado}</td>
                                <td>${tarea.descripcion || ''}</td>
                            </tr>
                        `;
                    });
                    
                    html += `
                                </tbody>
                            </table>
                        </div>
                    `;
                }
                
                // Eventos de hoy
                if (eventosHoy.length > 0) {
                    html += `
                        <div class="section">
                            <h2 class="section-title">📅 Eventos Programados para Hoy</h2>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Evento</th>
                                        <th>Tipo</th>
                                        <th>Hora Inicio</th>
                                        <th>Hora Fin</th>
                                        <th>Descripción</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    eventosHoy.forEach(evento => {
                        const inicio = new Date(evento.inicio);
                        const fin = new Date(evento.fin);
                        
                        html += `
                            <tr>
                                <td>${evento.titulo}</td>
                                <td>${evento.tipo}</td>
                                <td>${inicio.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' })}</td>
                                <td>${fin.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' })}</td>
                                <td>${evento.descripcion || ''}</td>
                            </tr>
                        `;
                    });
                    
                    html += `
                                </tbody>
                            </table>
                        </div>
                    `;
                }
                
                // Bitácoras de hoy
                if (bitacorasHoy.length > 0) {
                    html += `
                        <div class="section">
                            <h2 class="section-title">📝 Bitácoras del Día</h2>
                    `;
                    
                    bitacorasHoy.forEach((bitacora, index) => {
                        html += `
                            <div style="margin-bottom: 1.5rem; padding: 1rem; border: 1px solid #e2e8f0; border-radius: 8px;">
                                <h3 style="margin-top: 0; color: #475569;">Bitácora ${index + 1}</h3>
                                <p><strong>Modalidad:</strong> ${bitacora.modalidad}</p>
                                <p><strong>Horas trabajadas:</strong> ${bitacora.horas}</p>
                                <p><strong>Actividades:</strong></p>
                                <div style="white-space: pre-line; background: #f8fafc; padding: 1rem; border-radius: 4px;">
                                    ${bitacora.actividades}
                                </div>
                                ${bitacora.observaciones ? `
                                    <p style="margin-top: 1rem;"><strong>Observaciones:</strong> ${bitacora.observaciones}</p>
                                ` : ''}
                            </div>
                        `;
                    });
                    
                    html += `</div>`;
                }
                
                return html;
            }
            
            generateWeeklyReport() {
                const hoy = new Date();
                const semanaPasada = new Date(hoy);
                semanaPasada.setDate(semanaPasada.getDate() - 7);
                
                // Filtrar datos de la última semana
                const tareasSemana = this.tareas.filter(t => {
                    const fechaTarea = new Date(t.fechaCreacion || t.fechaLimite);
                    return fechaTarea >= semanaPasada && fechaTarea <= hoy;
                });
                
                const eventosSemana = this.eventos.filter(e => {
                    const fechaEvento = new Date(e.inicio);
                    return fechaEvento >= semanaPasada && fechaEvento <= hoy;
                });
                
                const bitacorasSemana = this.bitacoras.filter(b => {
                    const fechaBitacora = new Date(b.fecha);
                    return fechaBitacora >= semanaPasada && fechaBitacora <= hoy;
                });
                
                // Calcular estadísticas
                const tareasCompletadas = tareasSemana.filter(t => t.estado === 'completada').length;
                const totalHoras = bitacorasSemana.reduce((sum, b) => sum + (parseFloat(b.horas) || 0), 0);
                const productividad = Math.min(100, Math.round((totalHoras / (bitacorasSemana.length * 8)) * 100));
                
                let html = `
                    <div class="section">
                        <h2 class="section-title">📊 Resumen Semanal</h2>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-number">${tareasSemana.length}</div>
                                <div>Tareas Totales</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">${tareasCompletadas}</div>
                                <div>Tareas Completadas</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">${eventosSemana.length}</div>
                                <div>Eventos Realizados</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">${totalHoras}h</div>
                                <div>Horas Trabajadas</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">${productividad}%</div>
                                <div>Productividad</div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Distribución de tareas por prioridad
                const prioridades = { alta: 0, media: 0, baja: 0 };
                tareasSemana.forEach(t => {
                    if (prioridades[t.prioridad] !== undefined) {
                        prioridades[t.prioridad]++;
                    }
                });
                
                html += `
                    <div class="section">
                        <h2 class="section-title">📈 Distribución de Tareas</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th>Prioridad</th>
                                    <th>Cantidad</th>
                                    <th>Porcentaje</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                const totalTareas = tareasSemana.length;
                Object.entries(prioridades).forEach(([prioridad, cantidad]) => {
                    const porcentaje = totalTareas > 0 ? Math.round((cantidad / totalTareas) * 100) : 0;
                    html += `
                        <tr>
                            <td>${prioridad.charAt(0).toUpperCase() + prioridad.slice(1)}</td>
                            <td>${cantidad}</td>
                            <td>${porcentaje}%</td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                // Actividades por día
                html += `
                    <div class="section">
                        <h2 class="section-title">📅 Actividades por Día</h2>
                `;
                
                // Agrupar bitácoras por día
                const actividadesPorDia = {};
                bitacorasSemana.forEach(bitacora => {
                    const fecha = new Date(bitacora.fecha).toLocaleDateString('es-ES', { weekday: 'long' });
                    if (!actividadesPorDia[fecha]) {
                        actividadesPorDia[fecha] = {
                            horas: 0,
                            actividades: []
                        };
                    }
                    actividadesPorDia[fecha].horas += parseFloat(bitacora.horas) || 0;
                    actividadesPorDia[fecha].actividades.push(bitacora.actividades);
                });
                
                Object.entries(actividadesPorDia).forEach(([dia, datos]) => {
                    html += `
                        <div style="margin-bottom: 1.5rem; padding: 1rem; border: 1px solid #e2e8f0; border-radius: 8px;">
                            <h3 style="margin-top: 0; color: #475569;">${dia}</h3>
                            <p><strong>Horas trabajadas:</strong> ${datos.horas}</p>
                            <p><strong>Total de actividades:</strong> ${datos.actividades.length}</p>
                        </div>
                    `;
                });
                
                html += `</div>`;
                
                return html;
            }
            
            generateMonthlyReport() {
                const hoy = new Date();
                const mesActual = hoy.getMonth();
                const añoActual = hoy.getFullYear();
                
                // Filtrar datos del mes actual
                const tareasMes = this.tareas.filter(t => {
                    const fechaTarea = new Date(t.fechaCreacion || t.fechaLimite);
                    return fechaTarea.getMonth() === mesActual && fechaTarea.getFullYear() === añoActual;
                });
                
                const eventosMes = this.eventos.filter(e => {
                    const fechaEvento = new Date(e.inicio);
                    return fechaEvento.getMonth() === mesActual && fechaEvento.getFullYear() === añoActual;
                });
                
                const bitacorasMes = this.bitacoras.filter(b => {
                    const fechaBitacora = new Date(b.fecha);
                    return fechaBitacora.getMonth() === mesActual && fechaBitacora.getFullYear() === añoActual;
                });
                
                // Calcular estadísticas
                const tareasCompletadas = tareasMes.filter(t => t.estado === 'completada').length;
                const totalHoras = bitacorasMes.reduce((sum, b) => sum + (parseFloat(b.horas) || 0), 0);
                const diasTrabajados = new Set(bitacorasMes.map(b => b.fecha)).size;
                const productividad = Math.min(100, Math.round((totalHoras / (diasTrabajados * 8)) * 100));
                
                let html = `
                    <div class="section">
                        <h2 class="section-title">📊 Resumen Mensual</h2>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-number">${tareasMes.length}</div>
                                <div>Tareas Totales</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">${tareasCompletadas}</div>
                                <div>Tareas Completadas</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">${eventosMes.length}</div>
                                <div>Eventos Realizados</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">${totalHoras}h</div>
                                <div>Horas Trabajadas</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">${diasTrabajados}</div>
                                <div>Días Trabajados</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">${productividad}%</div>
                                <div>Productividad</div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Tendencias por semana
                html += `
                    <div class="section">
                        <h2 class="section-title">📈 Tendencias por Semana</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th>Semana</th>
                                    <th>Tareas</th>
                                    <th>Horas</th>
                                    <th>Productividad</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                // Agrupar por semana
                const semanas = {};
                bitacorasMes.forEach(bitacora => {
                    const fecha = new Date(bitacora.fecha);
                    const semana = this.getWeekNumber(fecha);
                    const key = `Semana ${semana}`;
                    
                    if (!semanas[key]) {
                        semanas[key] = {
                            tareas: 0,
                            horas: 0,
                            dias: new Set()
                        };
                    }
                    
                    semanas[key].horas += parseFloat(bitacora.horas) || 0;
                    semanas[key].dias.add(bitacora.fecha);
                });
                
                // Contar tareas por semana
                tareasMes.forEach(tarea => {
                    const fecha = new Date(tarea.fechaCreacion || tarea.fechaLimite);
                    const semana = this.getWeekNumber(fecha);
                    const key = `Semana ${semana}`;
                    
                    if (semanas[key]) {
                        semanas[key].tareas++;
                    }
                });
                
                Object.entries(semanas).forEach(([semana, datos]) => {
                    const productividadSemana = Math.min(100, Math.round((datos.horas / (datos.dias.size * 8)) * 100));
                    
                    html += `
                        <tr>
                            <td>${semana}</td>
                            <td>${datos.tareas}</td>
                            <td>${datos.horas}h</td>
                            <td>${productividadSemana}%</td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                // Modalidades de trabajo
                const modalidades = {};
                bitacorasMes.forEach(bitacora => {
                    if (!modalidades[bitacora.modalidad]) {
                        modalidades[bitacora.modalidad] = 0;
                    }
                    modalidades[bitacora.modalidad]++;
                });
                
                html += `
                    <div class="section">
                        <h2 class="section-title">🏢 Modalidades de Trabajo</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th>Modalidad</th>
                                    <th>Días</th>
                                    <th>Porcentaje</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                Object.entries(modalidades).forEach(([modalidad, dias]) => {
                    const porcentaje = Math.round((dias / diasTrabajados) * 100);
                    
                    html += `
                        <tr>
                            <td>${modalidad}</td>
                            <td>${dias}</td>
                            <td>${porcentaje}%</td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                return html;
            }
            
            exportAllReports() {
                this.openExportModal();
            }
            
            openExportModal() {
                const modal = document.getElementById('exportModal');
                modal.classList.add('active');
            }
            
            exportTo(format) {
                this.closeModal('exportModal');
                
                switch(format) {
                    case 'pdf':
                        this.exportToPDF();
                        break;
                    case 'excel':
                        this.exportToExcel();
                        break;
                    case 'word':
                        this.exportToWord();
                        break;
                    case 'csv':
                        this.exportToCSV();
                        break;
                }
            }
            
            exportToPDF() {
                // En un sistema real, usaría una librería como jsPDF
                // Por ahora, simulamos la exportación
                this.showNotification('Exportando a PDF...', 'info');
                
                setTimeout(() => {
                    this.showNotification('PDF generado correctamente', 'success');
                    // En producción, aquí se generaría y descargaría el PDF
                }, 1000);
            }
            
            exportToExcel() {
                this.showNotification('Exportando a Excel...', 'info');
                
                // Crear datos para Excel
                const data = [
                    ['Tareas', 'Fecha', 'Prioridad', 'Estado'],
                    ...this.tareas.map(t => [t.titulo, t.fechaLimite, t.prioridad, t.estado])
                ];
                
                // Convertir a CSV (simulación de Excel)
                const csvContent = data.map(row => row.join(',')).join('\n');
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                
                link.href = URL.createObjectURL(blob);
                link.download = `tareas_drte_${new Date().toISOString().split('T')[0]}.csv`;
                link.click();
                
                this.showNotification('Excel exportado correctamente', 'success');
            }
            
            exportToWord() {
                this.showNotification('Exportando a Word...', 'info');
                
                // Simulación de exportación a Word
                setTimeout(() => {
                    this.showNotification('Documento Word generado', 'success');
                }, 1000);
            }
            
            exportToCSV() {
                this.showNotification('Exportando a CSV...', 'info');
                
                // Exportar múltiples datos a CSV
                const allData = {
                    tareas: this.tareas,
                    eventos: this.eventos,
                    bitacoras: this.bitacoras
                };
                
                let csvContent = '';
                
                Object.entries(allData).forEach(([type, data]) => {
                    if (data.length > 0) {
                        const headers = Object.keys(data[0]);
                        csvContent += `${type.toUpperCase()}\n`;
                        csvContent += headers.join(',') + '\n';
                        
                        data.forEach(item => {
                            const row = headers.map(header => {
                                const value = item[header];
                                return typeof value === 'string' ? `"${value.replace(/"/g, '""')}"` : value;
                            });
                            csvContent += row.join(',') + '\n';
                        });
                        
                        csvContent += '\n\n';
                    }
                });
                
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                
                link.href = URL.createObjectURL(blob);
                link.download = `datos_drte_${new Date().toISOString().split('T')[0]}.csv`;
                link.click();
                
                this.showNotification('CSV exportado correctamente', 'success');
            }
            
            startExport() {
                const format = document.querySelector('.export-option:hover') ? 
                    document.querySelector('.export-option:hover').getAttribute('onclick').match(/\('(.*?)'\)/)[1] : 
                    'pdf';
                
                this.exportTo(format);
            }
            
            setupAutoReport() {
                const toggle = document.getElementById('autoReportToggle');
                if (toggle) {
                    toggle.checked = this.configuracion.autoReport?.enabled || false;
                    this.updateReportStatus();
                    
                    toggle.addEventListener('change', () => {
                        this.toggleAutoReport();
                    });
                }
            }
            
            toggleAutoReport() {
                const toggle = document.getElementById('autoReportToggle');
                if (!toggle) return;
                
                this.configuracion.autoReport = {
                    ...this.configuracion.autoReport,
                    enabled: toggle.checked
                };
                
                this.saveData();
                this.updateReportStatus();
                
                const status = toggle.checked ? 'activado' : 'desactivado';
                this.showNotification(`Informe automático ${status}`, 'success');
                
                if (toggle.checked) {
                    this.scheduleAutoReport();
                }
            }
            
            updateReportStatus() {
                const statusElement = document.getElementById('reportStatus');
                if (!statusElement) return;
                
                if (this.configuracion.autoReport?.enabled) {
                    statusElement.textContent = `Activo - Se enviará a las ${this.configuracion.autoReport.time || '08:00'}`;
                    statusElement.style.color = 'var(--success-color)';
                } else {
                    statusElement.textContent = 'Inactivo';
                    statusElement.style.color = 'var(--text-light)';
                }
            }
            
            scheduleAutoReport() {
                if (!this.configuracion.autoReport?.enabled) return;
                
                const now = new Date();
                const [hours, minutes] = (this.configuracion.autoReport.time || '08:00').split(':').map(Number);
                const targetTime = new Date(now);
                
                targetTime.setHours(hours, minutes, 0, 0);
                
                // Si ya pasó la hora de hoy, programar para mañana
                if (targetTime < now) {
                    targetTime.setDate(targetTime.getDate() + 1);
                }
                
                const timeUntilTarget = targetTime - now;
                
                console.log(`Informe automático programado para: ${targetTime.toLocaleString()}`);
                
                setTimeout(() => {
                    if (this.configuracion.autoReport?.enabled) {
                        this.executeAutoReport();
                        // Programar siguiente día
                        this.scheduleAutoReport();
                    }
                }, timeUntilTarget);
            }
            
            executeAutoReport() {
                console.log('Ejecutando informe automático...');
                this.generarInforme('diario');
                this.showNotification('Informe automático generado', 'success');
            }
            
            testAutoReport() {
                this.showNotification('Simulando informe automático...', 'info');
                this.generarInforme('diario');
            }
            
            generateTestReport() {
                this.exportToPDF();
            }
            
            checkDailyBitacora() {
                const today = new Date().toISOString().split('T')[0];
                const hasBitacoraToday = this.bitacoras.some(b => 
                    b.fecha === today && b.tipo === 'diaria'
                );
                
                if (hasBitacoraToday) {
                    if (confirm('Ya tienes una bitácora para hoy. ¿Deseas crear otra?')) {
                        this.openBitacoraModal('diaria');
                    }
                } else {
                    this.openBitacoraModal('diaria');
                }
            }
            
            showNotification(message, type = 'info') {
                const container = document.getElementById('notificationContainer');
                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                
                const icons = {
                    success: 'fa-check-circle',
                    error: 'fa-exclamation-circle',
                    info: 'fa-info-circle',
                    warning: 'fa-exclamation-triangle'
                };
                
                notification.innerHTML = `
                    <div class="notification-icon">
                        <i class="fas ${icons[type] || 'fa-info-circle'}"></i>
                    </div>
                    <div class="notification-content">
                        <div class="notification-message">${message}</div>
                    </div>
                    <button class="notification-close" onclick="this.parentElement.remove()">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                container.appendChild(notification);
                
                // Remover automáticamente después de 5 segundos
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 5000);
            }
            
            closeModal(modalId) {
                document.getElementById(modalId).classList.remove('active');
            }
            
            loadInitialData() {
                this.renderTareas();
                this.renderCalendar();
                this.renderBitacoras();
                this.renderEnlaces();
            }
            
            // Funciones para navegación del calendario
            prevPeriod() {
                // Implementar navegación anterior en calendario
                console.log('Navegación anterior');
            }
            
            nextPeriod() {
                // Implementar navegación siguiente en calendario
                console.log('Navegación siguiente');
            }
            
            goToToday() {
                this.renderCalendar();
            }
            
            changeView(view) {
                // Cambiar vista del calendario
                console.log(`Cambiando a vista: ${view}`);
            }
            
            // Funciones de configuración
            saveSettings() {
                const theme = document.getElementById('themeSelect').value;
                const language = document.getElementById('languageSelect').value;
                const backup = document.getElementById('backupFrequency').value;
                
                this.configuracion.tema = theme;
                this.configuracion.idioma = language;
                this.configuracion.backup = backup;
                
                this.configuracion.notificaciones = {
                    tareas: document.getElementById('notifyTasks').checked,
                    eventos: document.getElementById('notifyEvents').checked,
                    informes: document.getElementById('notifyReports').checked
                };
                
                this.saveData();
                this.showNotification('Configuración guardada correctamente', 'success');
            }
            
            resetSettings() {
                if (confirm('¿Restablecer toda la configuración a valores predeterminados?')) {
                    this.configuracion = this.getDefaultConfig();
                    this.saveData();
                    this.loadSettings();
                    this.showNotification('Configuración restablecida', 'success');
                }
            }
            
            loadSettings() {
                // Cargar configuración en los controles
                document.getElementById('themeSelect').value = this.configuracion.tema || 'light';
                document.getElementById('languageSelect').value = this.configuracion.idioma || 'es';
                document.getElementById('backupFrequency').value = this.configuracion.backup || 'weekly';
                
                document.getElementById('notifyTasks').checked = this.configuracion.notificaciones?.tareas ?? true;
                document.getElementById('notifyEvents').checked = this.configuracion.notificaciones?.eventos ?? true;
                document.getElementById('notifyReports').checked = this.configuracion.notificaciones?.informes ?? true;
                
                this.updateReportStatus();
            }
            
            changeTheme() {
                const theme = document.getElementById('themeSelect').value;
                // Implementar cambio de tema
                console.log(`Cambiando tema a: ${theme}`);
            }
            
            clearAllData() {
                if (confirm('¿ESTÁS SEGURO? Esto borrará TODOS los datos (tareas, eventos, bitácoras, enlaces). Esta acción no se puede deshacer.')) {
                    localStorage.clear();
                    this.loadData();
                    this.loadInitialData();
                    this.showNotification('Todos los datos han sido borrados', 'warning');
                }
            }
            
            exportAllData() {
                const data = {
                    tareas: this.tareas,
                    eventos: this.eventos,
                    bitacoras: this.bitacoras,
                    enlaces: this.enlaces,
                    configuracion: this.configuracion,
                    exportDate: new Date().toISOString()
                };
                
                const dataStr = JSON.stringify(data, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                const exportFileDefaultName = `backup_drte_${new Date().toISOString().split('T')[0]}.json`;
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
                
                this.showNotification('Backup exportado correctamente', 'success');
            }
            
            importData() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = (event) => {
                        try {
                            const data = JSON.parse(event.target.result);
                            
                            // Validar estructura de datos
                            if (data.tareas && data.eventos && data.bitacoras && data.enlaces) {
                                if (confirm('¿Importar estos datos? Se sobrescribirán los datos actuales.')) {
                                    this.tareas = data.tareas;
                                    this.eventos = data.eventos;
                                    this.bitacoras = data.bitacoras;
                                    this.enlaces = data.enlaces;
                                    this.configuracion = data.configuracion || this.getDefaultConfig();
                                    
                                    this.saveData();
                                    this.loadInitialData();
                                    this.loadSettings();
                                    this.showNotification('Datos importados correctamente', 'success');
                                }
                            } else {
                                this.showNotification('El archivo no tiene el formato correcto', 'error');
                            }
                        } catch (error) {
                            this.showNotification('Error al importar el archivo', 'error');
                            console.error('Error importing data:', error);
                        }
                    };
                    
                    reader.readAsText(file);
                };
                
                input.click();
            }
            
            exportMonthlyReport(index) {
                const reports = this.generateMonthlyReports();
                if (reports[index]) {
                    this.generarInforme('mensual');
                }
            }
        }

        // INICIALIZAR SISTEMA
        const sistema = new SistemaDRTE();

        // EXPORTAR FUNCIONES GLOBALES
        window.sistema = sistema;
        window.navigateTo = (section) => sistema.navigateTo(section);
        window.openTaskModal = () => sistema.openTaskModal();
        window.openEventModal = () => sistema.openEventModal();
        window.openBitacoraModal = (tipo) => sistema.openBitacoraModal(tipo);
        window.openLinkModal = () => sistema.openLinkModal();
        window.generarInforme = (tipo) => sistema.generarInforme(tipo);
        window.handleAssistantQuery = () => sistema.handleAssistantQuery();
        window.quickCommand = (cmd) => sistema.quickCommand(cmd);
        window.toggleAutoReport = () => sistema.toggleAutoReport();
        window.testAutoReport = () => sistema.testAutoReport();
        window.generateTestReport = () => sistema.generateTestReport();
        window.exportTo = (format) => sistema.exportTo(format);
        window.startExport = () => sistema.startExport();
        window.closeModal = (modalId) => sistema.closeModal(modalId);
        window.prevPeriod = () => sistema.prevPeriod();
        window.nextPeriod = () => sistema.nextPeriod();
        window.goToToday = () => sistema.goToToday();
        window.changeView = (view) => sistema.changeView(view);
        window.saveSettings = () => sistema.saveSettings();
        window.resetSettings = () => sistema.resetSettings();
        window.changeTheme = () => sistema.changeTheme();
        window.clearAllData = () => sistema.clearAllData();
        window.exportAllData = () => sistema.exportAllData();
        window.importData = () => sistema.importData();
        window.checkDailyBitacora = () => sistema.checkDailyBitacora();
        window.openExportModal = () => sistema.openExportModal();
        window.exportAllReports = () => sistema.exportAllReports();
        window.filterTasks = () => sistema.filterTasks();
        window.updateIconPreview = () => sistema.updateIconPreview();

        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', () => {
            sistema.loadSettings();
        });
    </script>
</body>
</html>
